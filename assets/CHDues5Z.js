var e;import{r as t,a as s,R as a,N as r,u as l,O as n,b as o,L as i,H as c,c as d,d as m,e as x}from"./D1jzmp5V.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var u={exports:{}},h={},p=t,g=Symbol.for("react.element"),v=Symbol.for("react.fragment"),j=Object.prototype.hasOwnProperty,f=p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,b={key:!0,ref:!0,__self:!0,__source:!0};function w(e,t,s){var a,r={},l=null,n=null;for(a in void 0!==s&&(l=""+s),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(n=t.ref),t)j.call(t,a)&&!b.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:g,type:e,key:l,ref:n,props:r,_owner:f.current}}h.Fragment=v,h.jsx=w,h.jsxs=w,u.exports=h;var y=u.exports,N={},k=s;N.createRoot=k.createRoot,N.hydrateRoot=k.hydrateRoot;const C=e=>e?e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"").trim():"",L=e=>{if(null==e)return e;if("string"==typeof e)return C(e);if(Array.isArray(e))return e.map(e=>L(e));if("object"==typeof e){const t={};return Object.entries(e).forEach(([e,s])=>{t[e]=L(s)}),t}return e};class _{constructor(e=100,t=6e4){this.requests=new Map,this.maxRequests=e,this.timeWindow=t}canMakeRequest(e){const t=Date.now(),s=(this.requests.get(e)||[]).filter(e=>t-e<this.timeWindow);return!(s.length>=this.maxRequests)&&(s.push(t),this.requests.set(e,s),!0)}reset(e){this.requests.delete(e)}getRemainingRequests(e){const t=Date.now(),s=(this.requests.get(e)||[]).filter(e=>t-e<this.timeWindow);return Math.max(0,this.maxRequests-s.length)}}const M=new _(100,6e4),z=new _(5,3e5),S=e=>{try{const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(t).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(s)}catch{return null}},A="sahtee_secure_",E=`${A}session_key`,P=new TextEncoder,B=new TextDecoder,$="undefined"!=typeof window&&!!(null==(e=window.crypto)?void 0:e.subtle),W=e=>{const t=new Uint8Array(e);let s="";return t.forEach(e=>{s+=String.fromCharCode(e)}),btoa(s)},R=e=>{const t=atob(e),s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s.buffer},T=async()=>{if(!$)return null;let e=sessionStorage.getItem(E);if(!e){const t=window.crypto.getRandomValues(new Uint8Array(32));e=W(t.buffer),sessionStorage.setItem(E,e)}const t=R(e);return window.crypto.subtle.importKey("raw",t,{name:"AES-GCM"},!1,["encrypt","decrypt"])},V={async setItem(e,t){if("string"!=typeof t)throw new Error("secureStorage expects string values only");const s=await(async e=>{if(!$)return e;const t=await T();if(!t)return e;const s=window.crypto.getRandomValues(new Uint8Array(12)),a=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:s},t,P.encode(e)),r=new Uint8Array(s.byteLength+a.byteLength);return r.set(s,0),r.set(new Uint8Array(a),s.byteLength),W(r.buffer)})(t);try{localStorage.setItem(`${A}${e}`,s)}catch{try{localStorage.setItem(`${A}${e}`,t)}catch{}}},async getItem(e){let t=null;try{t=localStorage.getItem(`${A}${e}`)}catch{return null}if(!t)return null;const s=await(async e=>{if(!$)return e;const t=await T();if(!t)return e;try{const s=new Uint8Array(R(e)),a=s.slice(0,12),r=s.slice(12),l=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:a},t,r);return B.decode(l)}catch{return null}})(t);return s??null},removeItem(e){try{localStorage.removeItem(`${A}${e}`)}catch{}},clearSecureNamespace(){try{Object.keys(localStorage).filter(e=>e.startsWith(A)).forEach(e=>{try{localStorage.removeItem(e)}catch{}})}catch{}},clearSessionKey(){try{sessionStorage.removeItem(E)}catch{}}},I="https://sahtee.evra-co.com/api",H="auth_token",D={isRefreshing:!1,refreshSubscribers:[],subscribeTokenRefresh(e){this.refreshSubscribers.push(e)},onTokenRefreshed(e){this.refreshSubscribers.forEach(t=>t(e)),this.refreshSubscribers=[]},async refreshToken(){try{const e=await V.getItem(H);if(!e)return null;const t=await fetch(`${I}/admin/refresh`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Token refresh failed");const s=await t.json();return s.access_token?(await V.setItem(H,s.access_token),s.access_token):null}catch(e){return V.removeItem(H),window.location.hash="#/login",null}},async request(e,t={}){var s;const{skipAuth:a=!1,skipRateLimit:r=!1,retryCount:l=0,...n}=t;if(!r&&!M.canMakeRequest("api"))throw new Error("Too many requests. Please try again later.");const o=`${I}${e}`;let i=null;if(a||(i=await V.getItem(H)),!a){if(!i)throw new Error("No authentication token found");if(!(e=>{if(!e)return!1;const t=e.split(".");if(3!==t.length)return!1;try{return t.forEach(e=>atob(e.replace(/-/g,"+").replace(/_/g,"/"))),!0}catch{return!1}})(i))throw V.removeItem(H),new Error("Invalid authentication token");if((e=>{const t=S(e);return t&&t.exp?Date.now()>=1e3*t.exp:(null==t||t.exp,!1)})(i)){const e=await this.refreshToken();if(!e)throw V.removeItem(H),new Error("Authentication token expired");i=e}}const c=new Headers(n.headers||{});i&&!a&&c.set("Authorization",`Bearer ${i}`),n.body instanceof FormData||c.set("Content-Type","application/json"),c.set("Accept","application/json");const d=null==(s=document.querySelector('meta[name="csrf-token"]'))?void 0:s.getAttribute("content");d&&c.set("X-CSRF-Token",d);const m=new AbortController,x=setTimeout(()=>m.abort(),3e4),u={...n,headers:c,signal:m.signal,credentials:"same-origin"};try{const s=await fetch(o,u);clearTimeout(x);const r=await s.text(),l=r?JSON.parse(r):{};if(401===s.status&&!a){if(this.isRefreshing)return new Promise(s=>{this.subscribeTokenRefresh(a=>{s(this.request(e,t))})});{this.isRefreshing=!0;const s=await this.refreshToken();if(this.isRefreshing=!1,s)return this.onTokenRefreshed(s),this.request(e,t)}}if(!s.ok){const e=l.message||l.error||s.statusText||"An unknown error occurred";throw 403!==s.status||a?s.status>=500&&s.status:s.status,new Error(e)}return l}catch(p){if(clearTimeout(x),l<3&&("AbortError"===p.name||p.message.includes("network")||p.message.includes("fetch")))return await(h=1e3*(l+1),new Promise(e=>setTimeout(e,h))),this.request(e,{...t,retryCount:l+1});throw p.message,p}var h},get(e,t){return this.request(e,{...t,method:"GET",cache:"no-cache"})},post(e,t,s){if(t instanceof FormData){const a=new FormData;return t.forEach((e,t)=>{"string"==typeof e?a.append(t,C(e)):a.append(t,e)}),this.request(e,{...s,method:"POST",body:a})}const a=t?L(t):t;return this.request(e,{...s,method:"POST",body:void 0!==a?JSON.stringify(a):void 0})},put(e,t,s){const a=t?L(t):t;return this.request(e,{...s,method:"PUT",body:void 0!==a?JSON.stringify(a):void 0})},delete(e,t){return this.request(e,{...t,method:"DELETE"})},async uploadFile(e,t,s){if(t.size>10485760)throw new Error("File size exceeds 10MB limit");if(!["image/jpeg","image/png","image/jpg","application/pdf"].includes(t.type))throw new Error("File type not allowed");const a=new FormData;return a.append("file",t),s&&Object.entries(s).forEach(([e,t])=>{a.append(e,C(t))}),this.post(e,a)}},O=t.createContext(void 0),q=18e5,F="auth_token",U="sahtee_last_activity",G="csrf_token",J=({children:e})=>{const[s,a]=t.useState(null),[r,l]=t.useState(!0),[n,o]=t.useState(0),i=t.useRef(Date.now()),c=t.useRef(),d=t.useRef(),m=t.useCallback(()=>{i.current=Date.now(),localStorage.setItem(U,String(Date.now()))},[]),x=t.useCallback(async()=>{await g(),window.location.hash="#/login"},[]),u=t.useCallback(()=>{const e=Number(localStorage.getItem(U))||i.current;if(!((e,t=18e5)=>Date.now()-e<t)(e,q))return x(),!1;const t=Math.floor((q-(Date.now()-e))/1e3);return o(Math.max(0,t)),!0},[x]),h=t.useCallback(async()=>{const e=await V.getItem(F);if(!e)return;const t=(e=>{const t=S(e);if(!t||!t.exp)return 0;const s=1e3*t.exp-Date.now();return Math.max(0,Math.floor(s/1e3))})(e);if(t<600&&t>0)try{await D.refreshToken()}catch(s){}},[]);t.useEffect(()=>{if(!s)return;const e=["mousedown","keydown","scroll","touchstart","click"],t=()=>{m(),u()},a=()=>{"visible"===document.visibilityState&&(u(),h())};return e.forEach(e=>{document.addEventListener(e,t)}),document.addEventListener("visibilitychange",a),d.current=setInterval(()=>{u()||clearInterval(d.current)},6e4),c.current=setInterval(()=>{h()},3e5),()=>{e.forEach(e=>{document.removeEventListener(e,t)}),document.removeEventListener("visibilitychange",a),d.current&&clearInterval(d.current),c.current&&clearInterval(c.current)}},[s,m,u,h]),t.useEffect(()=>{window.self!==window.top&&(window.top.location=window.self.location)},[]),t.useEffect(()=>{const e=e=>{e.key===`${A}${F}`&&null===e.newValue&&x()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[x]),t.useEffect(()=>{if(!localStorage.getItem(G)){const e=(()=>{const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")})();localStorage.setItem(G,e);const t=document.createElement("meta");t.name="csrf-token",t.content=e,document.head.appendChild(t)}},[]),t.useEffect(()=>{(async()=>{if(await V.getItem(F))try{const e=await D.get("/admin/me");a(e),m(),e.id}catch(e){V.removeItem(F),a(null)}l(!1)})()},[m]);const p=async(e,t)=>{if(!(e=>/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e))(e))throw new Error("صيغة البريد الإلكتروني غير صحيحة");if(!z.canMakeRequest(e))throw z.getRemainingRequests(e),new Error("محاولات تسجيل دخول كثيرة. يرجى المحاولة بعد 5 دقائق.");const s=new FormData;s.append("email",e),s.append("password",t);try{const t=await D.post("/admin/login",s,{skipAuth:!0,skipRateLimit:!0});if(!t.access_token)throw new Error("فشل تسجيل الدخول، لم يتم استلام التوكن");await V.setItem(F,t.access_token),m();const l=await V.getItem(F);if(!l||l!==t.access_token)throw new Error("فشل في حفظ التوكن");try{const t=await D.get("/admin/me",{skipRateLimit:!0});if(!t||!t.id)throw new Error("بيانات المستخدم غير صحيحة");a(t),z.reset(e),t.id,t.email}catch(r){throw V.removeItem(F),new Error("فشل في الحصول على بيانات المستخدم: "+(r.message||"خطأ غير معروف"))}}catch(l){throw l.message.includes("محاولات")||l.message.includes("صيغة")||l.message.includes("استلام")||l.message,l}},g=async()=>{try{await V.getItem(F)&&await D.post("/admin/logout").catch(()=>{}),null==s||s.id}catch(e){await V.getItem(F)}finally{a(null),V.removeItem(F),V.clearSecureNamespace(),V.clearSessionKey(),localStorage.removeItem(U),d.current&&clearInterval(d.current),c.current&&clearInterval(c.current)}},v=t.useMemo(()=>({isAuthenticated:!!s,admin:s,login:p,logout:g,loading:r,sessionTimeRemaining:n}),[s,r,n]);return y.jsx(O.Provider,{value:v,children:e})},K=()=>{const e=t.useContext(O);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},Y=t.createContext(void 0),Z=({children:e})=>{const[s,a]=t.useState([]),[r,l]=t.useState(!1),n=t.useCallback(async()=>{try{l(!0);const e=await D.get("/admin/notifications");a(e.data||[])}catch(e){a([])}finally{l(!1)}},[]),o=s.filter(e=>!e.read).length;return t.useEffect(()=>{n();const e=setInterval(n,3e4);return()=>clearInterval(e)},[n]),y.jsx(Y.Provider,{value:{notifications:s,unreadCount:o,loading:r,fetchNotifications:n,markAsRead:async e=>{try{await D.put(`/admin/notifications/${e}/read`),a(t=>t.map(t=>t.id===e?{...t,read:!0}:t))}catch(t){}},markAllAsRead:async()=>{try{await D.put("/admin/notifications/read-all"),a(e=>e.map(e=>({...e,read:!0})))}catch(e){}},deleteNotification:async e=>{try{await D.delete(`/admin/notifications/${e}`),a(t=>t.filter(t=>t.id!==e))}catch(t){}}},children:e})},X=({label:e,error:t,icon:s,helperText:r,className:l="",id:n,...o})=>{const i=a.useId(),c=n??i;return y.jsxs("div",{className:"w-full",children:[e&&y.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-slate-300 mb-2",children:e}),y.jsxs("div",{className:"relative",children:[s&&y.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:s}),y.jsx("input",{id:c,className:`\n            w-full px-4 py-2.5 \n            ${s?"pr-10":""} \n            bg-slate-700/50 backdrop-blur-sm \n            border ${t?"border-red-500":"border-slate-600"} \n            rounded-lg text-white placeholder-slate-400 \n            transition-all duration-200\n            focus:outline-none focus:ring-2 \n            ${t?"focus:ring-red-500":"focus:ring-cyan-500"} \n            focus:border-transparent\n            hover:border-slate-500\n            ${l}\n          `,...o})]}),t&&y.jsxs("p",{className:"mt-1.5 text-xs text-red-400 flex items-center gap-1",children:[y.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),t]}),r&&!t&&y.jsx("p",{className:"mt-1.5 text-xs text-slate-400",children:r})]})},Q=a.memo(({variant:e="primary",size:s="md",isLoading:a=!1,icon:r,children:l,className:n="",disabled:o,...i})=>{const c=t.useMemo(()=>({primary:"bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white shadow-lg shadow-cyan-500/50 focus:ring-cyan-500",secondary:"bg-slate-700 hover:bg-slate-600 text-white shadow-lg shadow-slate-700/50 focus:ring-slate-500",success:"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600 text-white shadow-lg shadow-emerald-500/50 focus:ring-emerald-500",danger:"bg-gradient-to-r from-red-500 to-rose-500 hover:from-red-600 hover:to-rose-600 text-white shadow-lg shadow-red-500/50 focus:ring-red-500",warning:"bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white shadow-lg shadow-amber-500/50 focus:ring-amber-500",ghost:"bg-transparent hover:bg-slate-800/50 text-slate-300 hover:text-white border border-slate-700 hover:border-slate-600 focus:ring-slate-500"}),[]),d=t.useMemo(()=>({sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}),[]);return y.jsxs("button",{className:`inline-flex items-center justify-center gap-2 font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 disabled:opacity-50 disabled:cursor-not-allowed transform active:scale-95 ${c[e]} ${d[s]} ${n}`,disabled:o||a,...i,children:[a&&y.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!a&&r&&y.jsx("span",{children:r}),y.jsx("span",{children:l})]})}),ee=()=>{const[e,s]=t.useState(""),[a,r]=t.useState(""),[l,n]=t.useState(""),[o,i]=t.useState(!1),{login:c}=K();return y.jsxs("div",{className:"relative flex items-center justify-center min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 overflow-hidden p-3 sm:p-4",dir:"rtl",children:[y.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[y.jsx("div",{className:"absolute -top-20 sm:-top-40 -right-20 sm:-right-40 w-40 h-40 sm:w-80 sm:h-80 bg-cyan-500/30 rounded-full blur-3xl animate-pulse"}),y.jsx("div",{className:"absolute -bottom-20 sm:-bottom-40 -left-20 sm:-left-40 w-40 h-40 sm:w-80 sm:h-80 bg-blue-500/30 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),y.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-60 h-60 sm:w-96 sm:h-96 bg-purple-500/20 rounded-full blur-3xl animate-pulse",style:{animationDelay:"2s"}})]}),y.jsxs("div",{className:"relative w-full max-w-md animate-scale-in",children:[y.jsxs("div",{className:"relative p-6 sm:p-8 space-y-6 sm:space-y-8 bg-gradient-to-br from-slate-800/90 to-slate-900/90 backdrop-blur-xl rounded-xl sm:rounded-2xl shadow-2xl border border-slate-700/50",children:[y.jsxs("div",{className:"text-center space-y-3 sm:space-y-4",children:[y.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl sm:rounded-2xl bg-gradient-to-br from-cyan-500 to-blue-500 shadow-2xl shadow-cyan-500/50 animate-pulse-glow",children:y.jsx("svg",{className:"w-8 h-8 sm:w-10 sm:h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),y.jsxs("div",{children:[y.jsx("h1",{className:"text-3xl sm:text-4xl font-bold gradient-text mb-1 sm:mb-2",children:"صحتي"}),y.jsx("p",{className:"text-lg sm:text-xl font-semibold text-white",children:"لوحة التحكم"}),y.jsx("p",{className:"mt-2 text-sm sm:text-base text-slate-400",children:"مرحباً بعودتك! الرجاء تسجيل الدخول للمتابعة"})]})]}),y.jsxs("form",{className:"space-y-4 sm:space-y-6",onSubmit:async t=>{t.preventDefault(),n("");const r=C(e);if(r&&a.trim()){r!==e&&s(r),i(!0);try{await c(r,a)}catch(l){n(l.message||"فشل تسجيل الدخول. الرجاء التحقق من بيانات الاعتماد.")}finally{i(!1)}}else n("الرجاء إدخال البريد الإلكتروني وكلمة المرور.")},children:[y.jsx(X,{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>s(C(e.target.value)),label:"البريد الإلكتروني",placeholder:"admin@example.com",error:l&&!e?"الرجاء إدخال البريد الإلكتروني":"",icon:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})})}),y.jsx(X,{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:a,onChange:e=>r(e.target.value),label:"كلمة المرور",placeholder:"••••••••",error:l&&!a?"الرجاء إدخال كلمة المرور":"",icon:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l&&y.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-red-500/10 border border-red-500/30 animate-scale-in",children:[y.jsx("svg",{className:"w-5 h-5 text-red-400 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),y.jsx("p",{className:"text-red-400 text-sm flex-1",children:l})]}),y.jsx(Q,{type:"submit",variant:"primary",size:"lg",isLoading:o,className:"w-full",icon:!o&&y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),children:o?"جاري تسجيل الدخول...":"تسجيل الدخول"})]}),y.jsx("div",{className:"pt-4 sm:pt-6 border-t border-slate-700/50",children:y.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs sm:text-sm text-slate-400",children:[y.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),y.jsx("span",{className:"text-center",children:"جميع الحقوق محفوظة © 2025 صحتي"})]})})]}),y.jsx("div",{className:"absolute -top-3 sm:-top-4 -right-3 sm:-right-4 w-16 h-16 sm:w-24 sm:h-24 bg-gradient-to-br from-cyan-500/20 to-blue-500/20 rounded-full blur-2xl -z-10"}),y.jsx("div",{className:"absolute -bottom-3 sm:-bottom-4 -left-3 sm:-left-4 w-20 h-20 sm:w-32 sm:h-32 bg-gradient-to-br from-purple-500/20 to-pink-500/20 rounded-full blur-2xl -z-10"})]})]})},te=({to:e,icon:t,label:s,badge:a,onClick:l})=>y.jsx(r,{to:e,end:!0,onClick:l,className:({isActive:e})=>"flex items-center justify-between px-4 py-3 my-1 rounded-xl transition-all duration-200 group relative overflow-hidden\n                "+(e?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg shadow-cyan-500/30":"text-slate-300 hover:bg-slate-800/50 hover:text-white hover:translate-x-1"),children:({isActive:e})=>y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[y.jsx("span",{className:"transition-transform duration-200 "+(e?"":"group-hover:scale-110"),children:t}),y.jsx("span",{className:"font-medium text-sm",children:s})]}),void 0!==a&&a>0&&y.jsx("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full animate-pulse",children:a}),!e&&y.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500/0 to-blue-500/0 group-hover:from-cyan-500/10 group-hover:to-blue-500/10 transition-all duration-300"})]})}),se=({isOpen:e,onClose:t})=>y.jsxs(y.Fragment,{children:[e&&y.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 lg:hidden animate-fade-in",onClick:t}),y.jsxs("aside",{className:`\n        fixed lg:static inset-y-0 right-0 z-50\n        w-64 bg-gradient-to-b from-slate-900 to-slate-950\n        border-l border-slate-700/50 h-full flex flex-col\n        transition-all duration-300 shadow-2xl\n        ${e?"translate-x-0":"translate-x-full lg:translate-x-0"}\n      `,children:[y.jsxs("div",{className:"flex items-center justify-between h-20 border-b border-slate-700/50 px-4",children:[y.jsxs("div",{className:"text-center flex-1",children:[y.jsx("h1",{className:"text-2xl font-bold gradient-text",children:"صحتي"}),y.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"لوحة التحكم"})]}),y.jsx("button",{onClick:t,className:"lg:hidden p-2 rounded-lg hover:bg-slate-800 transition-colors",children:y.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),y.jsxs("nav",{className:"flex-1 px-3 py-6 overflow-y-auto custom-scrollbar",children:[y.jsx(te,{to:"/",label:"لوحة التحكم",icon:y.jsx(ae,{}),onClick:t}),y.jsx(te,{to:"/approvals",label:"طلبات الموافقة",icon:y.jsx(re,{}),onClick:t}),y.jsxs("div",{className:"px-4 mt-6 mb-2 flex items-center gap-2",children:[y.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"}),y.jsx("p",{className:"text-xs uppercase text-slate-500 font-semibold",children:"الإدارة"}),y.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"})]}),y.jsx(te,{to:"/users",label:"المستخدمون",icon:y.jsx(le,{}),onClick:t}),y.jsx(te,{to:"/doctors",label:"الأطباء",icon:y.jsx(ne,{}),onClick:t}),y.jsx(te,{to:"/nurses",label:"الممرضون",icon:y.jsx(oe,{}),onClick:t}),y.jsx(te,{to:"/hospitals",label:"المشافي",icon:y.jsx(ie,{}),onClick:t}),y.jsxs("div",{className:"px-4 mt-6 mb-2 flex items-center gap-2",children:[y.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"}),y.jsx("p",{className:"text-xs uppercase text-slate-500 font-semibold",children:"الخدمات"}),y.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"})]}),y.jsx(te,{to:"/specializations",label:"التخصصات",icon:y.jsx(ce,{}),onClick:t}),y.jsx(te,{to:"/hospital-services",label:"خدمات المشافي",icon:y.jsx(de,{}),onClick:t})]}),y.jsx("div",{className:"p-4 border-t border-slate-700/50",children:y.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-br from-cyan-500/10 to-blue-500/10 border border-cyan-500/20",children:y.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[y.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center",children:y.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),y.jsxs("div",{children:[y.jsx("p",{className:"text-xs font-semibold text-cyan-400",children:"الإصدار"}),y.jsx("p",{className:"text-xs text-slate-400",children:"v1.0.0"})]})]})})})]})]}),ae=()=>y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),re=()=>y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),le=()=>y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 016-6h6a6 6 0 016 6v1h-1M15 21a3 3 0 116 0v-1a3 3 0 11-6 0v1z"})}),ne=()=>y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547a2 2 0 00-.547 1.806l.477 2.387a6 6 0 00.517 3.86l.158.318a6 6 0 00.517 3.86l2.387.477a2 2 0 001.806-.547a2 2 0 00.547-1.806l-.477-2.387a6 6 0 00-.517-3.86l-.158-.318a6 6 0 00-.517-3.86l-2.387-.477zM12 12a3 3 0 100-6 3 3 0 000 6z"})}),oe=()=>y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),ie=()=>y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),ce=()=>y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16v4m-2-2h4m5 10v4m-2-2h4M5 11h14M5 11a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v3a2 2 0 01-2 2M5 11a2 2 0 00-2 2v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 00-2-2"})}),de=()=>y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),me=e=>e.toLocaleLowerCase("ar-SY"),xe=e=>e.map(e=>null==e?"":String(e).toLocaleLowerCase("ar-SY")).filter(Boolean).join(" "),ue={hospital:{endpoint:"/admin/hospital/all",key:"hospitals",perPage:100},doctor:{endpoint:"/admin/doctor/all",key:"doctors",perPage:100},nurse:{endpoint:"/admin/nurse/all",key:"nurses",perPage:100},user:{endpoint:"/admin/user/all",key:"users",perPage:100}},he=()=>{const[e,s]=t.useState(""),[a,r]=t.useState([]),[n,o]=t.useState(!1),[i,c]=t.useState(!1),d=t.useRef(null),m=l(),x=t.useRef(0),u=t.useRef(!1),h=t.useRef({hospital:{data:null,promise:null,lastFetchedAt:null,normalized:null},doctor:{data:null,promise:null,lastFetchedAt:null,normalized:null},nurse:{data:null,promise:null,lastFetchedAt:null,normalized:null},user:{data:null,promise:null,lastFetchedAt:null,normalized:null}}),p=t.useCallback((e,t,s)=>{var a;let r=[],l=s;return(null==(a=null==e?void 0:e[t])?void 0:a.data)&&Array.isArray(e[t].data)?(r=e[t].data,l=e[t].last_page??l):(null==e?void 0:e[t])&&Array.isArray(e[t])?r=e[t]:(null==e?void 0:e.data)&&Array.isArray(e.data)?r=e.data:Array.isArray(e)&&(r=e),(!Number.isFinite(l)||l<1)&&(l=s),{data:r,lastPage:l}},[]),g=t.useCallback(async e=>{const t=ue[e],s=[],a=await D.get(`${t.endpoint}?page=1&per_page=${t.perPage}`).catch(()=>null);if(!a)return s;const{data:r,lastPage:l}=p(a,t.key,1);s.push(...r);const n=Math.min(Math.max(l,1),3);if(n>1){const e=[];for(let s=2;s<=n;s++)e.push(D.get(`${t.endpoint}?page=${s}&per_page=${t.perPage}`).catch(()=>null));(await Promise.all(e)).forEach(e=>{if(!e)return;const{data:a}=p(e,t.key,1);s.push(...a)})}return s},[p]),v=t.useCallback(async e=>{const t=h.current[e];return t.data?t.data:(t.promise||(t.promise=g(e).then(e=>(t.data=e,t.lastFetchedAt=Date.now(),t.normalized=null,e)).catch(e=>{throw t.data=null,t.lastFetchedAt=null,t.normalized=null,e}).finally(()=>{t.promise=null})),t.promise)},[g]);t.useEffect(()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),t.useEffect(()=>{const t=setTimeout(()=>{e.trim().length>=2?f(e.trim()):r([])},300);return()=>clearTimeout(t)},[e]);const j=t.useCallback(async()=>{if(u.current)return;u.current=!0;const e=["hospital","doctor","nurse","user"];for(const t of e)try{await v(t)}catch{}},[v]),f=async e=>{const t=++x.current;o(!0);try{const[s,a,l,n]=await Promise.all([b(e),w(e),N(e),k(e)]),o=[...s,...a,...l,...n];x.current===t&&(r(o),c(!0))}catch(s){x.current===t&&(r([]),c(!1))}finally{x.current===t&&o(!1)}},b=async e=>{var t,s;try{const a=h.current.hospital,r=await v("hospital");a.normalized&&a.normalized.length===r.length||(a.normalized=r.map(e=>{var t,s;return xe([null==e?void 0:e.full_name,null==(t=null==e?void 0:e.account)?void 0:t.email,null==e?void 0:e.address,null==(s=null==e?void 0:e.account)?void 0:s.phone_number])}));const l=me(e.trim()),n=[];for(let e=0;e<r.length&&!(n.length>=5);e++){if(!(null==(t=a.normalized)?void 0:t[e]))continue;if(!a.normalized[e].includes(l))continue;const o=r[e];(null==o?void 0:o.id)&&n.push({id:o.id,type:"hospital",name:o.full_name||"غير محدد",subtitle:(null==(s=o.account)?void 0:s.email)||o.address||"",data:o})}return n}catch(a){return[]}},w=async e=>{var t,s,a;try{const r=h.current.doctor,l=await v("doctor");r.normalized&&r.normalized.length===l.length||(r.normalized=l.map(e=>{var t,s,a,r;return xe([null==e?void 0:e.full_name,null==(t=null==e?void 0:e.account)?void 0:t.email,null==(s=null==e?void 0:e.account)?void 0:s.phone_number,null==(a=null==e?void 0:e.specialization)?void 0:a.name_ar,null==(r=null==e?void 0:e.specialization)?void 0:r.name_en])}));const n=me(e.trim()),o=[];for(let e=0;e<l.length&&!(o.length>=5);e++){if(!(null==(t=r.normalized)?void 0:t[e]))continue;if(!r.normalized[e].includes(n))continue;const i=l[e];(null==i?void 0:i.id)&&o.push({id:i.id,type:"doctor",name:i.full_name,subtitle:(null==(s=i.specialization)?void 0:s.name_ar)||(null==(a=i.account)?void 0:a.email),data:i})}return o}catch(r){return[]}},N=async e=>{var t,s;try{const a=h.current.nurse,r=await v("nurse");a.normalized&&a.normalized.length===r.length||(a.normalized=r.map(e=>{var t,s;return xe([null==e?void 0:e.full_name,null==(t=null==e?void 0:e.account)?void 0:t.email,null==(s=null==e?void 0:e.account)?void 0:s.phone_number,null==e?void 0:e.graduation_type,null==e?void 0:e.address])}));const l=me(e.trim()),n=[];for(let e=0;e<r.length&&!(n.length>=5);e++){if(!(null==(t=a.normalized)?void 0:t[e]))continue;if(!a.normalized[e].includes(l))continue;const o=r[e];(null==o?void 0:o.id)&&n.push({id:o.id,type:"nurse",name:o.full_name,subtitle:o.graduation_type||(null==(s=o.account)?void 0:s.email),data:o})}return n}catch(a){return[]}},k=async e=>{var t,s;try{const a=h.current.user,r=await v("user");a.normalized&&a.normalized.length===r.length||(a.normalized=r.map(e=>{var t,s,a;return xe([null==e?void 0:e.full_name,null==(t=null==e?void 0:e.account)?void 0:t.email,null==(s=null==e?void 0:e.account)?void 0:s.phone_number,null==(a=null==e?void 0:e.account)?void 0:a.username,null==e?void 0:e.address])}));const l=me(e.trim()),n=[];for(let e=0;e<r.length&&!(n.length>=5);e++){if(!(null==(t=a.normalized)?void 0:t[e]))continue;if(!a.normalized[e].includes(l))continue;const o=r[e];(null==o?void 0:o.id)&&n.push({id:o.id,type:"user",name:o.full_name,subtitle:null==(s=o.account)?void 0:s.email,data:o})}return n}catch(a){return[]}},C=e=>{switch(e){case"hospital":return"مشفى";case"doctor":return"طبيب";case"nurse":return"ممرض/ة";case"user":return"مستخدم"}},L=e=>{switch(e){case"hospital":return y.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"doctor":return y.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})});case"nurse":return y.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})});case"user":return y.jsx("svg",{className:"w-5 h-5 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}},_=e=>{switch(e){case"hospital":return"bg-blue-500/10 text-blue-400 border-blue-500/30";case"doctor":return"bg-green-500/10 text-green-400 border-green-500/30";case"nurse":return"bg-purple-500/10 text-purple-400 border-purple-500/30";case"user":return"bg-cyan-500/10 text-cyan-400 border-cyan-500/30"}};return y.jsxs("div",{ref:d,className:"relative w-full max-w-2xl",children:[y.jsxs("div",{className:"relative",children:[y.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:n?y.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),y.jsx("input",{type:"text",value:e,onChange:e=>s(e.target.value),onFocus:()=>e.trim().length>=2&&a.length>0&&c(!0),onClick:()=>{e.trim().length>=2&&a.length>0&&c(!0)},onFocusCapture:()=>{j()},onClickCapture:()=>{j()},placeholder:"ابحث... (2 أحرف على الأقل)",className:"w-full pr-10 pl-4 py-2.5 bg-slate-700/50 backdrop-blur-sm border border-slate-600 rounded-lg text-white placeholder-slate-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent hover:border-slate-500"}),e&&y.jsx("button",{onClick:()=>{s(""),r([]),c(!1),x.current+=1},className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white transition-colors",children:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),i&&a.length>0&&y.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl max-h-96 overflow-y-auto custom-scrollbar z-50 animate-scale-in",children:y.jsxs("div",{className:"p-2",children:[y.jsxs("div",{className:"text-xs text-slate-400 px-3 py-2 font-medium",children:["تم العثور على ",a.length," نتيجة"]}),a.map((e,t)=>y.jsx("button",{onClick:()=>(e=>{switch(s(""),c(!1),r([]),e.type){case"hospital":m(`/hospitals/${e.id}`);break;case"doctor":m(`/doctors/${e.id}`);break;case"nurse":m(`/nurses/${e.id}`)}})(e),className:"w-full text-right px-3 py-3 rounded-lg hover:bg-slate-700/50 transition-colors group",children:y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"flex-shrink-0",children:L(e.type)}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("p",{className:"text-sm font-medium text-white truncate group-hover:text-cyan-400 transition-colors",children:e.name}),y.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full border ${_(e.type)} flex-shrink-0`,children:C(e.type)})]}),e.subtitle&&y.jsx("p",{className:"text-xs text-slate-400 truncate mt-0.5",children:e.subtitle})]}),y.jsx("svg",{className:"w-4 h-4 text-slate-500 group-hover:text-cyan-400 transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})]})},`${e.type}-${e.id}-${t}`))]})}),i&&e.trim().length>=2&&0===a.length&&!n&&y.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl p-6 text-center z-50 animate-scale-in",children:[y.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-full bg-slate-700/50 flex items-center justify-center",children:y.jsx("svg",{className:"w-8 h-8 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),y.jsxs("p",{className:"text-slate-400 text-sm",children:['لم يتم العثور على نتائج لـ "',e,'"']}),y.jsx("p",{className:"text-slate-500 text-xs mt-1",children:"جرب البحث بكلمات أخرى أو تحقق من الإملاء"})]}),1===e.trim().length&&y.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl p-4 text-center z-50 animate-scale-in",children:y.jsx("p",{className:"text-slate-400 text-sm",children:"اكتب حرفاً آخر للبحث..."})})]})},pe=({onMenuClick:e})=>{const{admin:s,logout:a}=K(),{notifications:r,unreadCount:l,markAsRead:n,markAllAsRead:o,deleteNotification:i}=(()=>{const e=t.useContext(Y);if(void 0===e)throw new Error("useNotifications must be used within a NotificationProvider");return e})(),[c,d]=t.useState(!1),m=t.useRef(null);t.useEffect(()=>{const e=e=>{m.current&&!m.current.contains(e.target)&&d(!1)};return c&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[c]);const x=e=>{switch(e){case"approval":return y.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"reservation":return y.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})});case"alert":return y.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});default:return y.jsx("svg",{className:"w-5 h-5 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},u=e=>{const t=new Date(e),s=(new Date).getTime()-t.getTime(),a=Math.floor(s/36e5),r=Math.floor(a/24);if(r>0)return`منذ ${r} ${1===r?"يوم":"أيام"}`;if(a>0)return`منذ ${a} ${1===a?"ساعة":"ساعات"}`;{const e=Math.floor(s/6e4);return`منذ ${e} ${1===e?"دقيقة":"دقائق"}`}};return y.jsxs("header",{className:"bg-gradient-to-r from-slate-900/95 to-slate-800/95 backdrop-blur-md shadow-lg p-3 md:p-4 flex justify-between items-center z-10 border-b border-slate-700/50 animate-slide-down",children:[y.jsx("button",{onClick:e,className:"lg:hidden p-2 rounded-lg hover:bg-slate-700/50 transition-colors",children:y.jsx("svg",{className:"w-6 h-6 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),y.jsx("div",{className:"flex-1 px-2 md:px-4 max-w-3xl hidden sm:block",children:y.jsx(he,{})}),y.jsx("div",{className:"flex-1 sm:hidden"}),y.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[y.jsxs("div",{className:"relative",ref:m,children:[y.jsxs("button",{onClick:()=>d(!c),className:"relative p-2 rounded-lg hover:bg-slate-700/50 transition-colors group",children:[y.jsx("svg",{className:"w-6 h-6 text-slate-300 group-hover:text-cyan-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),l>0&&y.jsx("span",{className:"absolute top-0 right-0 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center animate-pulse",children:l>9?"9+":l})]}),c&&y.jsxs("div",{className:"absolute left-0 mt-2 w-96 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl animate-scale-in overflow-hidden z-50",children:[y.jsxs("div",{className:"p-4 border-b border-slate-700/50 flex items-center justify-between",children:[y.jsx("h3",{className:"font-bold text-white",children:"الإشعارات"}),r.length>0&&l>0&&y.jsx("button",{onClick:o,className:"text-xs text-cyan-400 hover:text-cyan-300 transition-colors",children:"تعليم الكل كمقروء"})]}),y.jsx("div",{className:"max-h-96 overflow-y-auto custom-scrollbar",children:0===r.length?y.jsxs("div",{className:"p-8 text-center",children:[y.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-slate-700/50 flex items-center justify-center",children:y.jsx("svg",{className:"w-8 h-8 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),y.jsx("p",{className:"text-slate-400 text-sm",children:"لا توجد إشعارات جديدة"})]}):y.jsx("div",{className:"divide-y divide-slate-700/50",children:r.map(e=>y.jsx("div",{onClick:()=>(async e=>{e.read||await n(e.id)})(e),className:"p-4 hover:bg-slate-700/30 transition-colors cursor-pointer "+(e.read?"":"bg-cyan-500/5"),children:y.jsxs("div",{className:"flex gap-3",children:[y.jsx("div",{className:"flex-shrink-0 mt-1",children:x(e.type)}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsxs("div",{className:"flex items-start justify-between gap-2",children:[y.jsx("p",{className:"text-sm font-semibold text-white",children:e.title}),!e.read&&y.jsx("span",{className:"w-2 h-2 bg-cyan-400 rounded-full flex-shrink-0 mt-1"})]}),y.jsx("p",{className:"text-sm text-slate-300 mt-1 line-clamp-2",children:e.message}),y.jsxs("div",{className:"flex items-center justify-between mt-2",children:[y.jsx("span",{className:"text-xs text-slate-500",children:u(e.created_at)}),y.jsx("button",{onClick:t=>{t.stopPropagation(),i(e.id)},className:"text-xs text-red-400 hover:text-red-300 transition-colors",children:"حذف"})]})]})]})},e.id))})})]})]}),y.jsxs("div",{className:"relative group",children:[y.jsxs("button",{className:"flex items-center gap-2 md:gap-3 px-2 md:px-3 py-2 rounded-lg hover:bg-slate-700/50 transition-all duration-200",children:[y.jsxs("div",{className:"text-right hidden md:block",children:[y.jsx("p",{className:"font-semibold text-white text-sm",children:null==s?void 0:s.full_name}),y.jsx("p",{className:"text-xs text-slate-400",children:null==s?void 0:s.email})]}),y.jsxs("div",{className:"relative",children:[y.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center shadow-lg",children:y.jsx("svg",{className:"w-6 h-6 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),y.jsx("span",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-400 border-2 border-slate-900 rounded-full"})]})]}),y.jsxs("div",{className:"absolute left-0 mt-2 w-56 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 overflow-hidden animate-scale-in",children:[y.jsxs("div",{className:"p-3 border-b border-slate-700/50",children:[y.jsx("p",{className:"text-sm font-medium text-white",children:null==s?void 0:s.full_name}),y.jsx("p",{className:"text-xs text-slate-400",children:null==s?void 0:s.email})]}),y.jsxs("button",{className:"w-full text-right px-4 py-3 text-sm text-slate-300 hover:bg-slate-700/50 transition-colors flex items-center gap-2",children:[y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"الملف الشخصي"]}),y.jsxs("button",{className:"w-full text-right px-4 py-3 text-sm text-slate-300 hover:bg-slate-700/50 transition-colors flex items-center gap-2",children:[y.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"الإعدادات"]}),y.jsx("div",{className:"border-t border-slate-700/50",children:y.jsxs("button",{onClick:a,className:"w-full text-right px-4 py-3 text-sm text-red-400 hover:bg-red-500/10 transition-colors flex items-center gap-2",children:[y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"تسجيل الخروج"]})})]})]})]})]})},ge=()=>{const[e,s]=t.useState(!1);return y.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 text-slate-100 overflow-hidden",dir:"rtl",children:[y.jsx(se,{isOpen:e,onClose:()=>s(!1)}),y.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden w-full",children:[y.jsx(pe,{onMenuClick:()=>s(!0)}),y.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gradient-to-br from-slate-900/50 to-slate-800/50 p-3 sm:p-4 md:p-6 custom-scrollbar",children:y.jsx("div",{className:"max-w-7xl mx-auto",children:y.jsx(n,{})})})]}),y.jsxs("div",{className:"fixed inset-0 pointer-events-none overflow-hidden -z-10",children:[y.jsx("div",{className:"absolute top-1/4 -right-48 w-96 h-96 bg-cyan-500/5 rounded-full blur-3xl"}),y.jsx("div",{className:"absolute bottom-1/4 -left-48 w-96 h-96 bg-blue-500/5 rounded-full blur-3xl"})]})]})},ve=({children:e,className:t="",gradient:s=!1,hover:a=!1,onClick:r})=>{const l=s?"bg-gradient-to-br from-slate-800/90 to-slate-900/90 border-slate-700/50 backdrop-blur-sm":"bg-slate-800/50 border-slate-700",n=a?"hover:shadow-xl hover:shadow-cyan-500/10 hover:-translate-y-1 hover:border-cyan-500/50 cursor-pointer":"";return y.jsx("div",{className:`rounded-xl border transition-all duration-300 ${l} ${n} ${t}`,onClick:r,children:e})},je=({title:e,value:s,icon:a,color:r,loading:l,delay:n=0,onClick:o})=>{const[i,c]=t.useState(!1);return t.useEffect(()=>{const e=setTimeout(()=>c(!0),n);return()=>clearTimeout(e)},[n]),y.jsx(ve,{gradient:!0,hover:!0,onClick:o,className:"p-4 md:p-6 card-shine transform transition-all duration-500 "+(i?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"text-slate-400 text-xs md:text-sm font-medium mb-2",children:e}),l?y.jsx("div",{className:"h-8 w-20 skeleton rounded"}):y.jsx("p",{className:"text-2xl md:text-3xl font-bold text-white mb-2",children:s})]}),y.jsx("div",{className:`p-3 md:p-4 rounded-2xl ${r} shadow-lg transform transition-transform duration-300 hover:scale-110`,children:a})]})})},fe=({title:e,description:t,icon:s,color:a,onClick:r})=>y.jsxs("button",{onClick:r,className:`p-4 rounded-xl ${a} border border-slate-700/50 hover:border-cyan-500/50 transition-all duration-200 hover:shadow-xl hover:shadow-cyan-500/10 hover:-translate-y-1 group text-right w-full`,children:[y.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[y.jsx("div",{className:"p-2 rounded-lg bg-white/10 group-hover:bg-white/20 transition-colors",children:s}),y.jsx("h3",{className:"text-white font-semibold text-sm md:text-base",children:e})]}),y.jsx("p",{className:"text-slate-400 text-xs md:text-sm",children:t})]}),be=()=>{const e=l(),[s,a]=t.useState(new Date),[r,n]=t.useState(!0),[o,i]=t.useState({pendingCount:0,doctorsCount:0,usersCount:0,hospitalsCount:0});return t.useEffect(()=>{const e=setInterval(()=>a(new Date),1e3);return()=>clearInterval(e)},[]),t.useEffect(()=>{(async()=>{var e,t,s,a,r,l,o,c;n(!0);try{const[n,d,m,x,u]=await Promise.all([D.post("/admin/get-pending-accounts",{role:"doctor"}).catch(()=>({data:[]})),D.post("/admin/get-pending-accounts",{role:"nurse"}).catch(()=>({data:[]})),D.get("/admin/doctor/all?per_page=10000").catch(()=>({doctors:[]})),D.get("/admin/user/all?per_page=10000").catch(()=>({users:[]})),D.get("/admin/hospital/all?per_page=10000").catch(()=>({hospitals:{data:[]}}))]);let h=0;(null==(e=m.doctors)?void 0:e.total)?h=m.doctors.total:m.total?h=m.total:(null==(t=m.doctors)?void 0:t.data)&&Array.isArray(m.doctors.data)?h=m.doctors.data.length:m.doctors&&Array.isArray(m.doctors)?h=m.doctors.length:m.data&&Array.isArray(m.data)?h=m.data.length:Array.isArray(m)&&(h=m.length);let p=0;(null==(s=x.users)?void 0:s.total)?p=x.users.total:x.total?p=x.total:(null==(a=x.users)?void 0:a.data)&&Array.isArray(x.users.data)?p=x.users.data.length:x.users&&Array.isArray(x.users)?p=x.users.length:x.data&&Array.isArray(x.data)?p=x.data.length:Array.isArray(x)&&(p=x.length);let g=0;(null==(r=u.hospitals)?void 0:r.total)?g=u.hospitals.total:u.total?g=u.total:(null==(l=u.hospitals)?void 0:l.data)&&Array.isArray(u.hospitals.data)?g=u.hospitals.data.length:u.hospitals&&Array.isArray(u.hospitals)?g=u.hospitals.length:u.data&&Array.isArray(u.data)?g=u.data.length:Array.isArray(u)&&(g=u.length),i({pendingCount:((null==(o=n.data)?void 0:o.length)||0)+((null==(c=d.data)?void 0:c.length)||0),doctorsCount:h,usersCount:p,hospitalsCount:g})}catch(d){}finally{n(!1)}})()},[]),y.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[y.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-4",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold gradient-text mb-2",children:"لوحة التحكم الرئيسية"}),y.jsx("p",{className:"text-sm md:text-base text-slate-400",children:"مرحباً بك، إليك نظرة عامة على النظام"})]}),y.jsxs("div",{className:"text-right md:text-left",children:[y.jsx("p",{className:"text-xl md:text-2xl font-bold text-white",children:s.toLocaleTimeString("ar-EG")}),y.jsx("p",{className:"text-xs md:text-sm text-slate-400 hidden sm:block",children:s.toLocaleDateString("ar-EG",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),y.jsx("p",{className:"text-xs md:text-sm text-slate-400 sm:hidden",children:s.toLocaleDateString("ar-EG",{day:"numeric",month:"short"})})]})]}),y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4 lg:gap-6",children:[y.jsx(je,{title:"طلبات موافقة",value:o.pendingCount,icon:y.jsx(we,{}),color:"bg-gradient-to-br from-amber-500/20 to-orange-500/20 text-amber-300",loading:r,delay:0,onClick:()=>e("/approvals")}),y.jsx(je,{title:"إجمالي الأطباء",value:o.doctorsCount,icon:y.jsx(Ne,{}),color:"bg-gradient-to-br from-cyan-500/20 to-blue-500/20 text-cyan-300",loading:r,delay:100,onClick:()=>e("/doctors")}),y.jsx(je,{title:"إجمالي المستخدمين",value:o.usersCount,icon:y.jsx(ye,{}),color:"bg-gradient-to-br from-emerald-500/20 to-green-500/20 text-emerald-300",loading:r,delay:200,onClick:()=>e("/users")}),y.jsx(je,{title:"إجمالي المشافي",value:o.hospitalsCount,icon:y.jsx(ke,{}),color:"bg-gradient-to-br from-rose-500/20 to-red-500/20 text-rose-300",loading:r,delay:300,onClick:()=>e("/hospitals")})]}),y.jsxs(ve,{gradient:!0,className:"p-4 md:p-6",children:[y.jsxs("h2",{className:"text-lg md:text-xl font-bold text-white mb-4 md:mb-6 flex items-center gap-2",children:[y.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"إجراءات سريعة"]}),y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",children:[y.jsx(fe,{title:"مراجعة الطلبات",description:"عرض طلبات الموافقة المعلقة",icon:y.jsx(we,{}),color:"bg-gradient-to-br from-amber-500/10 to-orange-500/10",onClick:()=>e("/approvals")}),y.jsx(fe,{title:"إدارة الأطباء",description:"عرض وإدارة الأطباء",icon:y.jsx(Ne,{}),color:"bg-gradient-to-br from-cyan-500/10 to-blue-500/10",onClick:()=>e("/doctors")}),y.jsx(fe,{title:"إدارة المشافي",description:"عرض وإدارة المشافي",icon:y.jsx(ke,{}),color:"bg-gradient-to-br from-emerald-500/10 to-green-500/10",onClick:()=>e("/hospitals")})]})]}),y.jsxs(ve,{gradient:!0,className:"p-4 md:p-6",children:[y.jsxs("h2",{className:"text-lg md:text-xl font-bold text-white mb-4 md:mb-6 flex items-center gap-2",children:[y.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"حالة النظام"]}),y.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[y.jsxs("div",{className:"p-3 md:p-4 rounded-lg bg-emerald-500/10 border border-emerald-500/30",children:[y.jsxs("div",{className:"flex items-center justify-between mb-2",children:[y.jsx("span",{className:"text-xs md:text-sm text-slate-300",children:"الخادم"}),y.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"})]}),y.jsx("p",{className:"text-xs text-emerald-400 font-medium",children:"نشط ويعمل"})]}),y.jsxs("div",{className:"p-3 md:p-4 rounded-lg bg-emerald-500/10 border border-emerald-500/30",children:[y.jsxs("div",{className:"flex items-center justify-between mb-2",children:[y.jsx("span",{className:"text-xs md:text-sm text-slate-300",children:"قاعدة البيانات"}),y.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"})]}),y.jsx("p",{className:"text-xs text-emerald-400 font-medium",children:"متصلة"})]}),y.jsxs("div",{className:"p-3 md:p-4 rounded-lg bg-emerald-500/10 border border-emerald-500/30",children:[y.jsxs("div",{className:"flex items-center justify-between mb-2",children:[y.jsx("span",{className:"text-xs md:text-sm text-slate-300",children:"API"}),y.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"})]}),y.jsx("p",{className:"text-xs text-emerald-400 font-medium",children:"جاهز"})]}),y.jsxs("div",{className:"p-3 md:p-4 rounded-lg bg-cyan-500/10 border border-cyan-500/30",children:[y.jsxs("div",{className:"flex items-center justify-between mb-2",children:[y.jsx("span",{className:"text-xs md:text-sm text-slate-300",children:"الأداء"}),y.jsx("span",{className:"text-xs text-cyan-400 font-bold",children:"98%"})]}),y.jsx("div",{className:"w-full bg-slate-700 rounded-full h-1.5",children:y.jsx("div",{className:"bg-gradient-to-r from-cyan-400 to-blue-500 h-1.5 rounded-full",style:{width:"98%"}})})]})]})]})]})},we=()=>y.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),ye=()=>y.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 016-6h6a6 6 0 016 6v1h-1M15 21a3 3 0 116 0v-1a3 3 0 11-6 0v1z"})}),Ne=()=>y.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),ke=()=>y.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),Ce=({value:e,onChange:t,placeholder:s="بحث...",className:a=""})=>y.jsxs("div",{className:`relative ${a}`,children:[y.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),y.jsx("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:s,className:"w-full pr-10 pl-4 py-2.5 bg-slate-700/50 backdrop-blur-sm border border-slate-600 rounded-lg text-white placeholder-slate-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent hover:border-slate-500"}),e&&y.jsx("button",{onClick:()=>t(""),className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white transition-colors",children:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),Le=({icon:e,title:t,description:s,action:a})=>y.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[e&&y.jsx("div",{className:"mb-6 p-4 rounded-full bg-slate-700/30 text-slate-400",children:e}),y.jsx("h3",{className:"text-lg font-semibold text-slate-300 mb-2",children:t}),s&&y.jsx("p",{className:"text-sm text-slate-400 text-center max-w-md mb-6",children:s}),a&&y.jsx("button",{onClick:a.onClick,className:"px-6 py-2.5 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white rounded-lg font-medium transition-all duration-200 shadow-lg shadow-cyan-500/30 transform hover:scale-105",children:a.label})]}),_e=({size:e="md",text:t})=>{const s={sm:"w-6 h-6",md:"w-12 h-12",lg:"w-16 h-16"};return y.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[y.jsxs("div",{className:"relative",children:[y.jsx("div",{className:`${s[e]} border-4 border-slate-700 border-t-cyan-500 rounded-full animate-spin`}),y.jsx("div",{className:`${s[e]} border-4 border-transparent border-t-cyan-400 rounded-full animate-spin absolute top-0 left-0`,style:{animationDirection:"reverse",animationDuration:"1s"}})]}),t&&y.jsx("p",{className:"text-slate-400 text-sm font-medium animate-pulse",children:t})]})};const Me=a.memo(function({data:e,columns:s,loading:a=!1,searchable:r=!0,searchPlaceholder:l="بحث...",emptyMessage:n="لا توجد بيانات لعرضها",itemsPerPage:o=10,onRowClick:i}){const[c,d]=t.useState(""),[m,x]=t.useState(1),[u,h]=t.useState(null),[p,g]=t.useState("asc"),v=(e,t)=>null!=e&&("object"!=typeof e?String(e).toLowerCase().includes(t.toLowerCase()):Array.isArray(e)?e.some(e=>v(e,t)):Object.values(e).some(e=>v(e,t))),j=t.useMemo(()=>c?e.filter(e=>v(e,c)):e,[e,c]),f=t.useMemo(()=>u?[...j].sort((e,t)=>{const a=s.find(e=>String(e.accessor)===u);if(!a)return 0;let r,l;return"function"==typeof a.accessor?0:(r=e[a.accessor],l=t[a.accessor],null==r?1:null==l?-1:"string"==typeof r&&"string"==typeof l?"asc"===p?r.localeCompare(l):l.localeCompare(r):r<l?"asc"===p?-1:1:r>l?"asc"===p?1:-1:0)}):j,[j,u,p,s]),b=t.useMemo(()=>{const e=(m-1)*o;return f.slice(e,e+o)},[f,m,o]),w=Math.ceil(f.length/o),N=(e,t)=>"function"==typeof t.accessor?t.accessor(e):e[t.accessor];return y.jsxs("div",{className:"space-y-3 md:space-y-4",children:[r&&y.jsx(Ce,{value:c,onChange:d,placeholder:l,className:"w-full md:max-w-md"}),y.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 border border-slate-700/50 rounded-lg md:rounded-xl shadow-xl overflow-hidden backdrop-blur-sm",children:[y.jsx("div",{className:"overflow-x-auto custom-scrollbar -mx-2 sm:mx-0",children:y.jsxs("table",{className:"w-full text-xs sm:text-sm text-right text-slate-300 min-w-[600px]",children:[y.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800/80 backdrop-blur-sm sticky top-0 z-10",children:y.jsx("tr",{children:s.map((e,t)=>y.jsx("th",{scope:"col",className:`px-3 sm:px-4 md:px-6 py-3 md:py-4 whitespace-nowrap ${e.sortable&&"function"!=typeof e.accessor?"cursor-pointer hover:text-cyan-400 transition-colors select-none":""} ${e.className||""}`,onClick:()=>{return t=String(e.accessor),void(e.sortable&&"function"!=typeof e.accessor&&(u===t?g("asc"===p?"desc":"asc"):(h(t),g("asc"))));var t},children:y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{children:e.header}),e.sortable&&"function"!=typeof e.accessor&&u===String(e.accessor)&&y.jsx("svg",{className:"w-4 h-4 transform transition-transform "+("desc"===p?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 15l7-7 7 7"})})]})},t))})}),y.jsx("tbody",{children:a?y.jsx("tr",{children:y.jsx("td",{colSpan:s.length,className:"text-center p-12",children:y.jsx(_e,{text:"جاري التحميل..."})})}):b.length>0?b.map((e,t)=>y.jsx("tr",{className:"border-b border-slate-700/50 table-row-hover "+(i?"cursor-pointer":""),onClick:()=>null==i?void 0:i(e),children:s.map((t,s)=>y.jsx("td",{className:`px-3 sm:px-4 md:px-6 py-3 md:py-4 ${t.className||""}`,children:N(e,t)},s))},e.id)):y.jsx("tr",{children:y.jsx("td",{colSpan:s.length,className:"p-8",children:y.jsx(Le,{icon:y.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),title:n,description:c?"جرب تعديل كلمات البحث":""})})})})]})}),!a&&w>1&&y.jsx("div",{className:"px-3 sm:px-4 md:px-6 py-3 md:py-4 bg-slate-800/50 border-t border-slate-700/50",children:y.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[y.jsxs("div",{className:"text-xs sm:text-sm text-slate-400 order-2 sm:order-1",children:["عرض ",(m-1)*o+1," إلى"," ",Math.min(m*o,f.length)," من"," ",f.length," نتيجة"]}),y.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 order-1 sm:order-2",children:[y.jsx("button",{onClick:()=>x(Math.max(1,m-1)),disabled:1===m,className:"px-2 sm:px-3 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-white",children:y.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),y.jsx("div",{className:"flex items-center gap-0.5 sm:gap-1",children:Array.from({length:Math.min(5,w)},(e,t)=>{let s;return s=w<=5||m<=3?t+1:m>=w-2?w-4+t:m-2+t,y.jsx("button",{onClick:()=>x(s),className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg transition-all text-xs sm:text-sm "+(m===s?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg":"bg-slate-700 hover:bg-slate-600 text-slate-300"),children:s},t)})}),y.jsx("button",{onClick:()=>x(Math.min(w,m+1)),disabled:m===w,className:"px-2 sm:px-3 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-white",children:y.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]})]})})]})]})}),ze=a.memo(({children:e,variant:s="default",size:a="md",className:r=""})=>{const l=t.useMemo(()=>({default:"bg-slate-600/20 text-slate-300 border border-slate-600/50",success:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/50",warning:"bg-amber-500/20 text-amber-400 border border-amber-500/50",danger:"bg-red-500/20 text-red-400 border border-red-500/50",info:"bg-cyan-500/20 text-cyan-400 border border-cyan-500/50"}),[]),n=t.useMemo(()=>({sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-xs",lg:"px-3 py-1.5 text-sm"}),[]);return y.jsx("span",{className:`inline-flex items-center justify-center font-medium rounded-full transition-all duration-200 ${l[s]} ${n[a]} ${r}`,children:e})}),Se=({isOpen:e,onClose:a,title:r,children:l,size:n="md",footer:o})=>{if(t.useEffect(()=>{if(!e)return;const t=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=t}},[e]),t.useEffect(()=>{if(!e)return;const t=e=>{"Escape"===e.key&&a()};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,a]),!e||"undefined"==typeof document)return null;const i=y.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 sm:p-4 bg-black/70 backdrop-blur-sm animate-fade-in",onClick:a,children:y.jsxs("div",{className:`relative w-full ${{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[n]} bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl sm:rounded-2xl shadow-2xl animate-scale-in max-h-[90vh] flex flex-col`,onClick:e=>e.stopPropagation(),children:[r&&y.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-3 sm:py-4 border-b border-slate-700/50 flex-shrink-0",children:[y.jsx("h2",{className:"text-lg sm:text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-400",children:r}),y.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white transition-colors p-1 rounded-lg hover:bg-slate-700/50",children:y.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),y.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 overflow-y-auto custom-scrollbar flex-1",children:l}),o&&y.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-t border-slate-700/50 bg-slate-800/50 flex-shrink-0",children:o})]})});return s.createPortal(i,document.body)},Ae=()=>{const[e,s]=t.useState([]),a=t.useCallback(e=>{const t=Date.now();s(s=>[...s,{...e,id:t}])},[]),r=t.useCallback(e=>{s(t=>t.filter(t=>t.id!==e))},[]);return{toasts:e,showToast:a,removeToast:r,success:(e,t)=>a({message:e,type:"success",duration:t}),error:(e,t)=>a({message:e,type:"error",duration:t}),warning:(e,t)=>a({message:e,type:"warning",duration:t}),info:(e,t)=>a({message:e,type:"info",duration:t})}},Ee=({message:e,type:s="info",onClose:a,duration:r=3e3,offset:l=0})=>{t.useEffect(()=>{const e=setTimeout(a,r);return()=>clearTimeout(e)},[r,a]);const n={success:y.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),error:y.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),warning:y.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),info:y.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})},o=24+88*l;return y.jsxs("div",{className:`\n        fixed right-6 z-50\n        flex items-center gap-3 px-5 py-3 rounded-lg\n        ${{success:"bg-gradient-to-r from-emerald-500/90 to-green-500/90 border-emerald-400/50",error:"bg-gradient-to-r from-red-500/90 to-rose-500/90 border-red-400/50",warning:"bg-gradient-to-r from-amber-500/90 to-orange-500/90 border-amber-400/50",info:"bg-gradient-to-r from-cyan-500/90 to-blue-500/90 border-cyan-400/50"}[s]} backdrop-blur-md\n        border shadow-2xl\n        animate-slide-up\n        max-w-md\n      `,style:{top:`${o}px`},children:[y.jsx("div",{className:"flex-shrink-0",children:n[s]}),y.jsx("p",{className:"text-white font-medium text-sm flex-1",children:e}),y.jsx("button",{onClick:a,className:"flex-shrink-0 text-white/80 hover:text-white transition-colors",children:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})},Pe=()=>{var e,s,a,r,l,n,o,i,c,d,m,x;const[u,h]=t.useState("doctor"),[p,g]=t.useState([]),[v,j]=t.useState([]),[f,b]=t.useState(!0),[w,N]=t.useState(null),{toasts:k,showToast:C,removeToast:L}=Ae(),_=t.useCallback(async()=>{b(!0);try{const e=await D.post("/admin/get-pending-accounts",{role:u});let t=e.data||e||[];Array.isArray(t)&&(t=t.filter(e=>"doctor"===u?e.doctor&&!e.nurse:"nurse"===u&&(e.nurse&&!e.doctor))),g(t)}catch(e){C.error("فشل تحميل طلبات الموافقة"),g([])}finally{b(!1)}},[u]);t.useEffect(()=>{_()},[_]),t.useEffect(()=>{(async()=>{var e,t;try{let a,r=[];try{a=await D.get("/admin/specializations")}catch(s){a=await D.get("/specializations")}Array.isArray(a)?r=a:Array.isArray(a.data)?r=a.data:(null==(e=a.data)?void 0:e.data)&&Array.isArray(a.data.data)?r=a.data.data:(null==(t=a.data)?void 0:t.specializations)&&(r=a.data.specializations),j(r)}catch(a){}})()},[]);const M=e=>{if(!e)return"غير محدد";const t=v.find(t=>t.id===e);return(null==t?void 0:t.name_ar)||"غير محدد"},z=async e=>{try{await D.get(`/admin/approveAccount/${e}`),g(t=>t.filter(t=>t.id!==e)),C.success("تمت الموافقة على الحساب بنجاح")}catch(t){C.error(`فشلت الموافقة: ${t.message}`)}},S=async e=>{if(!window.confirm("هل أنت متأكد من رفض هذا الحساب؟"))return;try{await(async()=>{try{return void(await D.post(`/admin/rejectAccount/${e}`))}catch(t){await D.post("/admin/rejectAccount",{id:e})}})(),g(t=>t.filter(t=>t.id!==e)),C.warning("تم رفض الحساب")}catch(t){C.error(`فشل رفض الحساب: ${(null==t?void 0:t.message)||"حدث خطأ غير متوقع"}`)}},A=[{header:"الاسم الكامل",accessor:e=>{var t,s;return(null==(t=e.doctor)?void 0:t.full_name)||(null==(s=e.nurse)?void 0:s.full_name)||"غير متوفر"},sortable:!0,className:"font-medium text-white"},{header:"البريد الإلكتروني",accessor:"email"},{header:"رقم الهاتف",accessor:"phone_number"},{header:"التخصص",accessor:e=>{var t;return y.jsxs("div",{className:"text-sm",children:[e.doctor&&y.jsx(ze,{variant:"info",size:"sm",children:(null==(t=e.doctor.specialization)?void 0:t.name_ar)||M(e.doctor.specialization_id)}),e.nurse&&y.jsx(ze,{variant:"success",size:"sm",children:e.nurse.graduation_type})]})}},{header:"تاريخ الطلب",accessor:e=>new Date(e.created_at).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"}),sortable:!0},{header:"الإجراءات",accessor:e=>y.jsxs("div",{className:"flex gap-2 flex-wrap",children:[y.jsx(Q,{size:"sm",variant:"primary",onClick:t=>{t.stopPropagation(),N(e)},icon:y.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),children:"عرض"}),y.jsx(Q,{size:"sm",variant:"success",onClick:t=>{t.stopPropagation(),z(e.id)},icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),children:"موافقة"}),y.jsx(Q,{size:"sm",variant:"danger",onClick:t=>{t.stopPropagation(),S(e.id)},icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),children:"رفض"})]})}];return y.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"طلبات الموافقة"}),y.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"مراجعة والموافقة على طلبات الانضمام للنظام"})]}),y.jsxs(ze,{variant:"warning",size:"lg",children:[p.length," طلب معلق"]})]}),y.jsxs("div",{className:"flex gap-1 sm:gap-2 p-1 bg-slate-800/50 rounded-lg border border-slate-700/50 w-full sm:w-fit overflow-x-auto",children:[y.jsx(Be,{title:"الأطباء",isActive:"doctor"===u,onClick:()=>h("doctor"),icon:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),y.jsx(Be,{title:"الممرضون",isActive:"nurse"===u,onClick:()=>h("nurse"),icon:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]}),y.jsx(Me,{data:p,columns:A,loading:f,searchable:!0,searchPlaceholder:"ابحث في طلبات الموافقة...",emptyMessage:`لا توجد طلبات موافقة من ${"doctor"===u?"الأطباء":"الممرضين"} حالياً`,itemsPerPage:10}),y.jsx(Se,{isOpen:!!w,onClose:()=>N(null),title:"تفاصيل "+("doctor"===u?"الطبيب":"الممرض"),size:"lg",footer:y.jsxs("div",{className:"flex gap-3 justify-end",children:[y.jsx(Q,{variant:"danger",onClick:()=>{w&&(S(w.id),N(null))},icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),children:"رفض الحساب"}),y.jsx(Q,{variant:"success",onClick:()=>{w&&(z(w.id),N(null))},icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),children:"الموافقة على الحساب"})]}),children:w&&y.jsxs("div",{className:"space-y-6",children:[y.jsx("div",{className:"bg-gradient-to-r from-cyan-500/10 to-blue-500/10 rounded-xl p-4 sm:p-6 border border-cyan-500/30",children:y.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 sm:gap-6",children:[y.jsxs("div",{className:"flex-shrink-0",children:[(null==(e=w.doctor)?void 0:e.profile_image)||(null==(s=w.nurse)?void 0:s.profile_image)?y.jsx("img",{src:(null==(a=w.doctor)?void 0:a.profile_image)||(null==(r=w.nurse)?void 0:r.profile_image),alt:(null==(l=w.doctor)?void 0:l.full_name)||(null==(n=w.nurse)?void 0:n.full_name),className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full object-cover border-4 border-cyan-400 shadow-lg shadow-cyan-500/50",onError:e=>{var t;e.currentTarget.style.display="none",null==(t=e.currentTarget.nextElementSibling)||t.classList.remove("hidden")}}):null,y.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center border-4 border-cyan-400 shadow-lg shadow-cyan-500/50 "+((null==(o=w.doctor)?void 0:o.profile_image)||(null==(i=w.nurse)?void 0:i.profile_image)?"hidden":""),children:y.jsx("svg",{className:"w-12 h-12 sm:w-16 sm:h-16 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]}),y.jsxs("div",{className:"flex-1 text-center sm:text-right space-y-2",children:[y.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white",children:(null==(c=w.doctor)?void 0:c.full_name)||(null==(d=w.nurse)?void 0:d.full_name)||"غير متوفر"}),w.doctor&&y.jsx("div",{className:"flex items-center justify-center sm:justify-start gap-2",children:y.jsx(ze,{variant:"info",size:"lg",children:y.jsxs("span",{className:"flex items-center gap-2",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(null==(m=w.doctor.specialization)?void 0:m.name_ar)||M(w.doctor.specialization_id)]})})}),w.nurse&&y.jsx("div",{className:"flex items-center justify-center sm:justify-start gap-2",children:y.jsx(ze,{variant:"success",size:"lg",children:y.jsxs("span",{className:"flex items-center gap-2",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),w.nurse.graduation_type]})})})]})]})}),y.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[y.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"المعلومات الشخصية"]}),y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[y.jsx($e,{label:"البريد الإلكتروني",value:w.email}),y.jsx($e,{label:"رقم الهاتف",value:w.phone_number}),y.jsx($e,{label:"تاريخ التسجيل",value:new Date(w.created_at).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),w.doctor&&y.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[y.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"المعلومات المهنية"]}),y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[y.jsx($e,{label:"التخصص",value:y.jsx(ze,{variant:"info",size:"md",children:(null==(x=w.doctor.specialization)?void 0:x.name_ar)||M(w.doctor.specialization_id)})}),y.jsx($e,{label:"العنوان",value:w.doctor.address}),w.doctor.age&&y.jsx($e,{label:"العمر",value:`${w.doctor.age} سنة`}),w.doctor.gender&&y.jsx($e,{label:"الجنس",value:"male"===w.doctor.gender?"ذكر":"أنثى"}),w.doctor.profile_description&&y.jsx("div",{className:"sm:col-span-2",children:y.jsx($e,{label:"الوصف الشخصي",value:w.doctor.profile_description})}),w.doctor.license_image_path&&y.jsxs("div",{className:"sm:col-span-2",children:[y.jsx("p",{className:"text-xs sm:text-sm text-slate-400 font-medium mb-2",children:"صورة الرخصة الطبية"}),y.jsxs("div",{className:"relative group",children:[y.jsx("img",{src:`https://sahtee.evra-co.com/storage/${w.doctor.license_image_path}`,alt:"رخصة طبية",className:"w-full max-w-md rounded-lg border-2 border-slate-600 hover:border-cyan-400 transition-all duration-300 cursor-pointer",onClick:()=>window.open(`https://sahtee.evra-co.com/storage/${w.doctor.license_image_path}`,"_blank")}),y.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-all duration-300 rounded-lg flex items-center justify-center",children:y.jsx("svg",{className:"w-10 h-10 text-white opacity-0 group-hover:opacity-100 transition-all duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})})})]})]})]})]}),w.nurse&&y.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[y.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"المعلومات المهنية"]}),y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[y.jsx($e,{label:"نوع التخرج",value:y.jsx(ze,{variant:"success",size:"md",children:w.nurse.graduation_type})}),y.jsx($e,{label:"العنوان",value:w.nurse.address}),w.nurse.age&&y.jsx($e,{label:"العمر",value:`${w.nurse.age} سنة`}),w.nurse.gender&&y.jsx($e,{label:"الجنس",value:"male"===w.nurse.gender?"ذكر":"أنثى"}),w.nurse.profile_description&&y.jsx("div",{className:"sm:col-span-2",children:y.jsx($e,{label:"الوصف الشخصي",value:w.nurse.profile_description})})]})]}),y.jsx("div",{className:"flex items-center justify-center",children:y.jsx(ze,{variant:"approved"===w.is_approved?"success":"rejected"===w.is_approved?"danger":"warning",size:"lg",children:"approved"===w.is_approved?"✓ تمت الموافقة":"rejected"===w.is_approved?"✗ مرفوض":"⏳ قيد الانتظار"})})]})}),k.map((e,t)=>y.jsx(Ee,{message:e.message,type:e.type,duration:e.duration,offset:t,onClose:()=>L(e.id)},e.id))]})},Be=({title:e,isActive:t,onClick:s,icon:a})=>y.jsxs("button",{onClick:s,className:"px-4 sm:px-6 py-2 sm:py-3 rounded-lg font-semibold text-xs sm:text-sm transition-all duration-200 flex items-center gap-1 sm:gap-2 whitespace-nowrap "+(t?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg shadow-cyan-500/30":"text-slate-400 hover:text-white hover:bg-slate-700/50"),children:[y.jsx("span",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",children:a}),e]}),$e=({label:e,value:t})=>y.jsxs("div",{className:"space-y-1",children:[y.jsx("p",{className:"text-xs sm:text-sm text-slate-400 font-medium",children:e}),y.jsx("p",{className:"text-sm sm:text-base text-white font-semibold",children:t||y.jsx("span",{className:"text-slate-500",children:"غير متوفر"})})]});async function We(e,t,s){if(!e.length)return[];const a=new Array(e.length);let r=0;const l=[],n=async()=>{for(;r<e.length;){const t=r++;a[t]=await s(e[t],t)}},o=Math.min(t,e.length);for(let i=0;i<o;i++)l.push(n());return await Promise.all(l),a}function Re(e){if(null==e?void 0:e.aborted)throw new DOMException("Aborted","AbortError")}const Te=()=>{const e=l(),[s,a]=t.useState(1),[r,n]=t.useState({data:[],loading:!0,totalPages:1,total:0}),[o,i]=t.useState(""),[c,d]=t.useState(""),[m,x]=t.useState({active:!1,loading:!1,data:[],total:0,error:""}),[u,h]=t.useState(0),p=t.useRef(null),g=t.useRef(null),v=t.useRef(null),j=t.useCallback(async(e,t,s)=>{const a=(e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([e,s])=>{null!=s&&""!==s&&t.append(e,String(s))}),t.toString()})({page:e,per_page:t});return(e=>{var t,s,a,r,l,n;let o=[null==e?void 0:e.doctors,null==e?void 0:e.data,e].find(e=>null!=e);o&&"object"==typeof o&&"doctors"in o&&(o=o.doctors);let i=[];Array.isArray(null==o?void 0:o.data)?i=o.data:Array.isArray(o)?i=o:Array.isArray(null==(t=null==e?void 0:e.doctors)?void 0:t.data)?i=e.doctors.data:Array.isArray(null==(s=null==e?void 0:e.data)?void 0:s.data)?i=e.data.data:Array.isArray(null==e?void 0:e.data)?i=e.data:Array.isArray(e)&&(i=e);const c=(null==o?void 0:o.current_page)??(null==e?void 0:e.current_page)??(null==(a=null==e?void 0:e.data)?void 0:a.current_page)??1,d=(null==o?void 0:o.last_page)??(null==e?void 0:e.last_page)??(null==(r=null==e?void 0:e.data)?void 0:r.last_page)??c,m=(null==o?void 0:o.total)??(null==e?void 0:e.total)??(null==(l=null==e?void 0:e.data)?void 0:l.total)??i.length,x=(null==o?void 0:o.per_page)??(null==e?void 0:e.per_page)??(null==(n=null==e?void 0:e.data)?void 0:n.per_page)??i.length;return{items:i,currentPage:Number(c)||1,lastPage:Number(d)||1,total:Number(m)||i.length,perPage:Number(x)||i.length}})(await D.get(`/admin/doctor/all?${a}`,{signal:s}))},[]),f=t.useCallback(async e=>{if(p.current)return p.current;if(g.current)return g.current;const t=(async()=>{Re(e);const t=[],{items:s,lastPage:a,total:r,perPage:l}=await j(1,200,e);t.push(...s);const n=l||200,o=r||t.length,i=n>0?Math.ceil(o/n):1,c=Math.max(a||1,i||1);if(c>1){const s=Array.from({length:c-1},(e,t)=>t+2);(await We(s,4,async t=>{Re(e);const{items:s}=await j(t,200,e);return s})).forEach(e=>{t.push(...e)})}return p.current=t,t})();g.current=t;try{const e=await t;return g.current=null,e}catch(s){throw g.current=null,(null==e?void 0:e.aborted)||(p.current=null),s}},[j,u]);t.useEffect(()=>{const e=setTimeout(()=>{d(o.trim())},350);return()=>clearTimeout(e)},[o]),t.useEffect(()=>{if(c){v.current&&v.current.abort();const e=new AbortController;return v.current=e,x({active:!0,loading:!0,data:[],total:0,error:""}),f(e.signal).then(t=>{if(e.signal.aborted)return;const s=t.filter(e=>((e,t)=>{var s,a,r,l;const n=t.trim().toLowerCase();return!n||[e.full_name,null==(s=e.account)?void 0:s.email,null==(a=e.account)?void 0:a.phone_number,null==(r=e.specialization)?void 0:r.name_ar,null==(l=e.specialization)?void 0:l.name_en,e.address].filter(e=>!!e).some(e=>e.toLowerCase().includes(n))})(e,c));x({active:!0,loading:!1,data:s,total:s.length,error:""})}).catch(()=>{e.signal.aborted||x({active:!0,loading:!1,data:[],total:0,error:"تعذر تحميل البيانات. يرجى المحاولة مرة أخرى."})}).finally(()=>{v.current===e&&(v.current=null)}),()=>e.abort()}v.current&&(v.current.abort(),v.current=null),x({active:!1,loading:!1,data:[],total:0,error:""})},[c,f,u]),t.useEffect(()=>{if(c||p.current||g.current)return;const e=new AbortController,t=window.setTimeout(()=>{f(e.signal).catch(()=>{e.abort()})},800);return()=>{e.abort(),window.clearTimeout(t)}},[c,f]),t.useEffect(()=>{if(c)return;const e=new AbortController;return n(e=>({...e,loading:!0})),j(s,25,e.signal).then(({items:t,lastPage:s,total:a})=>{e.signal.aborted||n({data:t,loading:!1,totalPages:s,total:a})}).catch(()=>{e.signal.aborted||n(e=>({...e,loading:!1}))}),()=>e.abort()},[c,s,j]);const b=e=>{m.active||e>=1&&e<=r.totalPages&&(a(e),window.scrollTo({top:0,behavior:"smooth"}))},w=[{header:"الاسم الكامل",accessor:"full_name",sortable:!0,className:"font-medium text-white"},{header:"التخصص",accessor:e=>{var t;return(null==(t=e.specialization)?void 0:t.name_ar)||"-"},sortable:!0},{header:"البريد الإلكتروني",accessor:e=>{var t;return(null==(t=e.account)?void 0:t.email)||"-"}},{header:"رقم الهاتف",accessor:e=>{var t;return(null==(t=e.account)?void 0:t.phone_number)||"-"}},{header:"الجنس",accessor:e=>y.jsx(ze,{variant:"info",size:"sm",children:"male"===e.gender?"ذكر":"أنثى"})},{header:"الإجراءات",accessor:t=>y.jsx(Q,{size:"sm",variant:"primary",onClick:s=>{s.stopPropagation(),e(`/doctors/${t.id}`)},children:"عرض التفاصيل"})}],N=m.active?m.total:r.total,k=m.active?m.data:r.data,C=m.active?m.loading:r.loading,L=m.active?m.loading?"جاري البحث في الأطباء...":m.error||"لم يتم العثور على نتائج مطابقة.":"لا يوجد أطباء مسجلين",_=m.active?Math.max(k.length,1):25;return y.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة الأطباء"}),y.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع الأطباء المسجلين في النظام"})]}),y.jsx("div",{className:"flex items-center gap-2",children:y.jsx(ze,{variant:"info",size:"lg",children:C?"...":`${N} طبيب`})})]}),y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[y.jsx(X,{value:o,onChange:e=>i(e.target.value),placeholder:"ابحث في جميع الأطباء بالاسم، التخصص، البريد، الهاتف...",icon:y.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),c&&y.jsxs("div",{className:"mt-2 text-sm text-slate-400 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[m.loading?y.jsxs("span",{className:"flex items-center gap-2",children:[y.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري تحميل جميع الأطباء لضمان دقة النتائج..."]}):y.jsx("span",{children:m.total>0?`تم العثور على ${m.total} طبيب مطابق`:"لم يتم العثور على نتائج مطابقة"}),m.error&&y.jsx("span",{className:"text-red-400",children:m.error})]})]}),y.jsx(Me,{data:k,columns:w,loading:C,searchable:!1,emptyMessage:L,itemsPerPage:_,onRowClick:t=>e(`/doctors/${t.id}`)},m.active?"search-results":`page-${s}`),!m.active&&r.totalPages>1&&y.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[y.jsxs("div",{className:"text-sm text-slate-400",children:["الصفحة ",s," من ",r.totalPages," (",r.total," طبيب إجمالاً)"]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>b(1),disabled:1===s||r.loading,children:"الأولى"}),y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>b(s-1),disabled:1===s||r.loading,icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"السابقة"}),y.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,r.totalPages)},(e,t)=>{let a;return a=r.totalPages<=5||s<=3?t+1:s>=r.totalPages-2?r.totalPages-4+t:s-2+t,y.jsx(Q,{variant:s===a?"primary":"secondary",size:"sm",onClick:()=>b(a),disabled:r.loading,className:"min-w-[40px]",children:a},a)})}),y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>b(s+1),disabled:s===r.totalPages||r.loading,icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),children:"التالية"}),y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>b(r.totalPages),disabled:s===r.totalPages||r.loading,children:"الأخيرة"})]})]})]})},Ve=()=>{var e,s,a;const{id:r}=o(),n=l(),[i,c]=t.useState(null),[d,m]=t.useState([]),[x,u]=t.useState(!0),[h,p]=t.useState(!0),[g,v]=t.useState(""),[j,f]=t.useState(""),[b,w]=t.useState(""),[N,k]=t.useState({pending:0,approved:0,rejected:0,cancelled:0,completed:0,total:0});t.useEffect(()=>{C()},[r]),t.useEffect(()=>{r&&L()},[r,g,j,b]);const C=async()=>{u(!0);try{const e=await D.get(`/admin/doctor/${r}`);c(e.doctor||e)}catch(e){}finally{u(!1)}},L=async()=>{p(!0);try{const e=new URLSearchParams;g&&e.append("status",g),j&&e.append("from",j),b&&e.append("to",b);const t=await D.get(`/admin/doctor/${r}/reservations?${e.toString()}`),s=t.data||t.reservations||t;m(Array.isArray(s)?s:[]),_(s)}catch(e){m([])}finally{p(!1)}},_=e=>{const t={pending:0,approved:0,rejected:0,cancelled:0,completed:0,total:e.length};e.forEach(e=>{e.status in t&&t[e.status]++}),k(t)};return x?y.jsx("div",{className:"flex justify-center items-center h-64",children:y.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-400"})}):i?y.jsxs("div",{className:"space-y-6",children:[y.jsx("div",{className:"flex items-center justify-between",children:y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsxs("button",{onClick:()=>n("/doctors"),className:"flex items-center gap-2 px-4 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-cyan-500 rounded-lg transition-all duration-200 group",children:[y.jsx("svg",{className:"w-5 h-5 text-cyan-400 group-hover:text-cyan-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),y.jsx("span",{className:"text-slate-300 group-hover:text-white font-medium transition-colors",children:"رجوع"})]}),y.jsxs("h1",{className:"text-3xl font-bold text-slate-100",children:["تفاصيل الطبيب - ",i.full_name]})]})}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[y.jsxs("div",{className:"lg:col-span-2 bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[y.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"المعلومات الأساسية"}),y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"الاسم الكامل"}),y.jsx("p",{className:"text-white font-medium",children:i.full_name})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"التخصص"}),y.jsx("p",{className:"text-white font-medium",children:null==(e=i.specialization)?void 0:e.name_ar})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"البريد الإلكتروني"}),y.jsx("p",{className:"text-white font-medium",children:null==(s=i.account)?void 0:s.email})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"رقم الهاتف"}),y.jsx("p",{className:"text-white font-medium",children:null==(a=i.account)?void 0:a.phone_number})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"العمر"}),y.jsxs("p",{className:"text-white font-medium",children:[i.age," سنة"]})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"الجنس"}),y.jsx("p",{className:"text-white font-medium",children:"male"===i.gender?"ذكر":"أنثى"})]}),y.jsxs("div",{className:"col-span-2",children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"العنوان"}),y.jsx("p",{className:"text-white font-medium",children:i.address})]}),i.profile_description&&y.jsxs("div",{className:"col-span-2",children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"الوصف"}),y.jsx("p",{className:"text-white font-medium",children:i.profile_description})]})]})]}),y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[y.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"إحصائيات الحجوزات"}),y.jsxs("div",{className:"space-y-3",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-slate-400",children:"الإجمالي"}),y.jsx("span",{className:"text-2xl font-bold text-white",children:N.total})]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-yellow-400",children:"قيد الانتظار"}),y.jsx("span",{className:"font-bold text-yellow-400",children:N.pending})]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-green-400",children:"موافق عليها"}),y.jsx("span",{className:"font-bold text-green-400",children:N.approved})]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-blue-400",children:"مكتملة"}),y.jsx("span",{className:"font-bold text-blue-400",children:N.completed})]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-red-400",children:"مرفوضة"}),y.jsx("span",{className:"font-bold text-red-400",children:N.rejected})]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-gray-400",children:"ملغاة"}),y.jsx("span",{className:"font-bold text-gray-400",children:N.cancelled})]})]})]})]}),i.services&&i.services.length>0&&y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[y.jsxs("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:["الخدمات المتاحة (",i.services.length,")"]}),y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.services.map(e=>y.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:[y.jsx("h3",{className:"text-white font-medium mb-2",children:e.name}),y.jsxs("div",{className:"flex justify-between items-center text-sm",children:[y.jsx("span",{className:"text-slate-400",children:"السعر:"}),y.jsxs("span",{className:"text-cyan-400 font-bold",children:[e.price," ل.س"]})]}),y.jsxs("div",{className:"flex justify-between items-center text-sm mt-1",children:[y.jsx("span",{className:"text-slate-400",children:"المدة:"}),y.jsxs("span",{className:"text-white",children:[e.duration_minutes," دقيقة"]})]})]},e.id))})]}),i.doctor_work_schedule&&i.doctor_work_schedule.length>0&&y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[y.jsxs("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:["أوقات العمل (",i.doctor_work_schedule.length," أيام)"]}),y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.doctor_work_schedule.map(e=>{return y.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:[y.jsx("h3",{className:"text-white font-medium mb-2",children:(t=e.day_of_week,{sunday:"الأحد",monday:"الاثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت"}[t]||t)}),y.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse text-sm",children:[y.jsx("span",{className:"text-cyan-400",children:e.start_time}),y.jsx("span",{className:"text-slate-400",children:"-"}),y.jsx("span",{className:"text-cyan-400",children:e.end_time})]})]},e.id);var t})})]}),y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[y.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 space-y-4 md:space-y-0",children:[y.jsx("h2",{className:"text-xl font-bold text-cyan-400",children:"الحجوزات"}),y.jsxs("div",{className:"flex flex-wrap gap-2",children:[y.jsxs("select",{value:g,onChange:e=>v(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",children:[y.jsx("option",{value:"",children:"جميع الحالات"}),y.jsx("option",{value:"pending",children:"قيد الانتظار"}),y.jsx("option",{value:"approved",children:"موافق عليها"}),y.jsx("option",{value:"completed",children:"مكتملة"}),y.jsx("option",{value:"rejected",children:"مرفوضة"}),y.jsx("option",{value:"cancelled",children:"ملغاة"})]}),y.jsx("input",{type:"date",value:j,onChange:e=>f(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",placeholder:"من تاريخ"}),y.jsx("input",{type:"date",value:b,onChange:e=>w(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",placeholder:"إلى تاريخ"}),(g||j||b)&&y.jsx("button",{onClick:()=>{v(""),f(""),w("")},className:"px-3 py-2 bg-red-600 hover:bg-red-700 rounded-md text-sm",children:"إلغاء الفلاتر"})]})]}),y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"w-full text-sm text-right text-slate-300",children:[y.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800",children:y.jsxs("tr",{children:[y.jsx("th",{scope:"col",className:"px-6 py-3",children:"#"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"المريض"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"الخدمة"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"التاريخ"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"الوقت"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"الحالة"})]})}),y.jsx("tbody",{children:h?y.jsx("tr",{children:y.jsx("td",{colSpan:6,className:"text-center p-8",children:"جاري التحميل..."})}):d.length>0?d.map(e=>{var t,s,a,r,l,n,o,i,c,d,m,x,u;const h=(null==(s=null==(t=e.user)?void 0:t.account)?void 0:s.phone_number)||(null==(a=e.user)?void 0:a.phone_number)||(null==(l=null==(r=e.user)?void 0:r.account)?void 0:l.phone)||(null==(n=e.user)?void 0:n.phone)||(null==(i=null==(o=e.user)?void 0:o.account)?void 0:i.mobile)||(null==(c=e.user)?void 0:c.mobile);return y.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-800",children:[y.jsx("td",{className:"px-6 py-4",children:e.id}),y.jsx("td",{className:"px-6 py-4",children:y.jsxs("div",{children:[y.jsx("p",{className:"font-medium",children:(null==(d=e.user)?void 0:d.full_name)||(null==(x=null==(m=e.user)?void 0:m.account)?void 0:x.full_name)||`مريض #${e.user_id}`}),y.jsxs("p",{className:"text-xs text-slate-400",children:["📞 ",h||"غير متوفر"]})]})}),y.jsx("td",{className:"px-6 py-4",children:(null==(u=e.doctor_service)?void 0:u.name)||"-"}),y.jsx("td",{className:"px-6 py-4",children:e.date}),y.jsx("td",{className:"px-6 py-4",children:y.jsxs("div",{className:"text-xs",children:[y.jsx("p",{children:e.start_time}),y.jsxs("p",{className:"text-slate-400",children:["إلى ",e.end_time]})]})}),y.jsx("td",{className:"px-6 py-4",children:(p=e.status,y.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${{pending:"bg-yellow-600",approved:"bg-green-600",rejected:"bg-red-600",cancelled:"bg-gray-600",completed:"bg-blue-600"}[p]||"bg-gray-600"}`,children:{pending:"قيد الانتظار",approved:"موافق عليها",rejected:"مرفوضة",cancelled:"ملغاة",completed:"مكتملة"}[p]||p}))})]},e.id);var p}):y.jsx("tr",{children:y.jsx("td",{colSpan:6,className:"text-center p-8",children:"لا توجد حجوزات."})})})]})})]})]}):y.jsxs("div",{className:"text-center p-8",children:[y.jsx("p",{className:"text-xl text-slate-300 mb-6",children:"لم يتم العثور على الطبيب"}),y.jsxs("button",{onClick:()=>n("/doctors"),className:"inline-flex items-center gap-2 px-6 py-3 bg-cyan-600 hover:bg-cyan-700 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-cyan-500/20",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"العودة إلى قائمة الأطباء"]})]})},Ie=()=>{var e,s,a,r,n,o;const i=l(),{toasts:c,removeToast:d,success:m,error:x,warning:u}=Ae(),[h,p]=t.useState(!1),[g,v]=t.useState(""),[j,f]=t.useState(!1),[b,w]=t.useState(!1),[N,k]=t.useState(null),[C,L]=t.useState(1),[_,M]=t.useState({data:[],loading:!0,totalPages:1,total:0}),[z,S]=t.useState(""),[A,E]=t.useState(""),[P,B]=t.useState({active:!1,loading:!1,data:[],total:0,error:""}),[$,W]=t.useState(0),R=t.useRef(null),T=t.useRef(null),V=t.useRef(null),I=t.useCallback(async(e,t,s)=>{const a=(e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([e,s])=>{null!=s&&""!==s&&t.append(e,String(s))}),t.toString()})({page:e,per_page:t});return(e=>{var t,s,a,r,l,n;let o=[null==e?void 0:e.hospitals,null==e?void 0:e.data,e].find(e=>null!=e);o&&"object"==typeof o&&"hospitals"in o&&(o=o.hospitals);let i=[];Array.isArray(null==o?void 0:o.data)?i=o.data:Array.isArray(o)?i=o:Array.isArray(null==(t=null==e?void 0:e.hospitals)?void 0:t.data)?i=e.hospitals.data:Array.isArray(null==(s=null==e?void 0:e.data)?void 0:s.data)?i=e.data.data:Array.isArray(null==e?void 0:e.data)?i=e.data:Array.isArray(e)&&(i=e);const c=(null==o?void 0:o.current_page)??(null==e?void 0:e.current_page)??(null==(a=null==e?void 0:e.data)?void 0:a.current_page)??1,d=(null==o?void 0:o.last_page)??(null==e?void 0:e.last_page)??(null==(r=null==e?void 0:e.data)?void 0:r.last_page)??c,m=(null==o?void 0:o.total)??(null==e?void 0:e.total)??(null==(l=null==e?void 0:e.data)?void 0:l.total)??i.length,x=(null==o?void 0:o.per_page)??(null==e?void 0:e.per_page)??(null==(n=null==e?void 0:e.data)?void 0:n.per_page)??i.length;return{items:i,currentPage:Number(c)||1,lastPage:Number(d)||1,total:Number(m)||i.length,perPage:Number(x)||i.length}})(await D.get(`/admin/hospital/all?${a}`,{signal:s}))},[]),H=t.useCallback(async e=>{if(R.current)return R.current;if(T.current)return T.current;const t=(async()=>{Re(e);const t=[],{items:s,lastPage:a,total:r,perPage:l}=await I(1,200,e);t.push(...s);const n=l||200,o=r||t.length,i=n>0?Math.ceil(o/n):1,c=Math.max(a||1,i||1);if(c>1){const s=Array.from({length:c-1},(e,t)=>t+2);(await We(s,4,async t=>{Re(e);const{items:s}=await I(t,200,e);return s})).forEach(e=>{t.push(...e)})}return R.current=t,t})();T.current=t;try{const e=await t;return T.current=null,e}catch(s){throw T.current=null,(null==e?void 0:e.aborted)||(R.current=null),s}},[I,$]),O=t.useCallback(()=>{R.current=null,T.current=null,W(e=>e+1)},[]);t.useEffect(()=>{const e=setTimeout(()=>{E(z.trim())},350);return()=>clearTimeout(e)},[z]),t.useEffect(()=>{if(A){V.current&&V.current.abort();const e=new AbortController;return V.current=e,B({active:!0,loading:!0,data:[],total:0,error:""}),H(e.signal).then(t=>{if(e.signal.aborted)return;const s=t.filter(e=>((e,t)=>{var s,a;const r=t.trim().toLowerCase();return!r||[e.full_name,null==(s=e.account)?void 0:s.email,null==(a=e.account)?void 0:a.phone_number,e.address].filter(e=>!!e).some(e=>e.toLowerCase().includes(r))})(e,A));B({active:!0,loading:!1,data:s,total:s.length,error:""})}).catch(()=>{e.signal.aborted||B({active:!0,loading:!1,data:[],total:0,error:"تعذر تحميل البيانات. يرجى المحاولة مرة أخرى."})}).finally(()=>{V.current===e&&(V.current=null)}),()=>e.abort()}V.current&&(V.current.abort(),V.current=null),B({active:!1,loading:!1,data:[],total:0,error:""})},[A,H,$]),t.useEffect(()=>{if(A||R.current||T.current)return;const e=new AbortController,t=window.setTimeout(()=>{H(e.signal).catch(()=>{e.abort()})},800);return()=>{e.abort(),window.clearTimeout(t)}},[A,H]),t.useEffect(()=>{if(A)return;const e=new AbortController;return M(e=>({...e,loading:!0})),I(C,25,e.signal).then(({items:t,lastPage:s,total:a})=>{e.signal.aborted||M({data:t,loading:!1,totalPages:s,total:a})}).catch(()=>{e.signal.aborted||M(e=>({...e,loading:!1}))}),()=>e.abort()},[A,C,I]);const q=e=>{P.active||e>=1&&e<=_.totalPages&&(L(e),window.scrollTo({top:0,behavior:"smooth"}))},F=async()=>{if(g.trim()){f(!0);try{const e=new FormData;e.append("hospital_name",g);const t=await D.post("/admin/create-hospital-account",e);if(!t)throw new Error("لم يتم استلام رد من الخادم");k(t),m("تم إنشاء حساب المشفى بنجاح"),v(""),p(!1),w(!0),O(),L(1)}catch(e){let t=(null==e?void 0:e.message)||"حدث خطأ غير متوقع";"Validation failed"===(null==e?void 0:e.message)||t.includes("Validation failed")?t="اسم المشفى موجود مسبقاً أو البيانات غير صحيحة":t.includes("already been taken")&&(t="اسم المشفى موجود مسبقاً، يرجى استخدام اسم آخر"),x(t)}finally{f(!1)}}else u("يرجى إدخال اسم المشفى")},U=e=>{navigator.clipboard.writeText(e).then(()=>{m("تم نسخ الرمز بنجاح")}).catch(()=>{x("فشل نسخ الرمز")})},G=[{header:"اسم المشفى",accessor:e=>e.full_name||"غير محدد",sortable:!0,className:"font-medium text-white"},{header:"البريد الإلكتروني",accessor:e=>{var t;return(null==(t=e.account)?void 0:t.email)||"-"}},{header:"رقم الهاتف",accessor:e=>{var t;return(null==(t=e.account)?void 0:t.phone_number)||"-"}},{header:"العنوان",accessor:e=>y.jsx("div",{className:"max-w-xs truncate",title:e.address||"غير محدد",children:e.address||"-"})},{header:"الإجراءات",accessor:e=>y.jsx(Q,{size:"sm",variant:"primary",onClick:t=>{t.stopPropagation(),i(`/hospitals/${e.id}`)},children:"عرض التفاصيل"})}],J=P.active?P.total:_.total,K=P.active?P.data:_.data,Y=P.active?P.loading:_.loading,Z=P.active?P.loading?"جاري البحث في المشافي...":P.error||"لم يتم العثور على نتائج مطابقة.":"لا توجد مشافي مسجلة",ee=P.active?Math.max(K.length,1):25;return y.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[y.jsxs("div",{className:"flex-1",children:[y.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة المشافي"}),y.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع المشافي المسجلة في النظام"})]}),y.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[y.jsx(ze,{variant:"info",size:"lg",children:Y?"...":`${J} مشفى`}),y.jsxs(Q,{variant:"primary",size:"md",icon:y.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),onClick:()=>p(!0),children:[y.jsx("span",{className:"hidden sm:inline",children:"إضافة مشفى"}),y.jsx("span",{className:"sm:hidden",children:"إضافة"})]})]})]}),y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[y.jsx(X,{value:z,onChange:e=>S(e.target.value),placeholder:"ابحث في جميع المشافي بالاسم، البريد، الهاتف...",icon:y.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),A&&y.jsxs("div",{className:"mt-2 text-sm text-slate-400 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[P.loading?y.jsxs("span",{className:"flex items-center gap-2",children:[y.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري تحميل جميع المشافي لضمان دقة النتائج..."]}):y.jsx("span",{children:P.total>0?`تم العثور على ${P.total} مشفى مطابق`:"لم يتم العثور على نتائج مطابقة"}),P.error&&y.jsx("span",{className:"text-red-400",children:P.error})]})]}),y.jsx(Me,{data:K,columns:G,loading:Y,searchable:!1,emptyMessage:Z,itemsPerPage:ee,onRowClick:e=>i(`/hospitals/${e.id}`)},P.active?"search-results":`page-${C}`),!P.active&&_.totalPages>1&&y.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[y.jsxs("div",{className:"text-sm text-slate-400",children:["الصفحة ",C," من ",_.totalPages," (",_.total," مشفى إجمالاً)"]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>q(1),disabled:1===C||_.loading,children:"الأولى"}),y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>q(C-1),disabled:1===C||_.loading,icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"السابقة"}),y.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,_.totalPages)},(e,t)=>{let s;return s=_.totalPages<=5||C<=3?t+1:C>=_.totalPages-2?_.totalPages-4+t:C-2+t,y.jsx(Q,{variant:C===s?"primary":"secondary",size:"sm",onClick:()=>q(s),disabled:_.loading,className:"min-w-[40px]",children:s},s)})}),y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>q(C+1),disabled:C===_.totalPages||_.loading,icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),children:"التالية"}),y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>q(_.totalPages),disabled:C===_.totalPages||_.loading,children:"الأخيرة"})]})]}),y.jsx(Se,{isOpen:h,onClose:()=>{p(!1),v("")},title:"إنشاء حساب مشفى جديد",footer:y.jsxs("div",{className:"flex gap-3 justify-end",children:[y.jsx(Q,{variant:"secondary",onClick:()=>p(!1),children:"إلغاء"}),y.jsx(Q,{variant:"primary",onClick:F,isLoading:j,children:"إنشاء المشفى"})]}),children:y.jsx(X,{label:"اسم المشفى",value:g,onChange:e=>v(e.target.value),onKeyPress:e=>{"Enter"!==e.key||j||F()},placeholder:"أدخل اسم المشفى",disabled:j,icon:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})})}),y.jsx(Se,{isOpen:b,onClose:()=>{w(!1),k(null)},title:"✅ تم إنشاء حساب المشفى بنجاح",footer:y.jsx("div",{className:"flex gap-3 justify-end",children:y.jsx(Q,{variant:"primary",onClick:()=>{w(!1),k(null)},children:"تم"})}),children:y.jsxs("div",{className:"space-y-4",children:[y.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:y.jsx("p",{className:"text-slate-300 text-center mb-2",children:"تم إنشاء حساب المشفى بنجاح. يمكن للمشفى تسجيل الدخول باستخدام الرمز الفريد التالي:"})}),N&&y.jsxs(y.Fragment,{children:[((null==(e=N.hospital)?void 0:e.full_name)||N.full_name)&&y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"اسم المشفى"}),y.jsx("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3",children:y.jsx("p",{className:"text-white font-medium text-center",children:(null==(s=N.hospital)?void 0:s.full_name)||N.full_name})})]}),((null==(a=N.account)?void 0:a.email)||N.email)&&y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"البريد الإلكتروني"}),y.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3 flex items-center justify-between",children:[y.jsx("p",{className:"text-white font-mono",children:(null==(r=N.account)?void 0:r.email)||N.email}),y.jsx("button",{onClick:()=>{var e;return U((null==(e=N.account)?void 0:e.email)||N.email)},className:"px-3 py-1 bg-cyan-600 hover:bg-cyan-700 rounded-md text-sm transition-colors",children:"نسخ"})]})]}),(N.unique_code||N.code||N.password)&&y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"الرمز الفريد / كلمة المرور"}),y.jsxs("div",{className:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 border-2 border-cyan-500/50 rounded-lg p-4 flex items-center justify-between",children:[y.jsx("p",{className:"text-white font-mono text-lg font-bold",children:N.unique_code||N.code||N.password}),y.jsxs("button",{onClick:()=>U(N.unique_code||N.code||N.password),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-md font-medium transition-colors flex items-center gap-2",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"نسخ"]})]})]}),((null==(n=N.account)?void 0:n.phone_number)||N.phone_number)&&y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"رقم الهاتف"}),y.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3 flex items-center justify-between",children:[y.jsx("p",{className:"text-white font-mono",children:(null==(o=N.account)?void 0:o.phone_number)||N.phone_number}),y.jsx("button",{onClick:()=>{var e;return U((null==(e=N.account)?void 0:e.phone_number)||N.phone_number)},className:"px-3 py-1 bg-cyan-600 hover:bg-cyan-700 rounded-md text-sm transition-colors",children:"نسخ"})]})]}),y.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mt-4",children:y.jsxs("div",{className:"flex items-start gap-3",children:[y.jsx("svg",{className:"w-6 h-6 text-yellow-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),y.jsxs("p",{className:"text-yellow-200 text-sm",children:[y.jsx("strong",{children:"تنبيه مهم:"})," يرجى حفظ الرمز الفريد وإرساله للمشفى. لن تتمكن من رؤيته مرة أخرى!"]})]})})]}),N&&!N.unique_code&&!N.code&&!N.password&&y.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4 mt-4",children:[y.jsx("p",{className:"text-slate-400 text-sm mb-2",children:"معلومات المشفى المُنشأ:"}),y.jsx("pre",{className:"text-xs text-slate-300 overflow-auto max-h-60",children:JSON.stringify(N,null,2)})]})]})}),c.map((e,t)=>y.jsx(Ee,{message:e.message,type:e.type,duration:e.duration,offset:t,onClose:()=>d(e.id)},e.id))]})},He=()=>{var e,s;const{id:a}=o(),r=l(),[n,i]=t.useState(null),[c,d]=t.useState([]),[m,x]=t.useState(!0),[u,h]=t.useState(!0),[p,g]=t.useState(""),[v,j]=t.useState(""),[f,b]=t.useState(""),[w,N]=t.useState({pending:0,confirmed:0,cancelled:0,total:0});t.useEffect(()=>{k()},[a]),t.useEffect(()=>{a&&C()},[a,p,v,f]);const k=async()=>{x(!0);try{const e=await D.get(`/admin/hospital/${a}`);i(e.hospital||e)}catch(e){}finally{x(!1)}},C=async()=>{h(!0);try{const e=new URLSearchParams;p&&e.append("status",p),v&&e.append("from",v),f&&e.append("to",f);const t=await D.get(`/admin/hospital/${a}/reservations?${e.toString()}`),s=t.data||t.reservations||t;d(Array.isArray(s)?s:[]),L(s)}catch(e){d([])}finally{h(!1)}},L=e=>{const t={pending:0,confirmed:0,cancelled:0,total:e.length};e.forEach(e=>{e.status in t&&t[e.status]++}),N(t)};return m?y.jsx("div",{className:"flex justify-center items-center h-64",children:y.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-400"})}):n?y.jsxs("div",{className:"space-y-6",children:[y.jsx("div",{className:"flex items-center justify-between",children:y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsxs("button",{onClick:()=>r("/hospitals"),className:"flex items-center gap-2 px-4 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-cyan-500 rounded-lg transition-all duration-200 group",children:[y.jsx("svg",{className:"w-5 h-5 text-cyan-400 group-hover:text-cyan-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),y.jsx("span",{className:"text-slate-300 group-hover:text-white font-medium transition-colors",children:"رجوع"})]}),y.jsxs("h1",{className:"text-3xl font-bold text-slate-100",children:["تفاصيل المشفى - ",n.full_name]})]})}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[y.jsxs("div",{className:"lg:col-span-2 bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[y.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"المعلومات الأساسية"}),y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"اسم المشفى"}),y.jsx("p",{className:"text-white font-medium",children:n.full_name||"غير محدد"})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"البريد الإلكتروني"}),y.jsx("p",{className:"text-white font-medium",children:(null==(e=n.account)?void 0:e.email)||"غير محدد"})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"رقم الهاتف"}),y.jsx("p",{className:"text-white font-medium",children:(null==(s=n.account)?void 0:s.phone_number)||"غير محدد"})]}),y.jsxs("div",{className:"col-span-2",children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"العنوان"}),y.jsx("p",{className:"text-white font-medium",children:n.address||"غير محدد"})]})]})]}),y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[y.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"إحصائيات الحجوزات"}),y.jsxs("div",{className:"space-y-3",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-slate-400",children:"الإجمالي"}),y.jsx("span",{className:"text-2xl font-bold text-white",children:w.total})]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-yellow-400",children:"قيد الانتظار"}),y.jsx("span",{className:"font-bold text-yellow-400",children:w.pending})]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-green-400",children:"مؤكدة"}),y.jsx("span",{className:"font-bold text-green-400",children:w.confirmed})]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-gray-400",children:"ملغاة"}),y.jsx("span",{className:"font-bold text-gray-400",children:w.cancelled})]})]})]})]}),n.services_2&&n.services_2.length>0&&y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[y.jsxs("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:["الخدمات المتاحة (",n.services_2.length,")"]}),y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.services_2.map(e=>y.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:[y.jsx("h3",{className:"text-white font-medium mb-2",children:e.service_name}),y.jsxs("div",{className:"flex justify-between items-center text-sm",children:[y.jsx("span",{className:"text-slate-400",children:"السعر:"}),y.jsxs("span",{className:"text-cyan-400 font-bold",children:[e.pivot.price," ل.س"]})]}),y.jsxs("div",{className:"flex justify-between items-center text-sm mt-1",children:[y.jsx("span",{className:"text-slate-400",children:"السعة:"}),y.jsxs("span",{className:"text-white",children:[e.pivot.capacity," شخص"]})]})]},e.id))})]}),n.work_schedule&&n.work_schedule.length>0&&y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[y.jsxs("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:["أيام العمل (",n.work_schedule.length," أيام)"]}),y.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.work_schedule.map(e=>{return y.jsx("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3 text-center",children:y.jsx("p",{className:"text-white font-medium",children:(t=e.day_of_week,{sunday:"الأحد",monday:"الاثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت"}[t]||t)})},e.id);var t})})]}),y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[y.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 space-y-4 md:space-y-0",children:[y.jsx("h2",{className:"text-xl font-bold text-cyan-400",children:"الحجوزات"}),y.jsxs("div",{className:"flex flex-wrap gap-2",children:[y.jsxs("select",{value:p,onChange:e=>g(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",children:[y.jsx("option",{value:"",children:"جميع الحالات"}),y.jsx("option",{value:"pending",children:"قيد الانتظار"}),y.jsx("option",{value:"confirmed",children:"مؤكدة"}),y.jsx("option",{value:"cancelled",children:"ملغاة"})]}),y.jsx("input",{type:"date",value:v,onChange:e=>j(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",placeholder:"من تاريخ"}),y.jsx("input",{type:"date",value:f,onChange:e=>b(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",placeholder:"إلى تاريخ"}),(p||v||f)&&y.jsx("button",{onClick:()=>{g(""),j(""),b("")},className:"px-3 py-2 bg-red-600 hover:bg-red-700 rounded-md text-sm",children:"إلغاء الفلاتر"})]})]}),y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"w-full text-sm text-right text-slate-300",children:[y.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800",children:y.jsxs("tr",{children:[y.jsx("th",{scope:"col",className:"px-6 py-3",children:"#"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"المريض"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"الخدمة"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"من تاريخ"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"إلى تاريخ"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"السعر"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"الحالة"})]})}),y.jsx("tbody",{children:u?y.jsx("tr",{children:y.jsx("td",{colSpan:7,className:"text-center p-8",children:"جاري التحميل..."})}):c.length>0?c.map(e=>{var t,s,a,r,l,n,o,i,c,d,m,x,u,h;return y.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-800",children:[y.jsx("td",{className:"px-6 py-4",children:e.id}),y.jsx("td",{className:"px-6 py-4",children:y.jsxs("div",{children:[y.jsx("p",{className:"font-medium",children:(null==(t=e.user)?void 0:t.full_name)||`مريض #${e.user_id}`}),y.jsxs("p",{className:"text-xs text-slate-400",children:["📞 ",(null==(a=null==(s=e.user)?void 0:s.account)?void 0:a.phone_number)||(null==(r=e.user)?void 0:r.phone_number)||(null==(n=null==(l=e.user)?void 0:l.account)?void 0:n.phone)||(null==(o=e.user)?void 0:o.phone)||(null==(c=null==(i=e.user)?void 0:i.account)?void 0:c.mobile)||(null==(d=e.user)?void 0:d.mobile)||"غير متوفر"]})]})}),y.jsx("td",{className:"px-6 py-4",children:(null==(x=null==(m=e.hospital_service)?void 0:m.service)?void 0:x.service_name)||"-"}),y.jsx("td",{className:"px-6 py-4",children:e.start_date}),y.jsx("td",{className:"px-6 py-4",children:e.end_date}),y.jsx("td",{className:"px-6 py-4",children:y.jsxs("span",{className:"text-cyan-400 font-bold",children:[(null==(u=e.hospital_service)?void 0:u.price)||"-"," ل.س"]})}),y.jsx("td",{className:"px-6 py-4",children:(h=e.status,y.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${{pending:"bg-yellow-600",confirmed:"bg-green-600",cancelled:"bg-gray-600"}[h]||"bg-gray-600"}`,children:{pending:"قيد الانتظار",confirmed:"مؤكدة",cancelled:"ملغاة"}[h]||h}))})]},e.id)}):y.jsx("tr",{children:y.jsx("td",{colSpan:7,className:"text-center p-8",children:"لا توجد حجوزات."})})})]})})]})]}):y.jsxs("div",{className:"text-center p-8",children:[y.jsx("p",{className:"text-xl text-slate-300 mb-6",children:"لم يتم العثور على المشفى"}),y.jsxs("button",{onClick:()=>r("/hospitals"),className:"inline-flex items-center gap-2 px-6 py-3 bg-cyan-600 hover:bg-cyan-700 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-cyan-500/20",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"العودة إلى قائمة المشافي"]})]})},De=()=>{var e,s;const[a,r]=t.useState(null),[l,n]=t.useState(1),[o,i]=t.useState({data:[],loading:!0,totalPages:1,total:0}),[c,d]=t.useState(""),[m,x]=t.useState(""),[u,h]=t.useState({active:!1,loading:!1,data:[],total:0,error:""}),[p,g]=t.useState({current:0,total:0}),v=t.useRef(null),j=t.useRef(null),f=t.useRef(null),b=t.useCallback(async(e,t,s)=>{const a=(e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([e,s])=>{null!=s&&""!==s&&t.append(e,String(s))}),t.toString()})({page:e,per_page:t});return(e=>{var t,s,a,r,l,n;let o=[null==e?void 0:e.users,null==e?void 0:e.data,e].find(e=>null!=e);o&&"object"==typeof o&&"users"in o&&(o=o.users);let i=[];Array.isArray(null==o?void 0:o.data)?i=o.data:Array.isArray(o)?i=o:Array.isArray(null==(t=null==e?void 0:e.users)?void 0:t.data)?i=e.users.data:Array.isArray(null==(s=null==e?void 0:e.data)?void 0:s.data)?i=e.data.data:Array.isArray(null==e?void 0:e.data)?i=e.data:Array.isArray(e)&&(i=e);const c=(null==o?void 0:o.current_page)??(null==e?void 0:e.current_page)??(null==(a=null==e?void 0:e.data)?void 0:a.current_page)??1,d=(null==o?void 0:o.last_page)??(null==e?void 0:e.last_page)??(null==(r=null==e?void 0:e.data)?void 0:r.last_page)??c,m=(null==o?void 0:o.total)??(null==e?void 0:e.total)??(null==(l=null==e?void 0:e.data)?void 0:l.total)??i.length,x=(null==o?void 0:o.per_page)??(null==e?void 0:e.per_page)??(null==(n=null==e?void 0:e.data)?void 0:n.per_page)??i.length;return{items:i,currentPage:Number(c)||1,lastPage:Number(d)||1,total:Number(m)||i.length,perPage:Number(x)||i.length}})(await D.get(`/admin/user/all?${a}`,{signal:s}))},[]),w=t.useCallback(async e=>{const t=null==e?void 0:e.signal,s=null==e?void 0:e.onProgress;if(v.current)return null==s||s(v.current.length?1:0,1),v.current;if(j.current)return j.current;const a=(async()=>{Re(t);const e=[],{items:a,lastPage:r,total:l,perPage:n}=await b(1,200,t);e.push(...a);const o=n||200,i=l||e.length,c=o>0?Math.ceil(i/o):1,d=Math.max(r||1,c||1);if(null==s||s(Math.min(1,d),d),d>1){const a=Array.from({length:d-1},(e,t)=>t+2);let r=1;(await We(a,4,async e=>{Re(t);const{items:a}=await b(e,200,t);return r+=1,null==s||s(Math.min(r,d),d),a})).forEach(t=>{e.push(...t)})}return v.current=e,e})();j.current=a;try{const e=await a;return j.current=null,e}catch(r){throw j.current=null,(null==t?void 0:t.aborted)||(v.current=null),r}},[b]);t.useEffect(()=>{const e=setTimeout(()=>{x(c.trim())},350);return()=>clearTimeout(e)},[c]),t.useEffect(()=>{if(m){f.current&&f.current.abort();const e=new AbortController;f.current=e,h({active:!0,loading:!0,data:[],total:0,error:""}),g({current:0,total:0});const t=(t,s)=>{e.signal.aborted||g({current:t,total:s})};return w({signal:e.signal,onProgress:t}).then(t=>{if(e.signal.aborted)return;const s=t.filter(e=>((e,t)=>{var s,a;const r=t.trim().toLowerCase();return!r||[e.full_name,null==(s=e.account)?void 0:s.email,null==(a=e.account)?void 0:a.phone_number,e.age?String(e.age):void 0].filter(e=>!!e).some(e=>e.toLowerCase().includes(r))})(e,m));h({active:!0,loading:!1,data:s,total:s.length,error:""})}).catch(()=>{e.signal.aborted||h({active:!0,loading:!1,data:[],total:0,error:"تعذر تحميل البيانات. يرجى المحاولة مرة أخرى."})}).finally(()=>{f.current===e&&(f.current=null)}),()=>e.abort()}f.current&&(f.current.abort(),f.current=null),h({active:!1,loading:!1,data:[],total:0,error:""}),g({current:0,total:0})},[m,w]),t.useEffect(()=>{if(m)return;const e=new AbortController;return i(e=>({...e,loading:!0})),b(l,100,e.signal).then(({items:t,lastPage:s,total:a})=>{e.signal.aborted||i({data:t,loading:!1,totalPages:s,total:a})}).catch(()=>{e.signal.aborted||i(e=>({...e,loading:!1}))}),()=>e.abort()},[m,l,b]),t.useEffect(()=>{if(m||v.current||j.current)return;const e=new AbortController,t=window.setTimeout(()=>{w({signal:e.signal}).catch(()=>{e.abort()})},800);return()=>{e.abort(),window.clearTimeout(t)}},[m,w]);const N=e=>{u.active||e>=1&&e<=o.totalPages&&(n(e),window.scrollTo({top:0,behavior:"smooth"}))},k=u.active?u.total:o.total,C=u.active?u.data:o.data,L=u.active?u.loading:o.loading,_=u.active?u.loading?"جاري البحث في المستخدمين...":u.error||"لم يتم العثور على نتائج مطابقة.":"لا يوجد مستخدمون مسجلون",M=u.active?Math.max(C.length,1):100,z=[{header:"الاسم الكامل",accessor:"full_name",sortable:!0,className:"font-medium text-white"},{header:"البريد الإلكتروني",accessor:e=>{var t;return(null==(t=e.account)?void 0:t.email)||"-"}},{header:"رقم الهاتف",accessor:e=>{var t;return(null==(t=e.account)?void 0:t.phone_number)||"-"}},{header:"العمر",accessor:"age",sortable:!0},{header:"الجنس",accessor:e=>y.jsx(ze,{variant:"male"===e.gender?"info":"success",size:"sm",children:"male"===e.gender?"ذكر":"female"===e.gender?"أنثى":"-"})},{header:"الإجراءات",accessor:e=>y.jsx(Q,{size:"sm",variant:"primary",onClick:t=>{t.stopPropagation(),r(e)},children:"عرض التفاصيل"})}];return y.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة المستخدمين"}),y.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع المستخدمين المسجلين في النظام"})]}),y.jsx("div",{className:"flex items-center gap-2",children:y.jsx(ze,{variant:"info",size:"lg",children:L?"...":`${k} مستخدم`})})]}),y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[y.jsx(X,{value:c,onChange:e=>d(e.target.value),placeholder:"ابحث في جميع المستخدمين بالاسم، البريد، الهاتف، العمر...",icon:y.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),m&&y.jsxs("div",{className:"mt-2 text-sm text-slate-400",children:[u.loading?y.jsxs("div",{className:"space-y-2",children:[y.jsxs("span",{className:"flex items-center gap-2",children:[y.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري البحث في جميع الصفحات..."]}),p.total>0&&y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"flex-1 bg-slate-700 rounded-full h-2 overflow-hidden",children:y.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 h-full transition-all duration-300",style:{width:p.current/p.total*100+"%"}})}),y.jsxs("span",{className:"text-xs text-slate-500 min-w-[80px] text-right",children:[p.current," / ",p.total]})]})]}):y.jsxs("span",{className:"flex items-center gap-2",children:[y.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),u.total>0?`تم العثور على ${u.total} نتيجة مطابقة`:"لم يتم العثور على نتائج مطابقة"]}),u.error&&y.jsx("span",{className:"mt-1 text-sm text-red-400 block",children:u.error})]})]}),y.jsx(Me,{data:C,columns:z,loading:L,searchable:!1,emptyMessage:_,itemsPerPage:M,onRowClick:r},u.active?"search-results":`page-${l}`),!u.active&&o.totalPages>1&&y.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[y.jsxs("div",{className:"text-sm text-slate-400",children:["الصفحة ",l," من ",o.totalPages," (",o.total," مستخدم إجمالاً)"]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>N(1),disabled:1===l||o.loading,children:"الأولى"}),y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>N(l-1),disabled:1===l||o.loading,icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"السابقة"}),y.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,o.totalPages)},(e,t)=>{let s;return s=o.totalPages<=5||l<=3?t+1:l>=o.totalPages-2?o.totalPages-4+t:l-2+t,y.jsx(Q,{variant:l===s?"primary":"secondary",size:"sm",onClick:()=>N(s),disabled:o.loading,className:"min-w-[40px]",children:s},s)})}),y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>N(l+1),disabled:l===o.totalPages||o.loading,icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),children:"التالية"}),y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>N(o.totalPages),disabled:l===o.totalPages||o.loading,children:"الأخيرة"})]})]}),y.jsx(Se,{isOpen:!!a,onClose:()=>r(null),title:"تفاصيل المستخدم",footer:y.jsx(Q,{variant:"secondary",onClick:()=>r(null),children:"إغلاق"}),children:a&&y.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[y.jsxs("div",{className:"space-y-1",children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"الاسم الكامل"}),y.jsx("p",{className:"text-white font-medium text-lg",children:a.full_name||"-"})]}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"العمر"}),y.jsxs("p",{className:"text-white font-medium text-lg",children:[a.age||"-"," سنة"]})]}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"الجنس"}),y.jsx(ze,{variant:"male"===a.gender?"info":"success",children:"male"===a.gender?"ذكر":"أنثى"})]}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"معرف المستخدم"}),y.jsxs("p",{className:"text-white font-medium text-lg",children:["#",a.id]})]}),y.jsxs("div",{className:"space-y-1 col-span-2",children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"البريد الإلكتروني"}),y.jsx("p",{className:"text-white font-medium text-lg",children:(null==(e=a.account)?void 0:e.email)||"-"})]}),y.jsxs("div",{className:"space-y-1 col-span-2",children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"رقم الهاتف"}),y.jsx("p",{className:"text-white font-medium text-lg direction-ltr text-right",children:(null==(s=a.account)?void 0:s.phone_number)||"-"})]})]})})]})},Oe=()=>{const e=l(),[s,a]=t.useState(1),[r,n]=t.useState({data:[],loading:!0,totalPages:1,total:0}),[o,i]=t.useState(""),[c,d]=t.useState(""),[m,x]=t.useState({active:!1,loading:!1,data:[],total:0,error:""}),[u,h]=t.useState({current:0,total:0}),p=t.useRef(null),g=t.useRef(null),v=t.useRef(null),j=t.useCallback(async(e,t,s)=>{const a=(e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([e,s])=>{null!=s&&""!==s&&t.append(e,String(s))}),t.toString()})({page:e,per_page:t});return(e=>{var t,s,a,r,l,n;let o=[null==e?void 0:e.nurses,null==e?void 0:e.data,e].find(e=>null!=e);o&&"object"==typeof o&&"nurses"in o&&(o=o.nurses);let i=[];Array.isArray(null==o?void 0:o.data)?i=o.data:Array.isArray(o)?i=o:Array.isArray(null==(t=null==e?void 0:e.nurses)?void 0:t.data)?i=e.nurses.data:Array.isArray(null==(s=null==e?void 0:e.data)?void 0:s.data)?i=e.data.data:Array.isArray(null==e?void 0:e.data)?i=e.data:Array.isArray(e)&&(i=e);const c=(null==o?void 0:o.current_page)??(null==e?void 0:e.current_page)??(null==(a=null==e?void 0:e.data)?void 0:a.current_page)??1,d=(null==o?void 0:o.last_page)??(null==e?void 0:e.last_page)??(null==(r=null==e?void 0:e.data)?void 0:r.last_page)??c,m=(null==o?void 0:o.total)??(null==e?void 0:e.total)??(null==(l=null==e?void 0:e.data)?void 0:l.total)??i.length,x=(null==o?void 0:o.per_page)??(null==e?void 0:e.per_page)??(null==(n=null==e?void 0:e.data)?void 0:n.per_page)??i.length;return{items:i,currentPage:Number(c)||1,lastPage:Number(d)||1,total:Number(m)||i.length,perPage:Number(x)||i.length}})(await D.get(`/admin/nurse/all?${a}`,{signal:s}))},[]),f=t.useCallback(async e=>{const t=null==e?void 0:e.signal,s=null==e?void 0:e.onProgress;if(p.current)return null==s||s(p.current.length?1:0,1),p.current;if(g.current)return g.current;const a=(async()=>{Re(t);const e=[],{items:a,lastPage:r,total:l,perPage:n}=await j(1,200,t);e.push(...a);const o=n||200,i=l||e.length,c=o>0?Math.ceil(i/o):1,d=Math.max(r||1,c||1);if(null==s||s(Math.min(1,d),d),d>1){const a=Array.from({length:d-1},(e,t)=>t+2);let r=1;(await We(a,4,async e=>{Re(t);const{items:a}=await j(e,200,t);return r+=1,null==s||s(Math.min(r,d),d),a})).forEach(t=>{e.push(...t)})}return p.current=e,e})();g.current=a;try{const e=await a;return g.current=null,e}catch(r){throw g.current=null,(null==t?void 0:t.aborted)||(p.current=null),r}},[j]);t.useEffect(()=>{const e=setTimeout(()=>{d(o.trim())},350);return()=>clearTimeout(e)},[o]),t.useEffect(()=>{if(c){v.current&&v.current.abort();const e=new AbortController;v.current=e,x({active:!0,loading:!0,data:[],total:0,error:""}),h({current:0,total:0});const t=(t,s)=>{e.signal.aborted||h({current:t,total:s})};return f({signal:e.signal,onProgress:t}).then(t=>{if(e.signal.aborted)return;const s=t.filter(e=>((e,t)=>{var s,a;const r=t.trim().toLowerCase();return!r||[e.full_name,null==(s=e.account)?void 0:s.email,null==(a=e.account)?void 0:a.phone_number,e.graduation_type].filter(e=>!!e).some(e=>e.toLowerCase().includes(r))})(e,c));x({active:!0,loading:!1,data:s,total:s.length,error:""})}).catch(()=>{e.signal.aborted||x({active:!0,loading:!1,data:[],total:0,error:"تعذر تحميل البيانات. يرجى المحاولة مرة أخرى."})}).finally(()=>{v.current===e&&(v.current=null)}),()=>e.abort()}v.current&&(v.current.abort(),v.current=null),x({active:!1,loading:!1,data:[],total:0,error:""}),h({current:0,total:0})},[c,f]),t.useEffect(()=>{if(c)return;const e=new AbortController;return n(e=>({...e,loading:!0})),j(s,100,e.signal).then(({items:t,lastPage:s,total:a})=>{e.signal.aborted||n({data:t,loading:!1,totalPages:s,total:a})}).catch(()=>{e.signal.aborted||n(e=>({...e,loading:!1}))}),()=>e.abort()},[c,s,j]),t.useEffect(()=>{if(c||p.current||g.current)return;const e=new AbortController,t=window.setTimeout(()=>{f({signal:e.signal}).catch(()=>{e.abort()})},800);return()=>{e.abort(),window.clearTimeout(t)}},[c,f]);const b=e=>{m.active||e>=1&&e<=r.totalPages&&(a(e),window.scrollTo({top:0,behavior:"smooth"}))},w=m.active?m.total:r.total,N=m.active?m.data:r.data,k=m.active?m.loading:r.loading,C=m.active?m.loading?"جاري البحث في الممرضين...":m.error||"لم يتم العثور على نتائج مطابقة.":"لا يوجد ممرضون لعرضهم";return y.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة الممرضين"}),y.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع الممرضين المسجلين في النظام"})]}),y.jsx("div",{className:"flex items-center gap-2",children:y.jsx(ze,{variant:"info",size:"lg",children:k?"...":`${w} ممرض/ة`})})]}),y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[y.jsx(X,{value:o,onChange:e=>i(e.target.value),placeholder:"ابحث في جميع الممرضين بالاسم، البريد، الهاتف، المؤهل...",icon:y.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),c&&y.jsxs("div",{className:"mt-2 text-sm text-slate-400",children:[m.loading?y.jsxs("div",{className:"space-y-2",children:[y.jsxs("span",{className:"flex items-center gap-2",children:[y.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري البحث في جميع الصفحات..."]}),u.total>0&&y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"flex-1 bg-slate-700 rounded-full h-2 overflow-hidden",children:y.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 h-full transition-all duration-300",style:{width:u.current/u.total*100+"%"}})}),y.jsxs("span",{className:"text-xs text-slate-500 min-w-[80px] text-right",children:[u.current," / ",u.total]})]})]}):y.jsxs("span",{className:"flex items-center gap-2",children:[y.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),m.total>0?`تم العثور على ${m.total} نتيجة مطابقة`:"لم يتم العثور على نتائج مطابقة"]}),m.error&&y.jsx("span",{className:"mt-1 text-sm text-red-400 block",children:m.error})]})]}),y.jsx("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl shadow-lg overflow-hidden",children:y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"w-full text-sm text-right text-slate-300",children:[y.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800",children:y.jsxs("tr",{children:[y.jsx("th",{scope:"col",className:"px-6 py-3",children:"الاسم الكامل"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"البريد الإلكتروني"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"رقم الهاتف"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"المؤهل"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"الحالة"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"الإجراءات"})]})}),y.jsx("tbody",{children:k?y.jsx("tr",{children:y.jsx("td",{colSpan:6,className:"text-center p-8",children:"جاري التحميل..."})}):N.length>0?N.map(t=>{var s,a;return y.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-800",children:[y.jsx("td",{className:"px-6 py-4 font-medium",children:t.full_name}),y.jsx("td",{className:"px-6 py-4",children:(null==(s=t.account)?void 0:s.email)||"-"}),y.jsx("td",{className:"px-6 py-4",children:(null==(a=t.account)?void 0:a.phone_number)||"-"}),y.jsx("td",{className:"px-6 py-4",children:t.graduation_type||"-"}),y.jsx("td",{className:"px-6 py-4",children:y.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+(t.is_active?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"),children:t.is_active?"نشط":"غير نشط"})}),y.jsx("td",{className:"px-6 py-4",children:y.jsx("button",{onClick:()=>e(`/nurses/${t.id}`),className:"px-3 py-1 text-xs bg-blue-600 hover:bg-blue-700 rounded-md transition-colors",children:"عرض التفاصيل"})})]},t.id)}):y.jsx("tr",{children:y.jsx("td",{colSpan:6,className:"text-center p-8",children:C})})})]})})}),!m.active&&r.totalPages>1&&y.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[y.jsxs("div",{className:"text-sm text-slate-400",children:["الصفحة ",s," من ",r.totalPages," (",r.total," ممرض/ة إجمالاً)"]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>b(1),disabled:1===s||r.loading,children:"الأولى"}),y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>b(s-1),disabled:1===s||r.loading,icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"السابقة"}),y.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,r.totalPages)},(e,t)=>{let a;return a=r.totalPages<=5||s<=3?t+1:s>=r.totalPages-2?r.totalPages-4+t:s-2+t,y.jsx(Q,{variant:s===a?"primary":"secondary",size:"sm",onClick:()=>b(a),disabled:r.loading,className:"min-w-[40px]",children:a},a)})}),y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>b(s+1),disabled:s===r.totalPages||r.loading,icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),children:"التالية"}),y.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>b(r.totalPages),disabled:s===r.totalPages||r.loading,children:"الأخيرة"})]})]})]})},qe=()=>{var e,s;const{id:a}=o(),r=l(),[n,i]=t.useState(null),[c,d]=t.useState(!0);t.useEffect(()=>{m()},[a]);const m=async()=>{d(!0);try{const e=await D.get(`/admin/nurse/${a}`);i(e.nurse||e)}catch(e){}finally{d(!1)}};return c?y.jsx("div",{className:"flex justify-center items-center h-64",children:y.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-400"})}):n?y.jsxs("div",{className:"space-y-6",children:[y.jsx("div",{className:"flex items-center justify-between",children:y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsxs("button",{onClick:()=>r("/nurses"),className:"flex items-center gap-2 px-4 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-cyan-500 rounded-lg transition-all duration-200 group",children:[y.jsx("svg",{className:"w-5 h-5 text-cyan-400 group-hover:text-cyan-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),y.jsx("span",{className:"text-slate-300 group-hover:text-white font-medium transition-colors",children:"رجوع"})]}),y.jsxs("h1",{className:"text-3xl font-bold text-slate-100",children:["تفاصيل الممرض - ",n.full_name]})]})}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[y.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"المعلومات الأساسية"}),y.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"الاسم الكامل"}),y.jsx("p",{className:"text-white font-medium",children:n.full_name})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"البريد الإلكتروني"}),y.jsx("p",{className:"text-white font-medium",children:null==(e=n.account)?void 0:e.email})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"رقم الهاتف"}),y.jsx("p",{className:"text-white font-medium",children:null==(s=n.account)?void 0:s.phone_number})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"العمر"}),y.jsxs("p",{className:"text-white font-medium",children:[n.age," سنة"]})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"الجنس"}),y.jsx("p",{className:"text-white font-medium",children:"male"===n.gender?"ذكر":"أنثى"})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"نوع التخرج"}),y.jsx("p",{className:"text-white font-medium",children:n.graduation_type})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"الحالة"}),y.jsx("p",{className:"text-white font-medium",children:y.jsx("span",{className:"inline-block px-3 py-1 text-xs rounded-full "+(n.is_active?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"),children:n.is_active?"نشط":"غير نشط"})})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"العنوان"}),y.jsx("p",{className:"text-white font-medium",children:n.address})]}),n.profile_description&&y.jsxs("div",{children:[y.jsx("p",{className:"text-slate-400 text-sm",children:"الوصف"}),y.jsx("p",{className:"text-white font-medium",children:n.profile_description})]})]})]}),y.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6 flex flex-col",children:[y.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"الملف الشخصي"}),y.jsx("div",{className:"flex-1 flex items-center justify-center",children:y.jsxs("div",{className:"text-center",children:[y.jsx("div",{className:"w-48 h-48 mx-auto mb-4 rounded-full bg-slate-700 flex items-center justify-center",children:y.jsx("svg",{className:"w-24 h-24 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),y.jsx("p",{className:"text-slate-400 text-sm",children:"صورة الملف الشخصي"})]})})]})]})]}):y.jsxs("div",{className:"text-center p-8",children:[y.jsx("p",{className:"text-xl text-slate-300 mb-6",children:"لم يتم العثور على الممرض"}),y.jsxs("button",{onClick:()=>r("/nurses"),className:"inline-flex items-center gap-2 px-6 py-3 bg-cyan-600 hover:bg-cyan-700 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-cyan-500/20",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"العودة إلى قائمة الممرضين"]})]})},Fe=e=>{if(!e)return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;let t=e.replace(/^\/+/,"").replace(/^storage\//,"");return t.includes("images/specializations")||(t=`images/specializations/${t}`),`https://sahtee.evra-co.com/storage/${t}`},Ue=()=>{const[e,s]=t.useState([]),[a,r]=t.useState(!0),[l,n]=t.useState(!1),[o,i]=t.useState({}),[c,d]=t.useState(!1),{toasts:m,removeToast:x,success:u,error:h}=Ae(),p=async()=>{r(!0);try{const e=await D.get("/admin/specializations");s(e||[])}catch(e){h("فشل تحميل التخصصات")}finally{r(!1)}};t.useEffect(()=>{p()},[]);const g=e=>{i(e||{name_ar:"",name_en:""}),n(!0)},v=()=>{n(!1),i({})};return y.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة التخصصات"}),y.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة تخصصات الأطباء في النظام"})]}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsxs(ze,{variant:"info",size:"lg",children:[e.length," تخصص"]}),y.jsxs(Q,{variant:"primary",onClick:()=>g(),icon:y.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),children:[y.jsx("span",{className:"hidden sm:inline",children:"إضافة تخصص"}),y.jsx("span",{className:"sm:hidden",children:"إضافة"})]})]})]}),a?y.jsx("div",{className:"flex justify-center py-20",children:y.jsx(_e,{text:"جاري تحميل التخصصات..."})}):e.length>0?y.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6",children:e.map(t=>y.jsxs(ve,{gradient:!0,hover:!0,className:"p-4 md:p-6 text-center group",children:[y.jsx("div",{className:"relative inline-block mb-4",children:Fe(t.image)?y.jsx("img",{src:Fe(t.image),alt:t.name_ar,className:"w-20 h-20 md:w-24 md:h-24 rounded-full mx-auto object-cover border-4 border-slate-700 group-hover:border-cyan-500 transition-all duration-300 group-hover:scale-110",onError:e=>{const s=e.currentTarget,a=s.src;if(t.image&&!a.includes("data:image")){if(a.includes("images/specializations"))return void(s.src=`https://sahtee.evra-co.com/storage/${t.image.replace(/^\/+/,"")}`);if(!a.includes("specializations/"))return void(s.src=`https://sahtee.evra-co.com/storage/specializations/${t.image.replace(/^\/+/,"")}`)}s.onerror=null,s.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2306b6d4"%3E%3Cpath d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/%3E%3C/svg%3E'}}):y.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-full mx-auto flex items-center justify-center bg-slate-700 border-4 border-slate-600",children:y.jsx("svg",{className:"w-10 h-10 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),y.jsx("h3",{className:"font-bold text-base md:text-lg text-white mb-1",children:t.name_ar}),y.jsx("p",{className:"text-slate-400 text-xs md:text-sm mb-4",children:t.name_en}),y.jsxs("div",{className:"flex justify-center gap-2",children:[y.jsx(Q,{size:"sm",variant:"ghost",onClick:()=>g(t),icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),children:"تعديل"}),y.jsx(Q,{size:"sm",variant:"danger",onClick:()=>(async t=>{if(window.confirm("هل أنت متأكد من رغبتك في حذف هذا التخصص؟"))try{await D.delete(`/admin/specializations/${t}`),s(e.filter(e=>e.id!==t)),u("تم حذف التخصص بنجاح")}catch(a){h(`فشل الحذف: ${a.message}`)}})(t.id),icon:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),children:"حذف"})]})]},t.id))}):y.jsx(Le,{icon:y.jsx("svg",{className:"w-16 h-16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),title:"لا توجد تخصصات",description:"ابدأ بإضافة تخصص جديد للأطباء",action:{label:"إضافة تخصص",onClick:()=>g()}}),l&&y.jsx(Ge,{spec:o,onClose:v,onSave:async e=>{var t,s;d(!0);try{let t;o.id?(t=await D.post(`/admin/specializations/${o.id}`,e),u("تم تحديث التخصص بنجاح")):(t=await D.post("/admin/specializations",e),u("تم إضافة التخصص بنجاح")),await p(),v()}catch(a){h(`فشل الحفظ: ${(null==(s=null==(t=a.response)?void 0:t.data)?void 0:s.message)||a.message||"حدث خطأ غير متوقع"}`)}finally{d(!1)}},saving:c}),m.map((e,t)=>y.jsx(Ee,{message:e.message,type:e.type,duration:e.duration,offset:t,onClose:()=>x(e.id)},e.id))]})},Ge=({spec:e,onClose:s,onSave:a,saving:r})=>{const[l,n]=t.useState(e.name_ar||""),[o,i]=t.useState(e.name_en||""),[c,d]=t.useState(null),[m,x]=t.useState(null),{showToast:u}=Ae();t.useEffect(()=>{if(e.image){const t=Fe(e.image);t&&x(t)}},[e.image]);const h=async e=>{if(e.preventDefault(),!l.trim()||!o.trim())return void u.warning("الرجاء إدخال اسم التخصص بالعربية والإنجليزية");const t=new FormData;t.append("name_ar",l.trim()),t.append("name_en",o.trim()),c&&t.append("image",c),await a(t)};return y.jsx(Se,{isOpen:!0,onClose:s,title:e.id?"تعديل التخصص":"إضافة تخصص جديد",size:"md",footer:y.jsxs("div",{className:"flex gap-3 justify-end",children:[y.jsx(Q,{variant:"secondary",onClick:s,disabled:r,children:"إلغاء"}),y.jsx(Q,{variant:"primary",onClick:h,isLoading:r,icon:!r&&y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),children:r?"جاري الحفظ...":"حفظ"})]}),children:y.jsxs("form",{onSubmit:h,className:"space-y-4",children:[m&&y.jsx("div",{className:"flex justify-center mb-4",children:y.jsx("div",{className:"relative",children:y.jsx("img",{src:m,alt:"Preview",className:"w-24 h-24 rounded-full object-cover border-4 border-cyan-500/30",onError:e=>{e.currentTarget.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2306b6d4"%3E%3Cpath d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/%3E%3C/svg%3E'}})})}),y.jsx(X,{label:"الاسم بالعربية",value:l,onChange:e=>n(e.target.value),placeholder:"مثال: جراحة عامة",required:!0,icon:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),y.jsx(X,{label:"الاسم بالإنجليزية",value:o,onChange:e=>i(e.target.value),placeholder:"Example: General Surgery",required:!0,icon:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),y.jsxs("div",{children:[y.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["صورة التخصص ",e.id&&"(اختياري للتحديث)",y.jsx("span",{className:"text-xs text-slate-400 block mt-1",children:"الصيغ المدعومة: JPG, PNG, GIF, WEBP, SVG (الحد الأقصى 5 ميجابايت)"})]}),y.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp,image/svg+xml",onChange:e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(s){const t=5242880;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/svg+xml"].includes(s.type))return u.warning("يرجى اختيار صورة صالحة (JPG, PNG, GIF, WEBP, SVG)"),void(e.target.value="");if(s.size>t)return u.warning("حجم الصورة كبير جداً. الحد الأقصى 5 ميجابايت"),void(e.target.value="");d(s);const a=new FileReader;a.onloadend=()=>{x(a.result)},a.readAsDataURL(s)}},className:"w-full px-4 py-2.5 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent hover:border-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-cyan-500 file:text-white hover:file:bg-cyan-600 cursor-pointer",required:!e.id})]})]})})},Je=()=>{const[e,s]=t.useState([]),[a,r]=t.useState(!0),[l,n]=t.useState(!1),[o,i]=t.useState({}),[c,d]=t.useState(1),{toasts:m,removeToast:x,success:u,error:h,warning:p}=Ae(),g=async()=>{r(!0);try{const e=await D.get("/admin/service"),t=e.services||e.data||e;s(Array.isArray(t)?t:[])}catch(e){}finally{r(!1)}};t.useEffect(()=>{g()},[]);const v=e=>{i(e||{}),n(!0)},j=()=>{n(!1),i({})},f=Math.ceil(e.length/10),b=10*(c-1),w=b+10,N=e.slice(b,w),k=e=>{if(!e)return"-";const t=e.includes("T")?e:e.replace(" ","T"),s=new Date(t);return Number.isNaN(s.getTime())?e:s.toLocaleDateString("ar-EG")};return y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between items-center mb-6",children:[y.jsx("h1",{className:"text-3xl font-bold text-slate-100",children:"إدارة خدمات المشافي"}),y.jsx("button",{onClick:()=>v(),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-md text-white font-semibold transition-colors",children:"إضافة خدمة"})]}),y.jsx("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl shadow-lg overflow-hidden",children:y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"w-full text-sm text-right text-slate-300",children:[y.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800",children:y.jsxs("tr",{children:[y.jsx("th",{scope:"col",className:"px-6 py-3",children:"#"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"اسم الخدمة"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"تاريخ الإنشاء"}),y.jsx("th",{scope:"col",className:"px-6 py-3",children:"الإجراءات"})]})}),y.jsx("tbody",{children:a?y.jsx("tr",{children:y.jsx("td",{colSpan:4,className:"text-center p-8",children:"جاري التحميل..."})}):e.length>0?N.map(e=>y.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-800",children:[y.jsx("td",{className:"px-6 py-4",children:e.id}),y.jsx("td",{className:"px-6 py-4 font-medium",children:e.service_name}),y.jsx("td",{className:"px-6 py-4",children:k(e.created_at??e.createdAt??e.updated_at??e.updatedAt??null)}),y.jsxs("td",{className:"px-6 py-4 flex space-x-2 space-x-reverse",children:[y.jsx("button",{onClick:()=>v(e),className:"px-3 py-1 text-xs bg-blue-600 hover:bg-blue-700 rounded-md",children:"تعديل"}),y.jsx("button",{onClick:()=>(async e=>{if(window.confirm("هل أنت متأكد من رغبتك في حذف هذه الخدمة؟"))try{await D.delete(`/admin/service/${e}`),u("تم حذف الخدمة بنجاح"),g()}catch(t){h(`فشل الحذف: ${(null==t?void 0:t.message)||"خطأ غير معروف"}`)}})(e.id),className:"px-3 py-1 text-xs bg-red-600 hover:bg-red-700 rounded-md",children:"حذف"})]})]},e.id)):y.jsx("tr",{children:y.jsx("td",{colSpan:4,className:"text-center p-8",children:"لا توجد خدمات لعرضها."})})})]})})}),!a&&e.length>0&&f>1&&y.jsxs("div",{className:"mt-6",children:[y.jsxs("div",{className:"text-center text-slate-400 text-sm mb-4",children:["عرض ",b+1," - ",Math.min(w,e.length)," من إجمالي ",e.length," خدمة"]}),y.jsxs("div",{className:"flex justify-center items-center gap-2",children:[y.jsx("button",{onClick:()=>{c<f&&d(c+1)},disabled:c===f,className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(c===f?"bg-slate-700/50 text-slate-500 cursor-not-allowed":"bg-slate-700 text-slate-200 hover:bg-slate-600 hover:shadow-lg"),children:"التالي ←"}),y.jsx("div",{className:"flex gap-1.5",children:(()=>{const e=[];if(f<=7)for(let t=1;t<=f;t++)e.push(t);else{e.push(1),c>3&&e.push("...");const t=Math.max(2,c-1),s=Math.min(f-1,c+1);for(let a=t;a<=s;a++)e.push(a);c<f-2&&e.push("..."),e.push(f)}return e})().map((e,t)=>"number"==typeof e?y.jsx("button",{onClick:()=>(e=>{d(e)})(e),className:"min-w-[40px] px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(c===e?"bg-cyan-600 text-white shadow-lg shadow-cyan-600/30 scale-105":"bg-slate-700 text-slate-200 hover:bg-slate-600 hover:shadow-md"),children:e},`page-${e}`):y.jsx("span",{className:"px-2 py-2 text-slate-500 text-sm flex items-center",children:e},`dots-${t}`))}),y.jsx("button",{onClick:()=>{c>1&&d(c-1)},disabled:1===c,className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(1===c?"bg-slate-700/50 text-slate-500 cursor-not-allowed":"bg-slate-700 text-slate-200 hover:bg-slate-600 hover:shadow-lg"),children:"→ السابق"})]})]}),l&&y.jsx(Ke,{service:o,onClose:j,onSave:async e=>{if(e.trim())try{if(o.id)await D.put(`/admin/service/${o.id}`,{service_name:e}),u("تم تحديث الخدمة بنجاح");else{const t=new FormData;t.append("service_name",e),await D.post("/admin/service",t),u("تم إضافة الخدمة بنجاح")}g(),j()}catch(t){h(`فشل الحفظ: ${(null==t?void 0:t.message)||"خطأ غير معروف"}`)}else p("يرجى إدخال اسم الخدمة.")}}),m.map((e,t)=>y.jsx(Ee,{message:e.message,type:e.type,duration:e.duration,offset:t,onClose:()=>x(e.id)},e.id))]})},Ke=({service:e,onClose:s,onSave:a})=>{const[r,l]=t.useState(e.service_name||"");return y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",onClick:s,children:y.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-xl p-6 w-full max-w-md",onClick:e=>e.stopPropagation(),children:[y.jsx("h2",{className:"text-xl font-bold mb-4",children:e.id?"تعديل الخدمة":"إضافة خدمة جديدة"}),y.jsxs("form",{onSubmit:e=>{e.preventDefault(),a(r)},children:[y.jsxs("div",{className:"mb-4",children:[y.jsx("label",{className:"block mb-2",children:"اسم الخدمة"}),y.jsx("input",{type:"text",value:r,onChange:e=>l(e.target.value),required:!0,className:"w-full p-2 bg-slate-700 rounded-md border border-slate-600"})]}),y.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse mt-6",children:[y.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-md",children:"إلغاء"}),y.jsx("button",{type:"submit",className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-md",children:"حفظ"})]})]})]})})},Ye=()=>y.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[y.jsx("h1",{className:"text-9xl font-extrabold text-cyan-400 tracking-widest",children:"404"}),y.jsx("div",{className:"bg-slate-700 px-2 text-sm rounded rotate-12 absolute",children:"الصفحة غير موجودة"}),y.jsx("p",{className:"mt-4 text-lg text-slate-300",children:"عذراً، الصفحة التي تبحث عنها غير موجودة."}),y.jsx(i,{to:"/",className:"mt-6 inline-block px-5 py-3 text-sm font-medium text-white bg-cyan-600 rounded-lg hover:bg-cyan-700 focus:outline-none focus:ring",children:"العودة إلى لوحة التحكم"})]}),Ze=()=>{const e=l();return y.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4",children:y.jsxs("div",{className:"max-w-md w-full text-center",children:[y.jsxs("div",{className:"bg-slate-800 rounded-lg p-8 shadow-xl border border-slate-700",children:[y.jsx("div",{className:"mb-6",children:y.jsx("div",{className:"mx-auto w-20 h-20 bg-red-500/10 rounded-full flex items-center justify-center",children:y.jsx("svg",{className:"w-10 h-10 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),y.jsx("h1",{className:"text-3xl font-bold text-white mb-4",children:"غير مصرح لك بالدخول"}),y.jsx("p",{className:"text-slate-300 mb-2",children:"عذراً، ليس لديك الصلاحيات الكافية للوصول إلى هذه الصفحة."}),y.jsx("p",{className:"text-slate-400 text-sm mb-8",children:"إذا كنت تعتقد أن هذا خطأ، يرجى التواصل مع المسؤول."}),y.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[y.jsx(Q,{onClick:()=>e(-1),variant:"secondary",className:"flex-1",children:"العودة للخلف"}),y.jsx(Q,{onClick:()=>e("/"),variant:"primary",className:"flex-1",children:"العودة للرئيسية"})]})]}),y.jsx("div",{className:"mt-6 text-slate-500 text-sm",children:y.jsx("p",{children:"رقم الخطأ: 403 - Forbidden"})})]})})},Xe=()=>{const{sessionTimeRemaining:e,isAuthenticated:s}=K(),[a,r]=t.useState(!1);t.useEffect(()=>{r(!!(s&&e>0&&e<=300))},[e,s]);if(!a)return null;const l=Math.floor(e/60),n=e%60;return y.jsx(Se,{isOpen:a,onClose:()=>r(!1),title:"تحذير انتهاء الجلسة",children:y.jsxs("div",{className:"space-y-4",children:[y.jsx("p",{className:"text-slate-300",children:"ستنتهي جلستك قريباً بسبب عدم النشاط."}),y.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:y.jsxs("p",{className:"text-yellow-400 text-center text-xl font-bold",children:["الوقت المتبقي: ",l,":",n.toString().padStart(2,"0")]})}),y.jsx("p",{className:"text-slate-400 text-sm",children:"هل تريد الاستمرار في العمل؟"}),y.jsx("div",{className:"flex gap-3",children:y.jsx(Q,{onClick:()=>{r(!1),document.dispatchEvent(new Event("mousedown"))},variant:"primary",className:"flex-1",children:"متابعة الجلسة"})})]})})},Qe=()=>(t.useEffect(()=>{const e=e=>{e.blockedURI,e.violatedDirective,e.originalPolicy,e.sourceFile,e.lineno,e.colno},t=e=>{(e=>{if(e){if("string"==typeof e)return C(e);if(e instanceof Error)return C(e.message);try{return C(JSON.stringify(e))}catch{return}}})(e.reason)},s=e=>{C(e.message),e.filename,e.lineno,e.colno},a=e=>{"undefined"!=typeof window&&(e.origin===window.location.origin||(e.origin,e.data))};return window.addEventListener("securitypolicyviolation",e),window.addEventListener("unhandledrejection",t),window.addEventListener("error",s),window.addEventListener("message",a,!0),()=>{window.removeEventListener("securitypolicyviolation",e),window.removeEventListener("unhandledrejection",t),window.removeEventListener("error",s),window.removeEventListener("message",a,!0)}},[]),y.jsx(J,{children:y.jsxs(Z,{children:[y.jsx(et,{}),y.jsx(Xe,{})]})})),et=()=>{const{isAuthenticated:e,loading:t}=K();return t?y.jsx("div",{className:"flex justify-center items-center h-screen bg-slate-900 text-white",children:y.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-cyan-400"})}):y.jsx(c,{children:y.jsxs(d,{children:[y.jsx(m,{path:"/login",element:e?y.jsx(x,{to:"/"}):y.jsx(ee,{})}),y.jsx(m,{path:"/unauthorized",element:y.jsx(Ze,{})}),y.jsxs(m,{path:"/",element:e?y.jsx(ge,{}):y.jsx(x,{to:"/login",replace:!0}),children:[y.jsx(m,{index:!0,element:y.jsx(be,{})}),y.jsx(m,{path:"approvals",element:y.jsx(Pe,{})}),y.jsx(m,{path:"doctors",element:y.jsx(Te,{})}),y.jsx(m,{path:"doctors/:id",element:y.jsx(Ve,{})}),y.jsx(m,{path:"nurses",element:y.jsx(Oe,{})}),y.jsx(m,{path:"nurses/:id",element:y.jsx(qe,{})}),y.jsx(m,{path:"hospitals",element:y.jsx(Ie,{})}),y.jsx(m,{path:"hospitals/:id",element:y.jsx(He,{})}),y.jsx(m,{path:"users",element:y.jsx(De,{})}),y.jsx(m,{path:"specializations",element:y.jsx(Ue,{})}),y.jsx(m,{path:"hospital-services",element:y.jsx(Je,{})}),y.jsx(m,{path:"*",element:y.jsx(Ye,{})})]}),!e&&y.jsx(m,{path:"*",element:y.jsx(x,{to:"/login",replace:!0})})]})})},tt=document.getElementById("root");if(!tt)throw new Error("Could not find root element to mount to");N.createRoot(tt).render(y.jsx(a.StrictMode,{children:y.jsx(Qe,{})}));
