var e;import{r as s,a as t,R as a,N as l,u as r,O as n,b as i,c as o,L as c,d,e as m,f as x}from"./BefVZcvG.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var u={exports:{}},h={},p=s,g=Symbol.for("react.element"),v=Symbol.for("react.fragment"),j=Object.prototype.hasOwnProperty,f=p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,b={key:!0,ref:!0,__self:!0,__source:!0};function y(e,s,t){var a,l={},r=null,n=null;for(a in void 0!==t&&(r=""+t),void 0!==s.key&&(r=""+s.key),void 0!==s.ref&&(n=s.ref),s)j.call(s,a)&&!b.hasOwnProperty(a)&&(l[a]=s[a]);if(e&&e.defaultProps)for(a in s=e.defaultProps)void 0===l[a]&&(l[a]=s[a]);return{$$typeof:g,type:e,key:r,ref:n,props:l,_owner:f.current}}h.Fragment=v,h.jsx=y,h.jsxs=y,u.exports=h;var N=u.exports,w={},k=t;w.createRoot=k.createRoot,w.hydrateRoot=k.hydrateRoot;const C=e=>e?e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"").trim():"",_=e=>{if(null==e)return e;if("string"==typeof e)return C(e);if(Array.isArray(e))return e.map(e=>_(e));if("object"==typeof e){const s={};return Object.entries(e).forEach(([e,t])=>{s[e]=_(t)}),s}return e};class L{constructor(e=100,s=6e4){this.requests=new Map,this.maxRequests=e,this.timeWindow=s}canMakeRequest(e){const s=Date.now(),t=(this.requests.get(e)||[]).filter(e=>s-e<this.timeWindow);return!(t.length>=this.maxRequests)&&(t.push(s),this.requests.set(e,t),!0)}reset(e){this.requests.delete(e)}getRemainingRequests(e){const s=Date.now(),t=(this.requests.get(e)||[]).filter(e=>s-e<this.timeWindow);return Math.max(0,this.maxRequests-t.length)}}const M=new L(100,6e4),z=new L(5,3e5),S=e=>{try{const s=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),t=decodeURIComponent(atob(s).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(t)}catch{return null}},A="sahtee_secure_",E=`${A}session_key`,P=new TextEncoder,B=new TextDecoder,$="undefined"!=typeof window&&!!(null==(e=window.crypto)?void 0:e.subtle),W=e=>{const s=new Uint8Array(e);let t="";return s.forEach(e=>{t+=String.fromCharCode(e)}),btoa(t)},R=e=>{const s=atob(e),t=new Uint8Array(s.length);for(let a=0;a<s.length;a++)t[a]=s.charCodeAt(a);return t.buffer},T=async()=>{if(!$)return null;let e=sessionStorage.getItem(E);if(!e){const s=window.crypto.getRandomValues(new Uint8Array(32));e=W(s.buffer),sessionStorage.setItem(E,e)}const s=R(e);return window.crypto.subtle.importKey("raw",s,{name:"AES-GCM"},!1,["encrypt","decrypt"])},V={async setItem(e,s){if("string"!=typeof s)throw new Error("secureStorage expects string values only");const t=await(async e=>{if(!$)return e;const s=await T();if(!s)return e;const t=window.crypto.getRandomValues(new Uint8Array(12)),a=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:t},s,P.encode(e)),l=new Uint8Array(t.byteLength+a.byteLength);return l.set(t,0),l.set(new Uint8Array(a),t.byteLength),W(l.buffer)})(s);try{localStorage.setItem(`${A}${e}`,t)}catch{try{localStorage.setItem(`${A}${e}`,s)}catch{}}},async getItem(e){let s=null;try{s=localStorage.getItem(`${A}${e}`)}catch{return null}if(!s)return null;const t=await(async e=>{if(!$)return e;const s=await T();if(!s)return e;try{const t=new Uint8Array(R(e)),a=t.slice(0,12),l=t.slice(12),r=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:a},s,l);return B.decode(r)}catch{return null}})(s);return t??null},removeItem(e){try{localStorage.removeItem(`${A}${e}`)}catch{}},clearSecureNamespace(){try{Object.keys(localStorage).filter(e=>e.startsWith(A)).forEach(e=>{try{localStorage.removeItem(e)}catch{}})}catch{}},clearSessionKey(){try{sessionStorage.removeItem(E)}catch{}}},H="https://sahtee.evra-co.com/api",I="auth_token",D={isRefreshing:!1,refreshSubscribers:[],subscribeTokenRefresh(e){this.refreshSubscribers.push(e)},onTokenRefreshed(e){this.refreshSubscribers.forEach(s=>s(e)),this.refreshSubscribers=[]},async refreshToken(){try{const e=await V.getItem(I);if(!e)return null;const s=await fetch(`${H}/admin/refresh`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error("Token refresh failed");const t=await s.json();return t.access_token?(await V.setItem(I,t.access_token),t.access_token):null}catch(e){return V.removeItem(I),window.location.hash="#/login",null}},async request(e,s={}){var t;const{skipAuth:a=!1,skipRateLimit:l=!1,retryCount:r=0,...n}=s;if(!l&&!M.canMakeRequest("api"))throw new Error("Too many requests. Please try again later.");const i=`${H}${e}`;let o=null;if(a||(o=await V.getItem(I)),!a){if(!o)throw new Error("No authentication token found");if(!(e=>{if(!e)return!1;const s=e.split(".");if(3!==s.length)return!1;try{return s.forEach(e=>atob(e.replace(/-/g,"+").replace(/_/g,"/"))),!0}catch{return!1}})(o))throw V.removeItem(I),new Error("Invalid authentication token");if((e=>{const s=S(e);return s&&s.exp?Date.now()>=1e3*s.exp:(null==s||s.exp,!1)})(o)){const e=await this.refreshToken();if(!e)throw V.removeItem(I),new Error("Authentication token expired");o=e}}const c=new Headers(n.headers||{});o&&!a&&c.set("Authorization",`Bearer ${o}`),n.body instanceof FormData||c.set("Content-Type","application/json"),c.set("Accept","application/json");const d=null==(t=document.querySelector('meta[name="csrf-token"]'))?void 0:t.getAttribute("content");d&&c.set("X-CSRF-Token",d),s.provinceId&&c.set("Province-ID",String(s.provinceId));const m=new AbortController,x=setTimeout(()=>m.abort(),3e4),u={...n,headers:c,signal:m.signal,credentials:"same-origin"};try{const t=await fetch(i,u);clearTimeout(x);const l=await t.text(),r=l?JSON.parse(l):{};if(401===t.status&&!a){if(this.isRefreshing)return new Promise(t=>{this.subscribeTokenRefresh(a=>{t(this.request(e,s))})});{this.isRefreshing=!0;const t=await this.refreshToken();if(this.isRefreshing=!1,t)return this.onTokenRefreshed(t),this.request(e,s)}}if(!t.ok){const e=r.message||r.error||t.statusText||"An unknown error occurred";403!==t.status||a?t.status>=500&&t.status:t.status;const s=new Error(e);throw s.status=t.status,s}return r}catch(p){if(clearTimeout(x),r<3&&("AbortError"===p.name||p.message.includes("network")||p.message.includes("fetch")))return await(h=1e3*(r+1),new Promise(e=>setTimeout(e,h))),this.request(e,{...s,retryCount:r+1});throw p.message,p}var h},get(e,s){return this.request(e,{...s,method:"GET",cache:"no-cache"})},post(e,s,t){if(s instanceof FormData){const a=new FormData;return s.forEach((e,s)=>{"string"==typeof e?a.append(s,C(e)):a.append(s,e)}),this.request(e,{...t,method:"POST",body:a})}const a=s?_(s):s;return this.request(e,{...t,method:"POST",body:void 0!==a?JSON.stringify(a):void 0})},put(e,s,t){const a=s?_(s):s;return this.request(e,{...t,method:"PUT",body:void 0!==a?JSON.stringify(a):void 0})},patch(e,s,t){const a=s?_(s):s;return this.request(e,{...t,method:"PATCH",body:void 0!==a?JSON.stringify(a):void 0})},delete(e,s){return this.request(e,{...s,method:"DELETE"})},async uploadFile(e,s,t){if(s.size>10485760)throw new Error("File size exceeds 10MB limit");if(!["image/jpeg","image/png","image/jpg","application/pdf"].includes(s.type))throw new Error("File type not allowed");const a=new FormData;return a.append("file",s),t&&Object.entries(t).forEach(([e,s])=>{a.append(e,C(s))}),this.post(e,a)}},F=s.createContext(void 0),O=18e5,q="auth_token",U="sahtee_last_activity",G="csrf_token",J=({children:e})=>{const[t,a]=s.useState(null),[l,r]=s.useState(!0),[n,i]=s.useState(0),o=s.useRef(Date.now()),c=s.useRef(),d=s.useRef(),m=s.useCallback(()=>{o.current=Date.now(),localStorage.setItem(U,String(Date.now()))},[]),x=s.useCallback(async()=>{await g(),window.location.hash="#/login"},[]),u=s.useCallback(()=>{const e=Number(localStorage.getItem(U))||o.current;if(!((e,s=18e5)=>Date.now()-e<s)(e,O))return x(),!1;const s=Math.floor((O-(Date.now()-e))/1e3);return i(Math.max(0,s)),!0},[x]),h=s.useCallback(async()=>{const e=await V.getItem(q);if(!e)return;const s=(e=>{const s=S(e);if(!s||!s.exp)return 0;const t=1e3*s.exp-Date.now();return Math.max(0,Math.floor(t/1e3))})(e);if(s<600&&s>0)try{await D.refreshToken()}catch(t){}},[]);s.useEffect(()=>{if(!t)return;const e=["mousedown","keydown","scroll","touchstart","click"],s=()=>{m(),u()},a=()=>{"visible"===document.visibilityState&&(u(),h())};return e.forEach(e=>{document.addEventListener(e,s)}),document.addEventListener("visibilitychange",a),d.current=setInterval(()=>{u()||clearInterval(d.current)},6e4),c.current=setInterval(()=>{h()},3e5),()=>{e.forEach(e=>{document.removeEventListener(e,s)}),document.removeEventListener("visibilitychange",a),d.current&&clearInterval(d.current),c.current&&clearInterval(c.current)}},[t,m,u,h]),s.useEffect(()=>{window.self!==window.top&&(window.top.location=window.self.location)},[]),s.useEffect(()=>{const e=e=>{e.key===`${A}${q}`&&null===e.newValue&&x()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[x]),s.useEffect(()=>{if(!localStorage.getItem(G)){const e=(()=>{const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")})();localStorage.setItem(G,e);const s=document.createElement("meta");s.name="csrf-token",s.content=e,document.head.appendChild(s)}},[]),s.useEffect(()=>{(async()=>{if(await V.getItem(q))try{const e=await D.get("/admin/me");a(e),m(),e.id}catch(e){V.removeItem(q),a(null)}r(!1)})()},[m]);const p=async(e,s)=>{if(!(e=>/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e))(e))throw new Error("صيغة البريد الإلكتروني غير صحيحة");if(!z.canMakeRequest(e))throw z.getRemainingRequests(e),new Error("محاولات تسجيل دخول كثيرة. يرجى المحاولة بعد 5 دقائق.");const t=new FormData;t.append("email",e),t.append("password",s);try{const s=await D.post("/admin/login",t,{skipAuth:!0,skipRateLimit:!0});if(!s.access_token)throw new Error("فشل تسجيل الدخول، لم يتم استلام التوكن");await V.setItem(q,s.access_token),m();const r=await V.getItem(q);if(!r||r!==s.access_token)throw new Error("فشل في حفظ التوكن");try{const s=await D.get("/admin/me",{skipRateLimit:!0});if(!s||!s.id)throw new Error("بيانات المستخدم غير صحيحة");a(s),z.reset(e),s.id,s.email}catch(l){throw V.removeItem(q),new Error("فشل في الحصول على بيانات المستخدم: "+(l.message||"خطأ غير معروف"))}}catch(r){throw r.message.includes("محاولات")||r.message.includes("صيغة")||r.message.includes("استلام")||r.message,r}},g=async()=>{try{await V.getItem(q)&&await D.post("/admin/logout").catch(()=>{}),null==t||t.id}catch(e){await V.getItem(q)}finally{a(null),V.removeItem(q),V.clearSecureNamespace(),V.clearSessionKey(),localStorage.removeItem(U),d.current&&clearInterval(d.current),c.current&&clearInterval(c.current)}},v=s.useMemo(()=>({isAuthenticated:!!t,admin:t,login:p,logout:g,loading:l,sessionTimeRemaining:n}),[t,l,n]);return N.jsx(F.Provider,{value:v,children:e})},K=()=>{const e=s.useContext(F);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},Y=s.createContext(void 0),Z=({children:e})=>{const{isAuthenticated:t}=K(),[a,l]=s.useState([]),[r,n]=s.useState(!1),i=s.useCallback(async()=>{var e,s;if(!t)return l([]),void n(!1);try{n(!0);const e=await D.get("/admin/notifications");l(e.data||[])}catch(a){if(404===(null==a?void 0:a.status)||(null==(e=null==a?void 0:a.message)?void 0:e.includes("404"))||(null==(s=null==a?void 0:a.message)?void 0:s.includes("Not Found")))return void l([]);l([])}finally{n(!1)}},[t]),o=a.filter(e=>!e.read).length;return s.useEffect(()=>{if(!t)return l([]),void n(!1);i();const e=setInterval(()=>{i()},3e4);return()=>clearInterval(e)},[i,t]),N.jsx(Y.Provider,{value:{notifications:a,unreadCount:o,loading:r,fetchNotifications:i,markAsRead:async e=>{try{await D.put(`/admin/notifications/${e}/read`),l(s=>s.map(s=>s.id===e?{...s,read:!0}:s))}catch(s){}},markAllAsRead:async()=>{try{await D.put("/admin/notifications/read-all"),l(e=>e.map(e=>({...e,read:!0})))}catch(e){}},deleteNotification:async e=>{try{await D.delete(`/admin/notifications/${e}`),l(s=>s.filter(s=>s.id!==e))}catch(s){}}},children:e})},X=({label:e,error:s,icon:t,helperText:l,className:r="",id:n,...i})=>{const o=a.useId(),c=n??o;return N.jsxs("div",{className:"w-full",children:[e&&N.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-slate-300 mb-2",children:e}),N.jsxs("div",{className:"relative",children:[t&&N.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:t}),N.jsx("input",{id:c,className:`\n            w-full px-4 py-2.5 \n            ${t?"pr-10":""} \n            bg-slate-700/50 backdrop-blur-sm \n            border ${s?"border-red-500":"border-slate-600"} \n            rounded-lg text-white placeholder-slate-400 \n            transition-all duration-200\n            focus:outline-none focus:ring-2 \n            ${s?"focus:ring-red-500":"focus:ring-cyan-500"} \n            focus:border-transparent\n            hover:border-slate-500\n            ${r}\n          `,...i})]}),s&&N.jsxs("p",{className:"mt-1.5 text-xs text-red-400 flex items-center gap-1",children:[N.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),s]}),l&&!s&&N.jsx("p",{className:"mt-1.5 text-xs text-slate-400",children:l})]})},Q=a.memo(({variant:e="primary",size:t="md",isLoading:a=!1,icon:l,children:r,className:n="",disabled:i,...o})=>{const c=s.useMemo(()=>({primary:"bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white shadow-lg shadow-cyan-500/50 focus:ring-cyan-500",secondary:"bg-slate-700 hover:bg-slate-600 text-white shadow-lg shadow-slate-700/50 focus:ring-slate-500",success:"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600 text-white shadow-lg shadow-emerald-500/50 focus:ring-emerald-500",danger:"bg-gradient-to-r from-red-500 to-rose-500 hover:from-red-600 hover:to-rose-600 text-white shadow-lg shadow-red-500/50 focus:ring-red-500",warning:"bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white shadow-lg shadow-amber-500/50 focus:ring-amber-500",ghost:"bg-transparent hover:bg-slate-800/50 text-slate-300 hover:text-white border border-slate-700 hover:border-slate-600 focus:ring-slate-500"}),[]),d=s.useMemo(()=>({sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}),[]);return N.jsxs("button",{className:`inline-flex items-center justify-center gap-2 font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 disabled:opacity-50 disabled:cursor-not-allowed transform active:scale-95 ${c[e]} ${d[t]} ${n}`,disabled:i||a,...o,children:[a&&N.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!a&&l&&N.jsx("span",{children:l}),N.jsx("span",{children:r})]})}),ee=()=>{const[e,t]=s.useState(""),[a,l]=s.useState(""),[r,n]=s.useState(""),[i,o]=s.useState(!1),{login:c}=K();return N.jsxs("div",{className:"relative flex items-center justify-center min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 overflow-hidden p-3 sm:p-4",dir:"rtl",children:[N.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[N.jsx("div",{className:"absolute -top-20 sm:-top-40 -right-20 sm:-right-40 w-40 h-40 sm:w-80 sm:h-80 bg-cyan-500/30 rounded-full blur-3xl animate-pulse"}),N.jsx("div",{className:"absolute -bottom-20 sm:-bottom-40 -left-20 sm:-left-40 w-40 h-40 sm:w-80 sm:h-80 bg-blue-500/30 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),N.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-60 h-60 sm:w-96 sm:h-96 bg-purple-500/20 rounded-full blur-3xl animate-pulse",style:{animationDelay:"2s"}})]}),N.jsxs("div",{className:"relative w-full max-w-md animate-scale-in",children:[N.jsxs("div",{className:"relative p-6 sm:p-8 space-y-6 sm:space-y-8 bg-gradient-to-br from-slate-800/90 to-slate-900/90 backdrop-blur-xl rounded-xl sm:rounded-2xl shadow-2xl border border-slate-700/50",children:[N.jsxs("div",{className:"text-center space-y-3 sm:space-y-4",children:[N.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl sm:rounded-2xl bg-gradient-to-br from-cyan-500 to-blue-500 shadow-2xl shadow-cyan-500/50 animate-pulse-glow",children:N.jsx("svg",{className:"w-8 h-8 sm:w-10 sm:h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),N.jsxs("div",{children:[N.jsx("h1",{className:"text-3xl sm:text-4xl font-bold gradient-text mb-1 sm:mb-2",children:"صحتي"}),N.jsx("p",{className:"text-lg sm:text-xl font-semibold text-white",children:"لوحة التحكم"}),N.jsx("p",{className:"mt-2 text-sm sm:text-base text-slate-400",children:"مرحباً بعودتك! الرجاء تسجيل الدخول للمتابعة"})]})]}),N.jsxs("form",{className:"space-y-4 sm:space-y-6",onSubmit:async s=>{s.preventDefault(),n("");const l=C(e);if(l&&a.trim()){l!==e&&t(l),o(!0);try{await c(l,a)}catch(r){n(r.message||"فشل تسجيل الدخول. الرجاء التحقق من بيانات الاعتماد.")}finally{o(!1)}}else n("الرجاء إدخال البريد الإلكتروني وكلمة المرور.")},children:[N.jsx(X,{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>t(C(e.target.value)),label:"البريد الإلكتروني",placeholder:"admin@example.com",error:r&&!e?"الرجاء إدخال البريد الإلكتروني":"",icon:N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})})}),N.jsx(X,{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:a,onChange:e=>l(e.target.value),label:"كلمة المرور",placeholder:"••••••••",error:r&&!a?"الرجاء إدخال كلمة المرور":"",icon:N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),r&&N.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-red-500/10 border border-red-500/30 animate-scale-in",children:[N.jsx("svg",{className:"w-5 h-5 text-red-400 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),N.jsx("p",{className:"text-red-400 text-sm flex-1",children:r})]}),N.jsx(Q,{type:"submit",variant:"primary",size:"lg",isLoading:i,className:"w-full",icon:!i&&N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),children:i?"جاري تسجيل الدخول...":"تسجيل الدخول"})]}),N.jsx("div",{className:"pt-4 sm:pt-6 border-t border-slate-700/50",children:N.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs sm:text-sm text-slate-400",children:[N.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),N.jsx("span",{className:"text-center",children:"جميع الحقوق محفوظة © 2025 صحتي"})]})})]}),N.jsx("div",{className:"absolute -top-3 sm:-top-4 -right-3 sm:-right-4 w-16 h-16 sm:w-24 sm:h-24 bg-gradient-to-br from-cyan-500/20 to-blue-500/20 rounded-full blur-2xl -z-10"}),N.jsx("div",{className:"absolute -bottom-3 sm:-bottom-4 -left-3 sm:-left-4 w-20 h-20 sm:w-32 sm:h-32 bg-gradient-to-br from-purple-500/20 to-pink-500/20 rounded-full blur-2xl -z-10"})]})]})},se=({to:e,icon:s,label:t,badge:a,onClick:r})=>N.jsx(l,{to:e,end:!0,onClick:r,className:({isActive:e})=>"flex items-center justify-between px-4 py-3 my-1 rounded-xl transition-all duration-200 group relative overflow-hidden\n                "+(e?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg shadow-cyan-500/30":"text-slate-300 hover:bg-slate-800/50 hover:text-white hover:translate-x-1"),children:({isActive:e})=>N.jsxs(N.Fragment,{children:[N.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[N.jsx("span",{className:"transition-transform duration-200 "+(e?"":"group-hover:scale-110"),children:s}),N.jsx("span",{className:"font-medium text-sm",children:t})]}),void 0!==a&&a>0&&N.jsx("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full animate-pulse",children:a}),!e&&N.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500/0 to-blue-500/0 group-hover:from-cyan-500/10 group-hover:to-blue-500/10 transition-all duration-300"})]})}),te=({isOpen:e,onClose:s})=>N.jsxs(N.Fragment,{children:[e&&N.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 lg:hidden animate-fade-in",onClick:s}),N.jsxs("aside",{className:`\n        fixed lg:static inset-y-0 right-0 z-50\n        w-64 bg-gradient-to-b from-slate-900 to-slate-950\n        border-l border-slate-700/50 h-full flex flex-col\n        transition-all duration-300 shadow-2xl\n        ${e?"translate-x-0":"translate-x-full lg:translate-x-0"}\n      `,children:[N.jsxs("div",{className:"flex items-center justify-between h-20 border-b border-slate-700/50 px-4",children:[N.jsxs("div",{className:"text-center flex-1",children:[N.jsx("h1",{className:"text-2xl font-bold gradient-text",children:"صحتي"}),N.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"لوحة التحكم"})]}),N.jsx("button",{onClick:s,className:"lg:hidden p-2 rounded-lg hover:bg-slate-800 transition-colors",children:N.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),N.jsxs("nav",{className:"flex-1 px-3 py-6 overflow-y-auto custom-scrollbar",children:[N.jsx(se,{to:"/",label:"لوحة التحكم",icon:N.jsx(ae,{}),onClick:s}),N.jsx(se,{to:"/approvals",label:"طلبات الموافقة",icon:N.jsx(le,{}),onClick:s}),N.jsxs("div",{className:"px-4 mt-6 mb-2 flex items-center gap-2",children:[N.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"}),N.jsx("p",{className:"text-xs uppercase text-slate-500 font-semibold",children:"الإدارة"}),N.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"})]}),N.jsx(se,{to:"/users",label:"المستخدمون",icon:N.jsx(re,{}),onClick:s}),N.jsx(se,{to:"/doctors",label:"الأطباء",icon:N.jsx(ne,{}),onClick:s}),N.jsx(se,{to:"/nurses",label:"الممرضون",icon:N.jsx(ie,{}),onClick:s}),N.jsx(se,{to:"/hospitals",label:"المشافي",icon:N.jsx(oe,{}),onClick:s}),N.jsxs("div",{className:"px-4 mt-6 mb-2 flex items-center gap-2",children:[N.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"}),N.jsx("p",{className:"text-xs uppercase text-slate-500 font-semibold",children:"الخدمات"}),N.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"})]}),N.jsx(se,{to:"/specializations",label:"التخصصات",icon:N.jsx(ce,{}),onClick:s}),N.jsx(se,{to:"/hospital-services",label:"خدمات المشافي",icon:N.jsx(de,{}),onClick:s}),N.jsx(se,{to:"/provinces",label:"المحافظات",icon:N.jsx(xe,{}),onClick:s}),N.jsxs("div",{className:"px-4 mt-6 mb-2 flex items-center gap-2",children:[N.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"}),N.jsx("p",{className:"text-xs uppercase text-slate-500 font-semibold",children:"التقارير"}),N.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"})]}),N.jsx(se,{to:"/entity-ratings",label:"تقييمات الكيانات",icon:N.jsx(me,{}),onClick:s})]}),N.jsx("div",{className:"p-4 border-t border-slate-700/50",children:N.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-br from-cyan-500/10 to-blue-500/10 border border-cyan-500/20",children:N.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[N.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center",children:N.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),N.jsxs("div",{children:[N.jsx("p",{className:"text-xs font-semibold text-cyan-400",children:"الإصدار"}),N.jsx("p",{className:"text-xs text-slate-400",children:"v1.0.0"})]})]})})})]})]}),ae=()=>N.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),le=()=>N.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),re=()=>N.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 016-6h6a6 6 0 016 6v1h-1M15 21a3 3 0 116 0v-1a3 3 0 11-6 0v1z"})}),ne=()=>N.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547a2 2 0 00-.547 1.806l.477 2.387a6 6 0 00.517 3.86l.158.318a6 6 0 00.517 3.86l2.387.477a2 2 0 001.806-.547a2 2 0 00.547-1.806l-.477-2.387a6 6 0 00-.517-3.86l-.158-.318a6 6 0 00-.517-3.86l-2.387-.477zM12 12a3 3 0 100-6 3 3 0 000 6z"})}),ie=()=>N.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),oe=()=>N.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),ce=()=>N.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16v4m-2-2h4m5 10v4m-2-2h4M5 11h14M5 11a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v3a2 2 0 01-2 2M5 11a2 2 0 00-2 2v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 00-2-2"})}),de=()=>N.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),me=()=>N.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.966a1 1 0 00.95.69h4.178c.969 0 1.371 1.24.588 1.81l-3.382 2.46a1 1 0 00-.364 1.118l1.287 3.966c.3.922-.755 1.688-1.54 1.118l-3.382-2.46a1 1 0 00-1.176 0l-3.382 2.46c-.784.57-1.838-.196-1.539-1.118l1.287-3.966a1 1 0 00-.364-1.118L2.997 9.393c-.783-.57-.38-1.81.588-1.81h4.178a1 1 0 00.95-.69l1.286-3.966z"})}),xe=()=>N.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),ue=e=>e.toLocaleLowerCase("ar-SY"),he=e=>e.map(e=>null==e?"":String(e).toLocaleLowerCase("ar-SY")).filter(Boolean).join(" "),pe={hospital:{endpoint:"/admin/hospital/all",key:"hospitals",perPage:100},doctor:{endpoint:"/admin/doctor/all",key:"doctors",perPage:100},nurse:{endpoint:"/admin/nurse/all",key:"nurses",perPage:100},user:{endpoint:"/admin/user/all",key:"users",perPage:100}},ge=()=>{const[e,t]=s.useState(""),[a,l]=s.useState([]),[n,i]=s.useState(!1),[o,c]=s.useState(!1),d=s.useRef(null),m=r(),x=s.useRef(0),u=s.useRef(!1),h=s.useRef({hospital:{data:null,promise:null,lastFetchedAt:null,normalized:null},doctor:{data:null,promise:null,lastFetchedAt:null,normalized:null},nurse:{data:null,promise:null,lastFetchedAt:null,normalized:null},user:{data:null,promise:null,lastFetchedAt:null,normalized:null}}),p=s.useCallback((e,s,t)=>{var a;let l=[],r=t;return(null==(a=null==e?void 0:e[s])?void 0:a.data)&&Array.isArray(e[s].data)?(l=e[s].data,r=e[s].last_page??r):(null==e?void 0:e[s])&&Array.isArray(e[s])?l=e[s]:(null==e?void 0:e.data)&&Array.isArray(e.data)?l=e.data:Array.isArray(e)&&(l=e),(!Number.isFinite(r)||r<1)&&(r=t),{data:l,lastPage:r}},[]),g=s.useCallback(async e=>{const s=pe[e],t=[],a=await D.get(`${s.endpoint}?page=1&per_page=${s.perPage}`).catch(()=>null);if(!a)return t;const{data:l,lastPage:r}=p(a,s.key,1);t.push(...l);const n=Math.min(Math.max(r,1),3);if(n>1){const e=[];for(let t=2;t<=n;t++)e.push(D.get(`${s.endpoint}?page=${t}&per_page=${s.perPage}`).catch(()=>null));(await Promise.all(e)).forEach(e=>{if(!e)return;const{data:a}=p(e,s.key,1);t.push(...a)})}return t},[p]),v=s.useCallback(async e=>{const s=h.current[e];return s.data?s.data:(s.promise||(s.promise=g(e).then(e=>(s.data=e,s.lastFetchedAt=Date.now(),s.normalized=null,e)).catch(e=>{throw s.data=null,s.lastFetchedAt=null,s.normalized=null,e}).finally(()=>{s.promise=null})),s.promise)},[g]);s.useEffect(()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),s.useEffect(()=>{const s=setTimeout(()=>{e.trim().length>=2?f(e.trim()):l([])},300);return()=>clearTimeout(s)},[e]);const j=s.useCallback(async()=>{if(u.current)return;u.current=!0;const e=["hospital","doctor","nurse","user"];for(const s of e)try{await v(s)}catch{}},[v]),f=async e=>{const s=++x.current;i(!0);try{const[t,a,r,n]=await Promise.all([b(e),y(e),w(e),k(e)]),i=[...t,...a,...r,...n];x.current===s&&(l(i),c(!0))}catch(t){x.current===s&&(l([]),c(!1))}finally{x.current===s&&i(!1)}},b=async e=>{var s,t;try{const a=h.current.hospital,l=await v("hospital");a.normalized&&a.normalized.length===l.length||(a.normalized=l.map(e=>{var s,t;return he([null==e?void 0:e.full_name,null==(s=null==e?void 0:e.account)?void 0:s.email,null==e?void 0:e.address,null==(t=null==e?void 0:e.account)?void 0:t.phone_number])}));const r=ue(e.trim()),n=[];for(let e=0;e<l.length&&!(n.length>=5);e++){if(!(null==(s=a.normalized)?void 0:s[e]))continue;if(!a.normalized[e].includes(r))continue;const i=l[e];(null==i?void 0:i.id)&&n.push({id:i.id,type:"hospital",name:i.full_name||"غير محدد",subtitle:(null==(t=i.account)?void 0:t.email)||i.address||"",data:i})}return n}catch(a){return[]}},y=async e=>{var s,t,a;try{const l=h.current.doctor,r=await v("doctor");l.normalized&&l.normalized.length===r.length||(l.normalized=r.map(e=>{var s,t,a,l;return he([null==e?void 0:e.full_name,null==(s=null==e?void 0:e.account)?void 0:s.email,null==(t=null==e?void 0:e.account)?void 0:t.phone_number,null==(a=null==e?void 0:e.specialization)?void 0:a.name_ar,null==(l=null==e?void 0:e.specialization)?void 0:l.name_en])}));const n=ue(e.trim()),i=[];for(let e=0;e<r.length&&!(i.length>=5);e++){if(!(null==(s=l.normalized)?void 0:s[e]))continue;if(!l.normalized[e].includes(n))continue;const o=r[e];(null==o?void 0:o.id)&&i.push({id:o.id,type:"doctor",name:o.full_name,subtitle:(null==(t=o.specialization)?void 0:t.name_ar)||(null==(a=o.account)?void 0:a.email),data:o})}return i}catch(l){return[]}},w=async e=>{var s,t;try{const a=h.current.nurse,l=await v("nurse");a.normalized&&a.normalized.length===l.length||(a.normalized=l.map(e=>{var s,t;return he([null==e?void 0:e.full_name,null==(s=null==e?void 0:e.account)?void 0:s.email,null==(t=null==e?void 0:e.account)?void 0:t.phone_number,null==e?void 0:e.graduation_type,null==e?void 0:e.address])}));const r=ue(e.trim()),n=[];for(let e=0;e<l.length&&!(n.length>=5);e++){if(!(null==(s=a.normalized)?void 0:s[e]))continue;if(!a.normalized[e].includes(r))continue;const i=l[e];(null==i?void 0:i.id)&&n.push({id:i.id,type:"nurse",name:i.full_name,subtitle:i.graduation_type||(null==(t=i.account)?void 0:t.email),data:i})}return n}catch(a){return[]}},k=async e=>{var s,t;try{const a=h.current.user,l=await v("user");a.normalized&&a.normalized.length===l.length||(a.normalized=l.map(e=>{var s,t,a;return he([null==e?void 0:e.full_name,null==(s=null==e?void 0:e.account)?void 0:s.email,null==(t=null==e?void 0:e.account)?void 0:t.phone_number,null==(a=null==e?void 0:e.account)?void 0:a.username,null==e?void 0:e.address])}));const r=ue(e.trim()),n=[];for(let e=0;e<l.length&&!(n.length>=5);e++){if(!(null==(s=a.normalized)?void 0:s[e]))continue;if(!a.normalized[e].includes(r))continue;const i=l[e];(null==i?void 0:i.id)&&n.push({id:i.id,type:"user",name:i.full_name,subtitle:null==(t=i.account)?void 0:t.email,data:i})}return n}catch(a){return[]}},C=e=>{switch(e){case"hospital":return"مشفى";case"doctor":return"طبيب";case"nurse":return"ممرض/ة";case"user":return"مستخدم"}},_=e=>{switch(e){case"hospital":return N.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"doctor":return N.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})});case"nurse":return N.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})});case"user":return N.jsx("svg",{className:"w-5 h-5 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}},L=e=>{switch(e){case"hospital":return"bg-blue-500/10 text-blue-400 border-blue-500/30";case"doctor":return"bg-green-500/10 text-green-400 border-green-500/30";case"nurse":return"bg-purple-500/10 text-purple-400 border-purple-500/30";case"user":return"bg-cyan-500/10 text-cyan-400 border-cyan-500/30"}};return N.jsxs("div",{ref:d,className:"relative w-full max-w-2xl",children:[N.jsxs("div",{className:"relative",children:[N.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:n?N.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),N.jsx("input",{type:"text",value:e,onChange:e=>t(e.target.value),onFocus:()=>e.trim().length>=2&&a.length>0&&c(!0),onClick:()=>{e.trim().length>=2&&a.length>0&&c(!0)},onFocusCapture:()=>{j()},onClickCapture:()=>{j()},placeholder:"ابحث... (2 أحرف على الأقل)",className:"w-full pr-10 pl-4 py-2.5 bg-slate-700/50 backdrop-blur-sm border border-slate-600 rounded-lg text-white placeholder-slate-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent hover:border-slate-500"}),e&&N.jsx("button",{onClick:()=>{t(""),l([]),c(!1),x.current+=1},className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white transition-colors",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),o&&a.length>0&&N.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl max-h-96 overflow-y-auto custom-scrollbar z-50 animate-scale-in",children:N.jsxs("div",{className:"p-2",children:[N.jsxs("div",{className:"text-xs text-slate-400 px-3 py-2 font-medium",children:["تم العثور على ",a.length," نتيجة"]}),a.map((e,s)=>N.jsx("button",{onClick:()=>(e=>{switch(t(""),c(!1),l([]),e.type){case"hospital":m(`/hospitals/${e.id}`);break;case"doctor":m(`/doctors/${e.id}`);break;case"nurse":m(`/nurses/${e.id}`);break;case"user":m(`/users/${e.id}`,{state:{user:e.data}})}})(e),className:"w-full text-right px-3 py-3 rounded-lg hover:bg-slate-700/50 transition-colors group",children:N.jsxs("div",{className:"flex items-center gap-3",children:[N.jsx("div",{className:"flex-shrink-0",children:_(e.type)}),N.jsxs("div",{className:"flex-1 min-w-0",children:[N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("p",{className:"text-sm font-medium text-white truncate group-hover:text-cyan-400 transition-colors",children:e.name}),N.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full border ${L(e.type)} flex-shrink-0`,children:C(e.type)})]}),e.subtitle&&N.jsx("p",{className:"text-xs text-slate-400 truncate mt-0.5",children:e.subtitle})]}),N.jsx("svg",{className:"w-4 h-4 text-slate-500 group-hover:text-cyan-400 transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})]})},`${e.type}-${e.id}-${s}`))]})}),o&&e.trim().length>=2&&0===a.length&&!n&&N.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl p-6 text-center z-50 animate-scale-in",children:[N.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-full bg-slate-700/50 flex items-center justify-center",children:N.jsx("svg",{className:"w-8 h-8 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),N.jsxs("p",{className:"text-slate-400 text-sm",children:['لم يتم العثور على نتائج لـ "',e,'"']}),N.jsx("p",{className:"text-slate-500 text-xs mt-1",children:"جرب البحث بكلمات أخرى أو تحقق من الإملاء"})]}),1===e.trim().length&&N.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl p-4 text-center z-50 animate-scale-in",children:N.jsx("p",{className:"text-slate-400 text-sm",children:"اكتب حرفاً آخر للبحث..."})})]})},ve=({onMenuClick:e})=>{const{admin:t,logout:a}=K(),{notifications:l,unreadCount:r,markAsRead:n,markAllAsRead:i,deleteNotification:o}=(()=>{const e=s.useContext(Y);if(void 0===e)throw new Error("useNotifications must be used within a NotificationProvider");return e})(),[c,d]=s.useState(!1),m=s.useRef(null);s.useEffect(()=>{const e=e=>{m.current&&!m.current.contains(e.target)&&d(!1)};return c&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[c]);const x=e=>{switch(e){case"approval":return N.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"reservation":return N.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})});case"alert":return N.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});default:return N.jsx("svg",{className:"w-5 h-5 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},u=e=>{const s=new Date(e),t=(new Date).getTime()-s.getTime(),a=Math.floor(t/36e5),l=Math.floor(a/24);if(l>0)return`منذ ${l} ${1===l?"يوم":"أيام"}`;if(a>0)return`منذ ${a} ${1===a?"ساعة":"ساعات"}`;{const e=Math.floor(t/6e4);return`منذ ${e} ${1===e?"دقيقة":"دقائق"}`}};return N.jsxs("header",{className:"bg-gradient-to-r from-slate-900/95 to-slate-800/95 backdrop-blur-md shadow-lg p-3 md:p-4 flex justify-between items-center z-10 border-b border-slate-700/50 animate-slide-down",children:[N.jsx("button",{onClick:e,className:"lg:hidden p-2 rounded-lg hover:bg-slate-700/50 transition-colors",children:N.jsx("svg",{className:"w-6 h-6 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),N.jsx("div",{className:"flex-1 px-2 md:px-4 max-w-3xl hidden sm:block",children:N.jsx(ge,{})}),N.jsx("div",{className:"flex-1 sm:hidden"}),N.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[N.jsxs("div",{className:"relative",ref:m,children:[N.jsxs("button",{onClick:()=>d(!c),className:"relative p-2 rounded-lg hover:bg-slate-700/50 transition-colors group",children:[N.jsx("svg",{className:"w-6 h-6 text-slate-300 group-hover:text-cyan-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),r>0&&N.jsx("span",{className:"absolute top-0 right-0 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center animate-pulse",children:r>9?"9+":r})]}),c&&N.jsxs("div",{className:"absolute left-0 mt-2 w-96 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl animate-scale-in overflow-hidden z-50",children:[N.jsxs("div",{className:"p-4 border-b border-slate-700/50 flex items-center justify-between",children:[N.jsx("h3",{className:"font-bold text-white",children:"الإشعارات"}),l.length>0&&r>0&&N.jsx("button",{onClick:i,className:"text-xs text-cyan-400 hover:text-cyan-300 transition-colors",children:"تعليم الكل كمقروء"})]}),N.jsx("div",{className:"max-h-96 overflow-y-auto custom-scrollbar",children:0===l.length?N.jsxs("div",{className:"p-8 text-center",children:[N.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-slate-700/50 flex items-center justify-center",children:N.jsx("svg",{className:"w-8 h-8 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),N.jsx("p",{className:"text-slate-400 text-sm",children:"لا توجد إشعارات جديدة"})]}):N.jsx("div",{className:"divide-y divide-slate-700/50",children:l.map(e=>N.jsx("div",{onClick:()=>(async e=>{e.read||await n(e.id)})(e),className:"p-4 hover:bg-slate-700/30 transition-colors cursor-pointer "+(e.read?"":"bg-cyan-500/5"),children:N.jsxs("div",{className:"flex gap-3",children:[N.jsx("div",{className:"flex-shrink-0 mt-1",children:x(e.type)}),N.jsxs("div",{className:"flex-1 min-w-0",children:[N.jsxs("div",{className:"flex items-start justify-between gap-2",children:[N.jsx("p",{className:"text-sm font-semibold text-white",children:e.title}),!e.read&&N.jsx("span",{className:"w-2 h-2 bg-cyan-400 rounded-full flex-shrink-0 mt-1"})]}),N.jsx("p",{className:"text-sm text-slate-300 mt-1 line-clamp-2",children:e.message}),N.jsxs("div",{className:"flex items-center justify-between mt-2",children:[N.jsx("span",{className:"text-xs text-slate-500",children:u(e.created_at)}),N.jsx("button",{onClick:s=>{s.stopPropagation(),o(e.id)},className:"text-xs text-red-400 hover:text-red-300 transition-colors",children:"حذف"})]})]})]})},e.id))})})]})]}),N.jsxs("div",{className:"relative group",children:[N.jsxs("button",{className:"flex items-center gap-2 md:gap-3 px-2 md:px-3 py-2 rounded-lg hover:bg-slate-700/50 transition-all duration-200",children:[N.jsxs("div",{className:"text-right hidden md:block",children:[N.jsx("p",{className:"font-semibold text-white text-sm",children:null==t?void 0:t.full_name}),N.jsx("p",{className:"text-xs text-slate-400",children:null==t?void 0:t.email})]}),N.jsxs("div",{className:"relative",children:[N.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center shadow-lg",children:N.jsx("svg",{className:"w-6 h-6 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:N.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),N.jsx("span",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-400 border-2 border-slate-900 rounded-full"})]})]}),N.jsxs("div",{className:"absolute left-0 mt-2 w-56 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 overflow-hidden animate-scale-in",children:[N.jsxs("div",{className:"p-3 border-b border-slate-700/50",children:[N.jsx("p",{className:"text-sm font-medium text-white",children:null==t?void 0:t.full_name}),N.jsx("p",{className:"text-xs text-slate-400",children:null==t?void 0:t.email})]}),N.jsxs("button",{className:"w-full text-right px-4 py-3 text-sm text-slate-300 hover:bg-slate-700/50 transition-colors flex items-center gap-2",children:[N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"الملف الشخصي"]}),N.jsxs("button",{className:"w-full text-right px-4 py-3 text-sm text-slate-300 hover:bg-slate-700/50 transition-colors flex items-center gap-2",children:[N.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"الإعدادات"]}),N.jsx("div",{className:"border-t border-slate-700/50",children:N.jsxs("button",{onClick:a,className:"w-full text-right px-4 py-3 text-sm text-red-400 hover:bg-red-500/10 transition-colors flex items-center gap-2",children:[N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"تسجيل الخروج"]})})]})]})]})]})},je=()=>{const[e,t]=s.useState(!1);return N.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 text-slate-100 overflow-hidden",dir:"rtl",children:[N.jsx(te,{isOpen:e,onClose:()=>t(!1)}),N.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden w-full",children:[N.jsx(ve,{onMenuClick:()=>t(!0)}),N.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gradient-to-br from-slate-900/50 to-slate-800/50 p-3 sm:p-4 md:p-6 custom-scrollbar",children:N.jsx("div",{className:"max-w-7xl mx-auto",children:N.jsx(n,{})})})]}),N.jsxs("div",{className:"fixed inset-0 pointer-events-none overflow-hidden -z-10",children:[N.jsx("div",{className:"absolute top-1/4 -right-48 w-96 h-96 bg-cyan-500/5 rounded-full blur-3xl"}),N.jsx("div",{className:"absolute bottom-1/4 -left-48 w-96 h-96 bg-blue-500/5 rounded-full blur-3xl"})]})]})},fe=({children:e,className:s="",gradient:t=!1,hover:a=!1,onClick:l})=>{const r=t?"bg-gradient-to-br from-slate-800/90 to-slate-900/90 border-slate-700/50 backdrop-blur-sm":"bg-slate-800/50 border-slate-700",n=a?"hover:shadow-xl hover:shadow-cyan-500/10 hover:-translate-y-1 hover:border-cyan-500/50 cursor-pointer":"";return N.jsx("div",{className:`rounded-xl border transition-all duration-300 ${r} ${n} ${s}`,onClick:l,children:e})},be=({title:e,value:t,icon:a,color:l,loading:r,delay:n=0,onClick:i})=>{const[o,c]=s.useState(!1);return s.useEffect(()=>{const e=setTimeout(()=>c(!0),n);return()=>clearTimeout(e)},[n]),N.jsx(fe,{gradient:!0,hover:!0,onClick:i,className:"p-4 md:p-6 card-shine transform transition-all duration-500 "+(o?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex-1",children:[N.jsx("p",{className:"text-slate-400 text-xs md:text-sm font-medium mb-2",children:e}),r?N.jsx("div",{className:"h-8 w-20 skeleton rounded"}):N.jsx("p",{className:"text-2xl md:text-3xl font-bold text-white mb-2",children:t})]}),N.jsx("div",{className:`p-3 md:p-4 rounded-2xl ${l} shadow-lg transform transition-transform duration-300 hover:scale-110`,children:a})]})})},ye=({title:e,description:s,icon:t,color:a,onClick:l})=>N.jsxs("button",{onClick:l,className:`p-4 rounded-xl ${a} border border-slate-700/50 hover:border-cyan-500/50 transition-all duration-200 hover:shadow-xl hover:shadow-cyan-500/10 hover:-translate-y-1 group text-right w-full`,children:[N.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[N.jsx("div",{className:"p-2 rounded-lg bg-white/10 group-hover:bg-white/20 transition-colors",children:t}),N.jsx("h3",{className:"text-white font-semibold text-sm md:text-base",children:e})]}),N.jsx("p",{className:"text-slate-400 text-xs md:text-sm",children:s})]}),Ne=()=>{const e=r(),[t,a]=s.useState(new Date),[l,n]=s.useState(!0),[i,o]=s.useState({pendingCount:0,doctorsCount:0,usersCount:0,hospitalsCount:0});return s.useEffect(()=>{const e=setInterval(()=>a(new Date),1e3);return()=>clearInterval(e)},[]),s.useEffect(()=>{(async()=>{var e,s,t,a,l,r,i,c;n(!0);try{const[n,d,m,x,u]=await Promise.all([D.post("/admin/get-pending-accounts",{role:"doctor"}).catch(()=>({data:[]})),D.post("/admin/get-pending-accounts",{role:"nurse"}).catch(()=>({data:[]})),D.get("/admin/doctor/all?per_page=10000").catch(()=>({doctors:[]})),D.get("/admin/user/all?per_page=10000").catch(()=>({users:[]})),D.get("/admin/hospital/all?per_page=10000").catch(()=>({hospitals:{data:[]}}))]);let h=0;(null==(e=m.doctors)?void 0:e.total)?h=m.doctors.total:m.total?h=m.total:(null==(s=m.doctors)?void 0:s.data)&&Array.isArray(m.doctors.data)?h=m.doctors.data.length:m.doctors&&Array.isArray(m.doctors)?h=m.doctors.length:m.data&&Array.isArray(m.data)?h=m.data.length:Array.isArray(m)&&(h=m.length);let p=0;(null==(t=x.users)?void 0:t.total)?p=x.users.total:x.total?p=x.total:(null==(a=x.users)?void 0:a.data)&&Array.isArray(x.users.data)?p=x.users.data.length:x.users&&Array.isArray(x.users)?p=x.users.length:x.data&&Array.isArray(x.data)?p=x.data.length:Array.isArray(x)&&(p=x.length);let g=0;(null==(l=u.hospitals)?void 0:l.total)?g=u.hospitals.total:u.total?g=u.total:(null==(r=u.hospitals)?void 0:r.data)&&Array.isArray(u.hospitals.data)?g=u.hospitals.data.length:u.hospitals&&Array.isArray(u.hospitals)?g=u.hospitals.length:u.data&&Array.isArray(u.data)?g=u.data.length:Array.isArray(u)&&(g=u.length),o({pendingCount:((null==(i=n.data)?void 0:i.length)||0)+((null==(c=d.data)?void 0:c.length)||0),doctorsCount:h,usersCount:p,hospitalsCount:g})}catch(d){}finally{n(!1)}})()},[]),N.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[N.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-4",children:[N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold gradient-text mb-2",children:"لوحة التحكم الرئيسية"}),N.jsx("p",{className:"text-sm md:text-base text-slate-400",children:"مرحباً بك، إليك نظرة عامة على النظام"})]}),N.jsxs("div",{className:"text-right md:text-left",children:[N.jsx("p",{className:"text-xl md:text-2xl font-bold text-white",children:t.toLocaleTimeString("ar-EG")}),N.jsx("p",{className:"text-xs md:text-sm text-slate-400 hidden sm:block",children:t.toLocaleDateString("ar-EG",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),N.jsx("p",{className:"text-xs md:text-sm text-slate-400 sm:hidden",children:t.toLocaleDateString("ar-EG",{day:"numeric",month:"short"})})]})]}),N.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4 lg:gap-6",children:[N.jsx(be,{title:"طلبات موافقة",value:i.pendingCount,icon:N.jsx(we,{}),color:"bg-gradient-to-br from-amber-500/20 to-orange-500/20 text-amber-300",loading:l,delay:0,onClick:()=>e("/approvals")}),N.jsx(be,{title:"إجمالي الأطباء",value:i.doctorsCount,icon:N.jsx(Ce,{}),color:"bg-gradient-to-br from-cyan-500/20 to-blue-500/20 text-cyan-300",loading:l,delay:100,onClick:()=>e("/doctors")}),N.jsx(be,{title:"إجمالي المستخدمين",value:i.usersCount,icon:N.jsx(ke,{}),color:"bg-gradient-to-br from-emerald-500/20 to-green-500/20 text-emerald-300",loading:l,delay:200,onClick:()=>e("/users")}),N.jsx(be,{title:"إجمالي المشافي",value:i.hospitalsCount,icon:N.jsx(_e,{}),color:"bg-gradient-to-br from-rose-500/20 to-red-500/20 text-rose-300",loading:l,delay:300,onClick:()=>e("/hospitals")})]}),N.jsxs(fe,{gradient:!0,className:"p-4 md:p-6",children:[N.jsxs("h2",{className:"text-lg md:text-xl font-bold text-white mb-4 md:mb-6 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"إجراءات سريعة"]}),N.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",children:[N.jsx(ye,{title:"مراجعة الطلبات",description:"عرض طلبات الموافقة المعلقة",icon:N.jsx(we,{}),color:"bg-gradient-to-br from-amber-500/10 to-orange-500/10",onClick:()=>e("/approvals")}),N.jsx(ye,{title:"إدارة الأطباء",description:"عرض وإدارة الأطباء",icon:N.jsx(Ce,{}),color:"bg-gradient-to-br from-cyan-500/10 to-blue-500/10",onClick:()=>e("/doctors")}),N.jsx(ye,{title:"إدارة المشافي",description:"عرض وإدارة المشافي",icon:N.jsx(_e,{}),color:"bg-gradient-to-br from-emerald-500/10 to-green-500/10",onClick:()=>e("/hospitals")})]})]}),N.jsxs(fe,{gradient:!0,className:"p-4 md:p-6",children:[N.jsxs("h2",{className:"text-lg md:text-xl font-bold text-white mb-4 md:mb-6 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"حالة النظام"]}),N.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[N.jsxs("div",{className:"p-3 md:p-4 rounded-lg bg-emerald-500/10 border border-emerald-500/30",children:[N.jsxs("div",{className:"flex items-center justify-between mb-2",children:[N.jsx("span",{className:"text-xs md:text-sm text-slate-300",children:"الخادم"}),N.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"})]}),N.jsx("p",{className:"text-xs text-emerald-400 font-medium",children:"نشط ويعمل"})]}),N.jsxs("div",{className:"p-3 md:p-4 rounded-lg bg-emerald-500/10 border border-emerald-500/30",children:[N.jsxs("div",{className:"flex items-center justify-between mb-2",children:[N.jsx("span",{className:"text-xs md:text-sm text-slate-300",children:"قاعدة البيانات"}),N.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"})]}),N.jsx("p",{className:"text-xs text-emerald-400 font-medium",children:"متصلة"})]}),N.jsxs("div",{className:"p-3 md:p-4 rounded-lg bg-emerald-500/10 border border-emerald-500/30",children:[N.jsxs("div",{className:"flex items-center justify-between mb-2",children:[N.jsx("span",{className:"text-xs md:text-sm text-slate-300",children:"API"}),N.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"})]}),N.jsx("p",{className:"text-xs text-emerald-400 font-medium",children:"جاهز"})]}),N.jsxs("div",{className:"p-3 md:p-4 rounded-lg bg-cyan-500/10 border border-cyan-500/30",children:[N.jsxs("div",{className:"flex items-center justify-between mb-2",children:[N.jsx("span",{className:"text-xs md:text-sm text-slate-300",children:"الأداء"}),N.jsx("span",{className:"text-xs text-cyan-400 font-bold",children:"98%"})]}),N.jsx("div",{className:"w-full bg-slate-700 rounded-full h-1.5",children:N.jsx("div",{className:"bg-gradient-to-r from-cyan-400 to-blue-500 h-1.5 rounded-full",style:{width:"98%"}})})]})]})]})]})},we=()=>N.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),ke=()=>N.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 016-6h6a6 6 0 016 6v1h-1M15 21a3 3 0 116 0v-1a3 3 0 11-6 0v1z"})}),Ce=()=>N.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),_e=()=>N.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),Le=({value:e,onChange:s,placeholder:t="بحث...",className:a=""})=>N.jsxs("div",{className:`relative ${a}`,children:[N.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),N.jsx("input",{type:"text",value:e,onChange:e=>s(e.target.value),placeholder:t,className:"w-full pr-10 pl-4 py-2.5 bg-slate-700/50 backdrop-blur-sm border border-slate-600 rounded-lg text-white placeholder-slate-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent hover:border-slate-500"}),e&&N.jsx("button",{onClick:()=>s(""),className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white transition-colors",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),Me=({icon:e,title:s,description:t,action:a})=>N.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[e&&N.jsx("div",{className:"mb-6 p-4 rounded-full bg-slate-700/30 text-slate-400",children:e}),N.jsx("h3",{className:"text-lg font-semibold text-slate-300 mb-2",children:s}),t&&N.jsx("p",{className:"text-sm text-slate-400 text-center max-w-md mb-6",children:t}),a&&N.jsx("button",{onClick:a.onClick,className:"px-6 py-2.5 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white rounded-lg font-medium transition-all duration-200 shadow-lg shadow-cyan-500/30 transform hover:scale-105",children:a.label})]}),ze=({size:e="md",text:s})=>{const t={sm:"w-6 h-6",md:"w-12 h-12",lg:"w-16 h-16"};return N.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[N.jsxs("div",{className:"relative",children:[N.jsx("div",{className:`${t[e]} border-4 border-slate-700 border-t-cyan-500 rounded-full animate-spin`}),N.jsx("div",{className:`${t[e]} border-4 border-transparent border-t-cyan-400 rounded-full animate-spin absolute top-0 left-0`,style:{animationDirection:"reverse",animationDuration:"1s"}})]}),s&&N.jsx("p",{className:"text-slate-400 text-sm font-medium animate-pulse",children:s})]})};const Se=a.memo(function({data:e,columns:t,loading:a=!1,searchable:l=!0,searchPlaceholder:r="بحث...",emptyMessage:n="لا توجد بيانات لعرضها",itemsPerPage:i=10,onRowClick:o}){const[c,d]=s.useState(""),[m,x]=s.useState(1),[u,h]=s.useState(null),[p,g]=s.useState("asc"),v=(e,s)=>null!=e&&("object"!=typeof e?String(e).toLowerCase().includes(s.toLowerCase()):Array.isArray(e)?e.some(e=>v(e,s)):Object.values(e).some(e=>v(e,s))),j=s.useMemo(()=>c?e.filter(e=>v(e,c)):e,[e,c]),f=s.useMemo(()=>u?[...j].sort((e,s)=>{const a=t.find(e=>String(e.accessor)===u);if(!a)return 0;let l,r;return"function"==typeof a.accessor?0:(l=e[a.accessor],r=s[a.accessor],null==l?1:null==r?-1:"string"==typeof l&&"string"==typeof r?"asc"===p?l.localeCompare(r):r.localeCompare(l):l<r?"asc"===p?-1:1:l>r?"asc"===p?1:-1:0)}):j,[j,u,p,t]),b=s.useMemo(()=>{const e=(m-1)*i;return f.slice(e,e+i)},[f,m,i]),y=Math.ceil(f.length/i),w=(e,s)=>"function"==typeof s.accessor?s.accessor(e):e[s.accessor];return N.jsxs("div",{className:"space-y-3 md:space-y-4",children:[l&&N.jsx(Le,{value:c,onChange:d,placeholder:r,className:"w-full md:max-w-md"}),N.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 border border-slate-700/50 rounded-lg md:rounded-xl shadow-xl overflow-hidden backdrop-blur-sm",children:[N.jsx("div",{className:"overflow-x-auto custom-scrollbar -mx-2 sm:mx-0",children:N.jsxs("table",{className:"w-full text-xs sm:text-sm text-right text-slate-300 min-w-[600px]",children:[N.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800/80 backdrop-blur-sm sticky top-0 z-10",children:N.jsx("tr",{children:t.map((e,s)=>N.jsx("th",{scope:"col",className:`px-3 sm:px-4 md:px-6 py-3 md:py-4 whitespace-nowrap ${e.sortable&&"function"!=typeof e.accessor?"cursor-pointer hover:text-cyan-400 transition-colors select-none":""} ${e.className||""}`,onClick:()=>{return s=String(e.accessor),void(e.sortable&&"function"!=typeof e.accessor&&(u===s?g("asc"===p?"desc":"asc"):(h(s),g("asc"))));var s},children:N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("span",{children:e.header}),e.sortable&&"function"!=typeof e.accessor&&u===String(e.accessor)&&N.jsx("svg",{className:"w-4 h-4 transform transition-transform "+("desc"===p?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 15l7-7 7 7"})})]})},s))})}),N.jsx("tbody",{children:a?N.jsx("tr",{children:N.jsx("td",{colSpan:t.length,className:"text-center p-12",children:N.jsx(ze,{text:"جاري التحميل..."})})}):b.length>0?b.map((e,s)=>N.jsx("tr",{className:"border-b border-slate-700/50 table-row-hover "+(o?"cursor-pointer":""),onClick:()=>null==o?void 0:o(e),children:t.map((s,t)=>N.jsx("td",{className:`px-3 sm:px-4 md:px-6 py-3 md:py-4 ${s.className||""}`,children:w(e,s)},t))},e.id)):N.jsx("tr",{children:N.jsx("td",{colSpan:t.length,className:"p-8",children:N.jsx(Me,{icon:N.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),title:n,description:c?"جرب تعديل كلمات البحث":""})})})})]})}),!a&&y>1&&N.jsx("div",{className:"px-3 sm:px-4 md:px-6 py-3 md:py-4 bg-slate-800/50 border-t border-slate-700/50",children:N.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[N.jsxs("div",{className:"text-xs sm:text-sm text-slate-400 order-2 sm:order-1",children:["عرض ",(m-1)*i+1," إلى"," ",Math.min(m*i,f.length)," من"," ",f.length," نتيجة"]}),N.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 order-1 sm:order-2",children:[N.jsx("button",{onClick:()=>x(Math.max(1,m-1)),disabled:1===m,className:"px-2 sm:px-3 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-white",children:N.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),N.jsx("div",{className:"flex items-center gap-0.5 sm:gap-1",children:Array.from({length:Math.min(5,y)},(e,s)=>{let t;return t=y<=5||m<=3?s+1:m>=y-2?y-4+s:m-2+s,N.jsx("button",{onClick:()=>x(t),className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg transition-all text-xs sm:text-sm "+(m===t?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg":"bg-slate-700 hover:bg-slate-600 text-slate-300"),children:t},s)})}),N.jsx("button",{onClick:()=>x(Math.min(y,m+1)),disabled:m===y,className:"px-2 sm:px-3 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-white",children:N.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]})]})})]})]})}),Ae=a.memo(({children:e,variant:t="default",size:a="md",className:l=""})=>{const r=s.useMemo(()=>({default:"bg-slate-600/20 text-slate-300 border border-slate-600/50",success:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/50",warning:"bg-amber-500/20 text-amber-400 border border-amber-500/50",danger:"bg-red-500/20 text-red-400 border border-red-500/50",info:"bg-cyan-500/20 text-cyan-400 border border-cyan-500/50"}),[]),n=s.useMemo(()=>({sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-xs",lg:"px-3 py-1.5 text-sm"}),[]);return N.jsx("span",{className:`inline-flex items-center justify-center font-medium rounded-full transition-all duration-200 ${r[t]} ${n[a]} ${l}`,children:e})}),Ee=({isOpen:e,onClose:a,title:l,children:r,size:n="md",footer:i})=>{if(s.useEffect(()=>{if(!e)return;const s=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=s}},[e]),s.useEffect(()=>{if(!e)return;const s=e=>{"Escape"===e.key&&a()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[e,a]),!e||"undefined"==typeof document)return null;const o=N.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 sm:p-4 bg-black/70 backdrop-blur-sm animate-fade-in",onClick:a,children:N.jsxs("div",{className:`relative w-full ${{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[n]} bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl sm:rounded-2xl shadow-2xl animate-scale-in max-h-[90vh] flex flex-col`,onClick:e=>e.stopPropagation(),children:[l&&N.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-3 sm:py-4 border-b border-slate-700/50 flex-shrink-0",children:[N.jsx("h2",{className:"text-lg sm:text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-400",children:l}),N.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white transition-colors p-1 rounded-lg hover:bg-slate-700/50",children:N.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),N.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 overflow-y-auto custom-scrollbar flex-1",children:r}),i&&N.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-t border-slate-700/50 bg-slate-800/50 flex-shrink-0",children:i})]})});return t.createPortal(o,document.body)},Pe=()=>{const[e,t]=s.useState([]),a=s.useCallback(e=>{const s=Date.now();t(t=>[...t,{...e,id:s}])},[]),l=s.useCallback(e=>{t(s=>s.filter(s=>s.id!==e))},[]);return{toasts:e,showToast:a,removeToast:l,success:(e,s)=>a({message:e,type:"success",duration:s}),error:(e,s)=>a({message:e,type:"error",duration:s}),warning:(e,s)=>a({message:e,type:"warning",duration:s}),info:(e,s)=>a({message:e,type:"info",duration:s})}},Be=({message:e,type:t="info",onClose:a,duration:l=3e3,offset:r=0})=>{s.useEffect(()=>{const e=setTimeout(a,l);return()=>clearTimeout(e)},[l,a]);const n={success:N.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),error:N.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),warning:N.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),info:N.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})},i=24+88*r;return N.jsxs("div",{className:`\n        fixed right-6 z-50\n        flex items-center gap-3 px-5 py-3 rounded-lg\n        ${{success:"bg-gradient-to-r from-emerald-500/90 to-green-500/90 border-emerald-400/50",error:"bg-gradient-to-r from-red-500/90 to-rose-500/90 border-red-400/50",warning:"bg-gradient-to-r from-amber-500/90 to-orange-500/90 border-amber-400/50",info:"bg-gradient-to-r from-cyan-500/90 to-blue-500/90 border-cyan-400/50"}[t]} backdrop-blur-md\n        border shadow-2xl\n        animate-slide-up\n        max-w-md\n      `,style:{top:`${i}px`},children:[N.jsx("div",{className:"flex-shrink-0",children:n[t]}),N.jsx("p",{className:"text-white font-medium text-sm flex-1",children:e}),N.jsx("button",{onClick:a,className:"flex-shrink-0 text-white/80 hover:text-white transition-colors",children:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})},$e=()=>{var e,t,a,l,r,n,i,o,c,d,m,x;const[u,h]=s.useState("doctor"),[p,g]=s.useState([]),[v,j]=s.useState([]),[f,b]=s.useState(!0),[y,w]=s.useState(null),{toasts:k,removeToast:C,success:_,error:L,warning:M}=Pe(),z=s.useCallback(async()=>{b(!0);try{const e=await D.post("/admin/get-pending-accounts",{role:u});let s=e.data||e||[];Array.isArray(s)&&(s=s.filter(e=>"doctor"===u?e.doctor&&!e.nurse:"nurse"===u&&(e.nurse&&!e.doctor))),g(s)}catch(e){L("فشل تحميل طلبات الموافقة"),g([])}finally{b(!1)}},[u,L]);s.useEffect(()=>{z()},[z]),s.useEffect(()=>{(async()=>{var e,s;try{const t=await D.get("/admin/specializations");let a=[];Array.isArray(t)?a=t:Array.isArray(t.data)?a=t.data:(null==(e=t.data)?void 0:e.data)&&Array.isArray(t.data.data)?a=t.data.data:(null==(s=t.data)?void 0:s.specializations)&&(a=t.data.specializations),j(a)}catch(t){429!==(null==t?void 0:t.status)&&L("فشل تحميل التخصصات")}})()},[L]);const S=e=>{if(!e)return"غير محدد";const s=v.find(s=>s.id===e);return(null==s?void 0:s.name_ar)||"غير محدد"},A=async e=>{try{await D.get(`/admin/approveAccount/${e}`),g(s=>s.filter(s=>s.id!==e)),_("تمت الموافقة على الحساب بنجاح")}catch(s){L(`فشلت الموافقة: ${(null==s?void 0:s.message)||"حدث خطأ غير متوقع"}`)}},E=async e=>{if(!window.confirm("هل أنت متأكد من رفض هذا الحساب؟"))return;try{await(async()=>{try{return void(await D.post(`/admin/rejectAccount/${e}`))}catch(s){await D.post("/admin/rejectAccount",{id:e})}})(),g(s=>s.filter(s=>s.id!==e)),M("تم رفض الحساب")}catch(s){L(`فشل رفض الحساب: ${(null==s?void 0:s.message)||"حدث خطأ غير متوقع"}`)}},P=[{header:"الاسم الكامل",accessor:e=>{var s,t;return(null==(s=e.doctor)?void 0:s.full_name)||(null==(t=e.nurse)?void 0:t.full_name)||"غير متوفر"},sortable:!0,className:"font-medium text-white"},{header:"البريد الإلكتروني",accessor:"email"},{header:"رقم الهاتف",accessor:"phone_number"},{header:"التخصص",accessor:e=>{var s;return N.jsxs("div",{className:"text-sm",children:[e.doctor&&N.jsx(Ae,{variant:"info",size:"sm",children:(null==(s=e.doctor.specialization)?void 0:s.name_ar)||S(e.doctor.specialization_id)}),e.nurse&&N.jsx(Ae,{variant:"success",size:"sm",children:e.nurse.graduation_type})]})}},{header:"تاريخ الطلب",accessor:e=>new Date(e.created_at).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"}),sortable:!0},{header:"الإجراءات",accessor:e=>N.jsxs("div",{className:"flex gap-2 flex-wrap",children:[N.jsx(Q,{size:"sm",variant:"primary",onClick:s=>{s.stopPropagation(),w(e)},icon:N.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),children:"عرض"}),N.jsx(Q,{size:"sm",variant:"success",onClick:s=>{s.stopPropagation(),A(e.id)},icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),children:"موافقة"}),N.jsx(Q,{size:"sm",variant:"danger",onClick:s=>{s.stopPropagation(),E(e.id)},icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),children:"رفض"})]})}];return N.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[N.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"طلبات الموافقة"}),N.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"مراجعة والموافقة على طلبات الانضمام للنظام"})]}),N.jsxs(Ae,{variant:"warning",size:"lg",children:[p.length," طلب معلق"]})]}),N.jsxs("div",{className:"flex gap-1 sm:gap-2 p-1 bg-slate-800/50 rounded-lg border border-slate-700/50 w-full sm:w-fit overflow-x-auto",children:[N.jsx(We,{title:"الأطباء",isActive:"doctor"===u,onClick:()=>h("doctor"),icon:N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),N.jsx(We,{title:"الممرضون",isActive:"nurse"===u,onClick:()=>h("nurse"),icon:N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]}),N.jsx(Se,{data:p,columns:P,loading:f,searchable:!0,searchPlaceholder:"ابحث في طلبات الموافقة...",emptyMessage:`لا توجد طلبات موافقة من ${"doctor"===u?"الأطباء":"الممرضين"} حالياً`,itemsPerPage:10}),N.jsx(Ee,{isOpen:!!y,onClose:()=>w(null),title:"تفاصيل "+("doctor"===u?"الطبيب":"الممرض"),size:"lg",footer:N.jsxs("div",{className:"flex gap-3 justify-end",children:[N.jsx(Q,{variant:"danger",onClick:()=>{y&&(E(y.id),w(null))},icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),children:"رفض الحساب"}),N.jsx(Q,{variant:"success",onClick:()=>{y&&(A(y.id),w(null))},icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),children:"الموافقة على الحساب"})]}),children:y&&N.jsxs("div",{className:"space-y-6",children:[N.jsx("div",{className:"bg-gradient-to-r from-cyan-500/10 to-blue-500/10 rounded-xl p-4 sm:p-6 border border-cyan-500/30",children:N.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 sm:gap-6",children:[N.jsxs("div",{className:"flex-shrink-0",children:[(null==(e=y.doctor)?void 0:e.profile_image)||(null==(t=y.nurse)?void 0:t.profile_image)?N.jsx("img",{src:(null==(a=y.doctor)?void 0:a.profile_image)||(null==(l=y.nurse)?void 0:l.profile_image),alt:(null==(r=y.doctor)?void 0:r.full_name)||(null==(n=y.nurse)?void 0:n.full_name),className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full object-cover border-4 border-cyan-400 shadow-lg shadow-cyan-500/50",onError:e=>{var s;e.currentTarget.style.display="none",null==(s=e.currentTarget.nextElementSibling)||s.classList.remove("hidden")}}):null,N.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center border-4 border-cyan-400 shadow-lg shadow-cyan-500/50 "+((null==(i=y.doctor)?void 0:i.profile_image)||(null==(o=y.nurse)?void 0:o.profile_image)?"hidden":""),children:N.jsx("svg",{className:"w-12 h-12 sm:w-16 sm:h-16 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]}),N.jsxs("div",{className:"flex-1 text-center sm:text-right space-y-2",children:[N.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white",children:(null==(c=y.doctor)?void 0:c.full_name)||(null==(d=y.nurse)?void 0:d.full_name)||"غير متوفر"}),y.doctor&&N.jsx("div",{className:"flex items-center justify-center sm:justify-start gap-2",children:N.jsx(Ae,{variant:"info",size:"lg",children:N.jsxs("span",{className:"flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(null==(m=y.doctor.specialization)?void 0:m.name_ar)||S(y.doctor.specialization_id)]})})}),y.nurse&&N.jsx("div",{className:"flex items-center justify-center sm:justify-start gap-2",children:N.jsx(Ae,{variant:"success",size:"lg",children:N.jsxs("span",{className:"flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),y.nurse.graduation_type]})})})]})]})}),N.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[N.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"المعلومات الشخصية"]}),N.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[N.jsx(Re,{label:"البريد الإلكتروني",value:y.email}),N.jsx(Re,{label:"رقم الهاتف",value:y.phone_number}),N.jsx(Re,{label:"تاريخ التسجيل",value:new Date(y.created_at).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),y.doctor&&N.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[N.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"المعلومات المهنية"]}),N.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[N.jsx(Re,{label:"التخصص",value:N.jsx(Ae,{variant:"info",size:"md",children:(null==(x=y.doctor.specialization)?void 0:x.name_ar)||S(y.doctor.specialization_id)})}),N.jsx(Re,{label:"العنوان",value:y.doctor.address}),y.doctor.age&&N.jsx(Re,{label:"العمر",value:`${y.doctor.age} سنة`}),y.doctor.gender&&N.jsx(Re,{label:"الجنس",value:"male"===y.doctor.gender?"ذكر":"أنثى"}),y.doctor.profile_description&&N.jsx("div",{className:"sm:col-span-2",children:N.jsx(Re,{label:"الوصف الشخصي",value:y.doctor.profile_description})}),y.doctor.license_image_path&&N.jsxs("div",{className:"sm:col-span-2",children:[N.jsx("p",{className:"text-xs sm:text-sm text-slate-400 font-medium mb-2",children:"صورة الرخصة الطبية"}),N.jsxs("div",{className:"relative group",children:[N.jsx("img",{src:`https://sahtee.evra-co.com/storage/${y.doctor.license_image_path}`,alt:"رخصة طبية",className:"w-full max-w-md rounded-lg border-2 border-slate-600 hover:border-cyan-400 transition-all duration-300 cursor-pointer",onClick:()=>window.open(`https://sahtee.evra-co.com/storage/${y.doctor.license_image_path}`,"_blank")}),N.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-all duration-300 rounded-lg flex items-center justify-center",children:N.jsx("svg",{className:"w-10 h-10 text-white opacity-0 group-hover:opacity-100 transition-all duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})})})]})]})]})]}),y.nurse&&N.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[N.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"المعلومات المهنية"]}),N.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[N.jsx(Re,{label:"نوع التخرج",value:N.jsx(Ae,{variant:"success",size:"md",children:y.nurse.graduation_type})}),N.jsx(Re,{label:"العنوان",value:y.nurse.address}),y.nurse.age&&N.jsx(Re,{label:"العمر",value:`${y.nurse.age} سنة`}),y.nurse.gender&&N.jsx(Re,{label:"الجنس",value:"male"===y.nurse.gender?"ذكر":"أنثى"}),y.nurse.profile_description&&N.jsx("div",{className:"sm:col-span-2",children:N.jsx(Re,{label:"الوصف الشخصي",value:y.nurse.profile_description})})]})]}),N.jsx("div",{className:"flex items-center justify-center",children:N.jsx(Ae,{variant:"approved"===y.is_approved?"success":"rejected"===y.is_approved?"danger":"warning",size:"lg",children:"approved"===y.is_approved?"✓ تمت الموافقة":"rejected"===y.is_approved?"✗ مرفوض":"⏳ قيد الانتظار"})})]})}),k.map((e,s)=>N.jsx(Be,{message:e.message,type:e.type,duration:e.duration,offset:s,onClose:()=>C(e.id)},e.id))]})},We=({title:e,isActive:s,onClick:t,icon:a})=>N.jsxs("button",{onClick:t,className:"px-4 sm:px-6 py-2 sm:py-3 rounded-lg font-semibold text-xs sm:text-sm transition-all duration-200 flex items-center gap-1 sm:gap-2 whitespace-nowrap "+(s?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg shadow-cyan-500/30":"text-slate-400 hover:text-white hover:bg-slate-700/50"),children:[N.jsx("span",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",children:a}),e]}),Re=({label:e,value:s})=>N.jsxs("div",{className:"space-y-1",children:[N.jsx("p",{className:"text-xs sm:text-sm text-slate-400 font-medium",children:e}),N.jsx("p",{className:"text-sm sm:text-base text-white font-semibold",children:s||N.jsx("span",{className:"text-slate-500",children:"غير متوفر"})})]});async function Te(e,s,t){if(!e.length)return[];const a=new Array(e.length);let l=0;const r=[],n=async()=>{for(;l<e.length;){const s=l++;a[s]=await t(e[s],s)}},i=Math.min(s,e.length);for(let o=0;o<i;o++)r.push(n());return await Promise.all(r),a}function Ve(e){if(null==e?void 0:e.aborted)throw new DOMException("Aborted","AbortError")}const He=()=>{var e,t;const a=r(),[l,n]=s.useState(null),[i,o]=s.useState(1),[c,d]=s.useState({data:[],loading:!0,totalPages:1,total:0}),[m,x]=s.useState(""),[u,h]=s.useState(""),[p,g]=s.useState({active:!1,loading:!1,data:[],total:0,error:""}),[v,j]=s.useState(0),f=s.useRef(null),b=s.useRef(null),y=s.useRef(null),w=s.useCallback(async(e,s,t)=>{const a=(e=>{const s=new URLSearchParams;return Object.entries(e).forEach(([e,t])=>{null!=t&&""!==t&&s.append(e,String(t))}),s.toString()})({page:e,per_page:s});return(e=>{var s,t,a,l,r,n;let i=[null==e?void 0:e.doctors,null==e?void 0:e.data,e].find(e=>null!=e);i&&"object"==typeof i&&"doctors"in i&&(i=i.doctors);let o=[];Array.isArray(null==i?void 0:i.data)?o=i.data:Array.isArray(i)?o=i:Array.isArray(null==(s=null==e?void 0:e.doctors)?void 0:s.data)?o=e.doctors.data:Array.isArray(null==(t=null==e?void 0:e.data)?void 0:t.data)?o=e.data.data:Array.isArray(null==e?void 0:e.data)?o=e.data:Array.isArray(e)&&(o=e);const c=(null==i?void 0:i.current_page)??(null==e?void 0:e.current_page)??(null==(a=null==e?void 0:e.data)?void 0:a.current_page)??1,d=(null==i?void 0:i.last_page)??(null==e?void 0:e.last_page)??(null==(l=null==e?void 0:e.data)?void 0:l.last_page)??c,m=(null==i?void 0:i.total)??(null==e?void 0:e.total)??(null==(r=null==e?void 0:e.data)?void 0:r.total)??o.length,x=(null==i?void 0:i.per_page)??(null==e?void 0:e.per_page)??(null==(n=null==e?void 0:e.data)?void 0:n.per_page)??o.length;return{items:o,currentPage:Number(c)||1,lastPage:Number(d)||1,total:Number(m)||o.length,perPage:Number(x)||o.length}})(await D.get(`/admin/doctor/all?${a}`,{signal:t}))},[]),k=s.useCallback(async e=>{if(f.current)return f.current;if(b.current)return b.current;const s=(async()=>{Ve(e);const s=[],{items:t,lastPage:a,total:l,perPage:r}=await w(1,200,e);s.push(...t);const n=r||200,i=l||s.length,o=n>0?Math.ceil(i/n):1,c=Math.max(a||1,o||1);if(c>1){const t=Array.from({length:c-1},(e,s)=>s+2);(await Te(t,4,async s=>{Ve(e);const{items:t}=await w(s,200,e);return t})).forEach(e=>{s.push(...e)})}return f.current=s,s})();b.current=s;try{const e=await s;return b.current=null,e}catch(t){throw b.current=null,(null==e?void 0:e.aborted)||(f.current=null),t}},[w,v]);s.useEffect(()=>{const e=setTimeout(()=>{h(m.trim())},350);return()=>clearTimeout(e)},[m]),s.useEffect(()=>{if(u){y.current&&y.current.abort();const e=new AbortController;return y.current=e,g({active:!0,loading:!0,data:[],total:0,error:""}),k(e.signal).then(s=>{if(e.signal.aborted)return;const t=s.filter(e=>((e,s)=>{var t,a,l,r;const n=s.trim().toLowerCase();return!n||[e.full_name,null==(t=e.account)?void 0:t.email,null==(a=e.account)?void 0:a.phone_number,null==(l=e.specialization)?void 0:l.name_ar,null==(r=e.specialization)?void 0:r.name_en,e.address].filter(e=>!!e).some(e=>e.toLowerCase().includes(n))})(e,u));g({active:!0,loading:!1,data:t,total:t.length,error:""})}).catch(()=>{e.signal.aborted||g({active:!0,loading:!1,data:[],total:0,error:"تعذر تحميل البيانات. يرجى المحاولة مرة أخرى."})}).finally(()=>{y.current===e&&(y.current=null)}),()=>e.abort()}y.current&&(y.current.abort(),y.current=null),g({active:!1,loading:!1,data:[],total:0,error:""})},[u,k,v]),s.useEffect(()=>{if(u||f.current||b.current)return;const e=new AbortController,s=window.setTimeout(()=>{k(e.signal).catch(()=>{e.abort()})},800);return()=>{e.abort(),window.clearTimeout(s)}},[u,k]),s.useEffect(()=>{if(u)return;const e=new AbortController;return d(e=>({...e,loading:!0})),w(i,25,e.signal).then(({items:s,lastPage:t,total:a})=>{e.signal.aborted||d({data:s,loading:!1,totalPages:t,total:a})}).catch(()=>{e.signal.aborted||d(e=>({...e,loading:!1}))}),()=>e.abort()},[u,i,w]);const C=e=>{p.active||e>=1&&e<=c.totalPages&&(o(e),window.scrollTo({top:0,behavior:"smooth"}))},_=[{header:"الاسم الكامل",accessor:"full_name",sortable:!0,className:"font-medium text-white"},{header:"التخصص",accessor:e=>{var s;return(null==(s=e.specialization)?void 0:s.name_ar)||"-"},sortable:!0},{header:"البريد الإلكتروني",accessor:e=>{var s;return(null==(s=e.account)?void 0:s.email)||"-"}},{header:"رقم الهاتف",accessor:e=>{var s;return(null==(s=e.account)?void 0:s.phone_number)||"-"}},{header:"الجنس",accessor:e=>N.jsx(Ae,{variant:"info",size:"sm",children:"male"===e.gender?"ذكر":"أنثى"})},{header:"التقييم",accessor:e=>N.jsx("div",{className:"flex items-center gap-2",children:void 0!==e.avg_rating&&null!==e.avg_rating?N.jsxs(N.Fragment,{children:[N.jsx("span",{className:"text-yellow-400 font-semibold",children:e.avg_rating.toFixed(1)}),N.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),void 0!==e.ratings_count&&null!==e.ratings_count&&N.jsxs("span",{className:"text-slate-400 text-xs",children:["(",e.ratings_count,")"]})]}):N.jsx("span",{className:"text-slate-500 text-sm",children:"-"})})},{header:"الإجراءات",accessor:e=>N.jsx(Q,{size:"sm",variant:"primary",onClick:s=>{s.stopPropagation(),n(e)},icon:N.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),children:"عرض التفاصيل"})}],L=p.active?p.total:c.total,M=p.active?p.data:c.data,z=p.active?p.loading:c.loading,S=p.active?p.loading?"جاري البحث في الأطباء...":p.error||"لم يتم العثور على نتائج مطابقة.":"لا يوجد أطباء مسجلين",A=p.active?Math.max(M.length,1):25;return N.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[N.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة الأطباء"}),N.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع الأطباء المسجلين في النظام"})]}),N.jsx("div",{className:"flex items-center gap-2",children:N.jsx(Ae,{variant:"info",size:"lg",children:z?"...":`${L} طبيب`})})]}),N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[N.jsx(X,{value:m,onChange:e=>x(e.target.value),placeholder:"ابحث في جميع الأطباء بالاسم، التخصص، البريد، الهاتف...",icon:N.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),u&&N.jsxs("div",{className:"mt-2 text-sm text-slate-400 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[p.loading?N.jsxs("span",{className:"flex items-center gap-2",children:[N.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري تحميل جميع الأطباء لضمان دقة النتائج..."]}):N.jsx("span",{children:p.total>0?`تم العثور على ${p.total} طبيب مطابق`:"لم يتم العثور على نتائج مطابقة"}),p.error&&N.jsx("span",{className:"text-red-400",children:p.error})]})]}),N.jsx(Se,{data:M,columns:_,loading:z,searchable:!1,emptyMessage:S,itemsPerPage:A,onRowClick:e=>a(`/doctors/${e.id}`)},p.active?"search-results":`page-${i}`),!p.active&&c.totalPages>1&&N.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[N.jsxs("div",{className:"text-sm text-slate-400",children:["الصفحة ",i," من ",c.totalPages," (",c.total," طبيب إجمالاً)"]}),N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>C(1),disabled:1===i||c.loading,children:"الأولى"}),N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>C(i-1),disabled:1===i||c.loading,icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"السابقة"}),N.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,c.totalPages)},(e,s)=>{let t;return t=c.totalPages<=5||i<=3?s+1:i>=c.totalPages-2?c.totalPages-4+s:i-2+s,N.jsx(Q,{variant:i===t?"primary":"secondary",size:"sm",onClick:()=>C(t),disabled:c.loading,className:"min-w-[40px]",children:t},t)})}),N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>C(i+1),disabled:i===c.totalPages||c.loading,icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),children:"التالية"}),N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>C(c.totalPages),disabled:i===c.totalPages||c.loading,children:"الأخيرة"})]})]}),N.jsx(Ee,{isOpen:!!l,onClose:()=>n(null),title:"تفاصيل الطبيب",size:"lg",children:l&&N.jsxs("div",{className:"space-y-6",children:[N.jsx("div",{className:"bg-gradient-to-r from-cyan-500/10 to-blue-500/10 rounded-xl p-4 sm:p-6 border border-cyan-500/30",children:N.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 sm:gap-6",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center border-4 border-cyan-400 shadow-lg shadow-cyan-500/50",children:N.jsx("svg",{className:"w-12 h-12 sm:w-16 sm:h-16 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})}),N.jsxs("div",{className:"flex-1 text-center sm:text-right space-y-2",children:[N.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white",children:l.full_name}),l.specialization&&N.jsx("div",{className:"flex items-center justify-center sm:justify-start gap-2",children:N.jsx(Ae,{variant:"info",size:"lg",children:N.jsxs("span",{className:"flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.specialization.name_ar]})})})]})]})}),N.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[N.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"المعلومات الشخصية"]}),N.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[N.jsx(Ie,{label:"الاسم الكامل",value:l.full_name}),N.jsx(Ie,{label:"البريد الإلكتروني",value:(null==(e=l.account)?void 0:e.email)||"غير متوفر"}),N.jsx(Ie,{label:"رقم الهاتف",value:(null==(t=l.account)?void 0:t.phone_number)||"غير متوفر"}),N.jsx(Ie,{label:"العنوان",value:l.address||"غير متوفر"}),l.age&&N.jsx(Ie,{label:"العمر",value:`${l.age} سنة`}),N.jsx(Ie,{label:"الجنس",value:"male"===l.gender?"ذكر":"أنثى"})]})]}),N.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[N.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"المعلومات المهنية"]}),N.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.specialization&&N.jsx(Ie,{label:"التخصص",value:N.jsx(Ae,{variant:"info",size:"md",children:l.specialization.name_ar})}),void 0!==l.avg_rating&&null!==l.avg_rating&&N.jsx(Ie,{label:"التقييم",value:N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("span",{className:"text-yellow-400 font-semibold",children:l.avg_rating.toFixed(1)}),N.jsx("svg",{className:"w-5 h-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),l.ratings_count&&N.jsxs("span",{className:"text-slate-400 text-sm",children:["(",l.ratings_count," تقييم)"]})]})}),void 0!==l.reservations_count&&N.jsx(Ie,{label:"عدد الحجوزات",value:l.reservations_count.toString()})]}),l.profile_description&&N.jsx("div",{className:"mt-4",children:N.jsx(Ie,{label:"الوصف الشخصي",value:l.profile_description})})]}),l.services&&l.services.length>0&&N.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[N.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"الخدمات"]}),N.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:l.services.map(e=>N.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3 border border-slate-600",children:[N.jsx("div",{className:"font-semibold text-white mb-1",children:e.name}),N.jsxs("div",{className:"text-sm text-slate-400",children:["السعر: ",e.price," ل.س | المدة: ",e.duration_minutes," دقيقة"]})]},e.id))})]}),l.doctor_work_schedule&&l.doctor_work_schedule.length>0&&N.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[N.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"الجدول الزمني"]}),N.jsx("div",{className:"space-y-2",children:l.doctor_work_schedule.map(e=>N.jsxs("div",{className:"flex items-center justify-between bg-slate-700/50 rounded-lg p-3",children:[N.jsx("span",{className:"font-medium text-white",children:{sunday:"الأحد",monday:"الإثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت"}[e.day_of_week]}),N.jsxs("span",{className:"text-slate-300",children:[e.start_time," - ",e.end_time]})]},e.id))})]})]})})]})},Ie=({label:e,value:s})=>N.jsxs("div",{className:"space-y-1",children:[N.jsx("p",{className:"text-xs sm:text-sm text-slate-400 font-medium",children:e}),N.jsx("p",{className:"text-sm sm:text-base text-white font-semibold",children:s||N.jsx("span",{className:"text-slate-500",children:"غير متوفر"})})]}),De=()=>{var e,t,a;const{id:l}=i(),n=r(),[o,c]=s.useState(null),[d,m]=s.useState([]),[x,u]=s.useState(!0),[h,p]=s.useState(!0),[g,v]=s.useState(""),[j,f]=s.useState(""),[b,y]=s.useState(""),[w,k]=s.useState({pending:0,approved:0,rejected:0,cancelled:0,completed:0,total:0});s.useEffect(()=>{C()},[l]),s.useEffect(()=>{l&&_()},[l,g,j,b]);const C=async()=>{u(!0);try{const e=await D.get(`/admin/doctor/${l}`);c(e.doctor||e)}catch(e){}finally{u(!1)}},_=async()=>{p(!0);try{const e=new URLSearchParams;g&&e.append("status",g),j&&e.append("from",j),b&&e.append("to",b);const s=await D.get(`/admin/doctor/${l}/reservations?${e.toString()}`),t=s.data||s.reservations||s;m(Array.isArray(t)?t:[]),L(t)}catch(e){m([])}finally{p(!1)}},L=e=>{const s={pending:0,approved:0,rejected:0,cancelled:0,completed:0,total:e.length};e.forEach(e=>{e.status in s&&s[e.status]++}),k(s)};return x?N.jsx("div",{className:"flex justify-center items-center h-64",children:N.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-400"})}):o?N.jsxs("div",{className:"space-y-6",children:[N.jsx("div",{className:"flex items-center justify-between",children:N.jsxs("div",{className:"flex items-center gap-4",children:[N.jsxs("button",{onClick:()=>n("/doctors"),className:"flex items-center gap-2 px-4 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-cyan-500 rounded-lg transition-all duration-200 group",children:[N.jsx("svg",{className:"w-5 h-5 text-cyan-400 group-hover:text-cyan-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),N.jsx("span",{className:"text-slate-300 group-hover:text-white font-medium transition-colors",children:"رجوع"})]}),N.jsxs("h1",{className:"text-3xl font-bold text-slate-100",children:["تفاصيل الطبيب - ",o.full_name]})]})}),N.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[N.jsxs("div",{className:"lg:col-span-2 bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[N.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"المعلومات الأساسية"}),N.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"الاسم الكامل"}),N.jsx("p",{className:"text-white font-medium",children:o.full_name})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"التخصص"}),N.jsx("p",{className:"text-white font-medium",children:null==(e=o.specialization)?void 0:e.name_ar})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"البريد الإلكتروني"}),N.jsx("p",{className:"text-white font-medium",children:null==(t=o.account)?void 0:t.email})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"رقم الهاتف"}),N.jsx("p",{className:"text-white font-medium",children:null==(a=o.account)?void 0:a.phone_number})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"العمر"}),N.jsxs("p",{className:"text-white font-medium",children:[o.age," سنة"]})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"الجنس"}),N.jsx("p",{className:"text-white font-medium",children:"male"===o.gender?"ذكر":"أنثى"})]}),N.jsxs("div",{className:"col-span-2",children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"العنوان"}),N.jsx("p",{className:"text-white font-medium",children:o.address})]}),o.profile_description&&N.jsxs("div",{className:"col-span-2",children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"الوصف"}),N.jsx("p",{className:"text-white font-medium",children:o.profile_description})]})]}),N.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-700",children:[N.jsx("h3",{className:"text-lg font-bold text-cyan-400 mb-4",children:"رخصة الطبيب"}),l&&N.jsx("div",{className:"flex items-center gap-4",children:N.jsxs("button",{onClick:async()=>{try{const e=await D.get(`/admin/doctor-license/${l}`,{skipAuth:!1});if(e instanceof Blob){const s=URL.createObjectURL(e);window.open(s,"_blank")}else e.url&&window.open(e.url,"_blank")}catch(e){alert("فشل تحميل صورة الرخصة: "+(e.message||"خطأ غير معروف"))}},className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-lg text-white font-medium transition-colors flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"عرض الرخصة"]})})]})]}),N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[N.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"إحصائيات الحجوزات"}),N.jsxs("div",{className:"space-y-3",children:[N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-slate-400",children:"الإجمالي"}),N.jsx("span",{className:"text-2xl font-bold text-white",children:w.total})]}),N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-yellow-400",children:"قيد الانتظار"}),N.jsx("span",{className:"font-bold text-yellow-400",children:w.pending})]}),N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-green-400",children:"موافق عليها"}),N.jsx("span",{className:"font-bold text-green-400",children:w.approved})]}),N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-blue-400",children:"مكتملة"}),N.jsx("span",{className:"font-bold text-blue-400",children:w.completed})]}),N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-red-400",children:"مرفوضة"}),N.jsx("span",{className:"font-bold text-red-400",children:w.rejected})]}),N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-gray-400",children:"ملغاة"}),N.jsx("span",{className:"font-bold text-gray-400",children:w.cancelled})]})]})]})]}),o.services&&o.services.length>0&&N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[N.jsxs("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:["الخدمات المتاحة (",o.services.length,")"]}),N.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.services.map(e=>N.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:[N.jsx("h3",{className:"text-white font-medium mb-2",children:e.name}),N.jsxs("div",{className:"flex justify-between items-center text-sm",children:[N.jsx("span",{className:"text-slate-400",children:"السعر:"}),N.jsxs("span",{className:"text-cyan-400 font-bold",children:[e.price," ل.س"]})]}),N.jsxs("div",{className:"flex justify-between items-center text-sm mt-1",children:[N.jsx("span",{className:"text-slate-400",children:"المدة:"}),N.jsxs("span",{className:"text-white",children:[e.duration_minutes," دقيقة"]})]})]},e.id))})]}),o.doctor_work_schedule&&o.doctor_work_schedule.length>0&&N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[N.jsxs("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:["أوقات العمل (",o.doctor_work_schedule.length," أيام)"]}),N.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.doctor_work_schedule.map(e=>{return N.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:[N.jsx("h3",{className:"text-white font-medium mb-2",children:(s=e.day_of_week,{sunday:"الأحد",monday:"الاثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت"}[s]||s)}),N.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse text-sm",children:[N.jsx("span",{className:"text-cyan-400",children:e.start_time}),N.jsx("span",{className:"text-slate-400",children:"-"}),N.jsx("span",{className:"text-cyan-400",children:e.end_time})]})]},e.id);var s})})]}),N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[N.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 space-y-4 md:space-y-0",children:[N.jsx("h2",{className:"text-xl font-bold text-cyan-400",children:"الحجوزات"}),N.jsxs("div",{className:"flex flex-wrap gap-2",children:[N.jsxs("select",{value:g,onChange:e=>v(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",children:[N.jsx("option",{value:"",children:"جميع الحالات"}),N.jsx("option",{value:"pending",children:"قيد الانتظار"}),N.jsx("option",{value:"approved",children:"موافق عليها"}),N.jsx("option",{value:"completed",children:"مكتملة"}),N.jsx("option",{value:"rejected",children:"مرفوضة"}),N.jsx("option",{value:"cancelled",children:"ملغاة"})]}),N.jsx("input",{type:"date",value:j,onChange:e=>f(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",placeholder:"من تاريخ"}),N.jsx("input",{type:"date",value:b,onChange:e=>y(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",placeholder:"إلى تاريخ"}),(g||j||b)&&N.jsx("button",{onClick:()=>{v(""),f(""),y("")},className:"px-3 py-2 bg-red-600 hover:bg-red-700 rounded-md text-sm",children:"إلغاء الفلاتر"})]})]}),N.jsx("div",{className:"overflow-x-auto",children:N.jsxs("table",{className:"w-full text-sm text-right text-slate-300",children:[N.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800",children:N.jsxs("tr",{children:[N.jsx("th",{scope:"col",className:"px-6 py-3",children:"#"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"المريض"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"الخدمة"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"التاريخ"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"الوقت"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"الحالة"})]})}),N.jsx("tbody",{children:h?N.jsx("tr",{children:N.jsx("td",{colSpan:6,className:"text-center p-8",children:"جاري التحميل..."})}):d.length>0?d.map(e=>{var s,t,a,l,r,n,i,o,c,d,m,x,u;const h=(null==(t=null==(s=e.user)?void 0:s.account)?void 0:t.phone_number)||(null==(a=e.user)?void 0:a.phone_number)||(null==(r=null==(l=e.user)?void 0:l.account)?void 0:r.phone)||(null==(n=e.user)?void 0:n.phone)||(null==(o=null==(i=e.user)?void 0:i.account)?void 0:o.mobile)||(null==(c=e.user)?void 0:c.mobile);return N.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-800",children:[N.jsx("td",{className:"px-6 py-4",children:e.id}),N.jsx("td",{className:"px-6 py-4",children:N.jsxs("div",{children:[N.jsx("p",{className:"font-medium",children:(null==(d=e.user)?void 0:d.full_name)||(null==(x=null==(m=e.user)?void 0:m.account)?void 0:x.full_name)||`مريض #${e.user_id}`}),N.jsxs("p",{className:"text-xs text-slate-400",children:["📞 ",h||"غير متوفر"]})]})}),N.jsx("td",{className:"px-6 py-4",children:(null==(u=e.doctor_service)?void 0:u.name)||"-"}),N.jsx("td",{className:"px-6 py-4",children:e.date}),N.jsx("td",{className:"px-6 py-4",children:N.jsxs("div",{className:"text-xs",children:[N.jsx("p",{children:e.start_time}),N.jsxs("p",{className:"text-slate-400",children:["إلى ",e.end_time]})]})}),N.jsx("td",{className:"px-6 py-4",children:(p=e.status,N.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${{pending:"bg-yellow-600",approved:"bg-green-600",rejected:"bg-red-600",cancelled:"bg-gray-600",completed:"bg-blue-600"}[p]||"bg-gray-600"}`,children:{pending:"قيد الانتظار",approved:"موافق عليها",rejected:"مرفوضة",cancelled:"ملغاة",completed:"مكتملة"}[p]||p}))})]},e.id);var p}):N.jsx("tr",{children:N.jsx("td",{colSpan:6,className:"text-center p-8",children:"لا توجد حجوزات."})})})]})})]})]}):N.jsxs("div",{className:"text-center p-8",children:[N.jsx("p",{className:"text-xl text-slate-300 mb-6",children:"لم يتم العثور على الطبيب"}),N.jsxs("button",{onClick:()=>n("/doctors"),className:"inline-flex items-center gap-2 px-6 py-3 bg-cyan-600 hover:bg-cyan-700 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-cyan-500/20",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"العودة إلى قائمة الأطباء"]})]})},Fe=()=>{var e,t,a,l,n,i,o,c;const d=r(),{toasts:m,removeToast:x,success:u,error:h,warning:p}=Pe(),[g,v]=s.useState(null),[j,f]=s.useState(!1),[b,y]=s.useState(""),[w,k]=s.useState(!1),[C,_]=s.useState(!1),[L,M]=s.useState(null),[z,S]=s.useState(1),[A,E]=s.useState({data:[],loading:!0,totalPages:1,total:0}),[P,B]=s.useState(""),[$,W]=s.useState(""),[R,T]=s.useState({active:!1,loading:!1,data:[],total:0,error:""}),[V,H]=s.useState(0),I=s.useRef(null),F=s.useRef(null),O=s.useRef(null),q=s.useCallback(async(e,s,t)=>{const a=(e=>{const s=new URLSearchParams;return Object.entries(e).forEach(([e,t])=>{null!=t&&""!==t&&s.append(e,String(t))}),s.toString()})({page:e,per_page:s});return(e=>{var s,t,a,l,r,n;let i=[null==e?void 0:e.hospitals,null==e?void 0:e.data,e].find(e=>null!=e);i&&"object"==typeof i&&"hospitals"in i&&(i=i.hospitals);let o=[];Array.isArray(null==i?void 0:i.data)?o=i.data:Array.isArray(i)?o=i:Array.isArray(null==(s=null==e?void 0:e.hospitals)?void 0:s.data)?o=e.hospitals.data:Array.isArray(null==(t=null==e?void 0:e.data)?void 0:t.data)?o=e.data.data:Array.isArray(null==e?void 0:e.data)?o=e.data:Array.isArray(e)&&(o=e);const c=(null==i?void 0:i.current_page)??(null==e?void 0:e.current_page)??(null==(a=null==e?void 0:e.data)?void 0:a.current_page)??1,d=(null==i?void 0:i.last_page)??(null==e?void 0:e.last_page)??(null==(l=null==e?void 0:e.data)?void 0:l.last_page)??c,m=(null==i?void 0:i.total)??(null==e?void 0:e.total)??(null==(r=null==e?void 0:e.data)?void 0:r.total)??o.length,x=(null==i?void 0:i.per_page)??(null==e?void 0:e.per_page)??(null==(n=null==e?void 0:e.data)?void 0:n.per_page)??o.length;return{items:o,currentPage:Number(c)||1,lastPage:Number(d)||1,total:Number(m)||o.length,perPage:Number(x)||o.length}})(await D.get(`/admin/hospital/all?${a}`,{signal:t}))},[]),U=s.useCallback(async e=>{if(I.current)return I.current;if(F.current)return F.current;const s=(async()=>{Ve(e);const s=[],{items:t,lastPage:a,total:l,perPage:r}=await q(1,200,e);s.push(...t);const n=r||200,i=l||s.length,o=n>0?Math.ceil(i/n):1,c=Math.max(a||1,o||1);if(c>1){const t=Array.from({length:c-1},(e,s)=>s+2);(await Te(t,4,async s=>{Ve(e);const{items:t}=await q(s,200,e);return t})).forEach(e=>{s.push(...e)})}return I.current=s,s})();F.current=s;try{const e=await s;return F.current=null,e}catch(t){throw F.current=null,(null==e?void 0:e.aborted)||(I.current=null),t}},[q,V]),G=s.useCallback(()=>{I.current=null,F.current=null,H(e=>e+1)},[]);s.useEffect(()=>{const e=setTimeout(()=>{W(P.trim())},350);return()=>clearTimeout(e)},[P]),s.useEffect(()=>{if($){O.current&&O.current.abort();const e=new AbortController;return O.current=e,T({active:!0,loading:!0,data:[],total:0,error:""}),U(e.signal).then(s=>{if(e.signal.aborted)return;const t=s.filter(e=>((e,s)=>{var t,a;const l=s.trim().toLowerCase();return!l||[e.full_name,null==(t=e.account)?void 0:t.email,null==(a=e.account)?void 0:a.phone_number,e.address].filter(e=>!!e).some(e=>e.toLowerCase().includes(l))})(e,$));T({active:!0,loading:!1,data:t,total:t.length,error:""})}).catch(()=>{e.signal.aborted||T({active:!0,loading:!1,data:[],total:0,error:"تعذر تحميل البيانات. يرجى المحاولة مرة أخرى."})}).finally(()=>{O.current===e&&(O.current=null)}),()=>e.abort()}O.current&&(O.current.abort(),O.current=null),T({active:!1,loading:!1,data:[],total:0,error:""})},[$,U,V]),s.useEffect(()=>{if($||I.current||F.current)return;const e=new AbortController,s=window.setTimeout(()=>{U(e.signal).catch(()=>{e.abort()})},800);return()=>{e.abort(),window.clearTimeout(s)}},[$,U]),s.useEffect(()=>{if($)return;const e=new AbortController;return E(e=>({...e,loading:!0})),q(z,25,e.signal).then(({items:s,lastPage:t,total:a})=>{e.signal.aborted||E({data:s,loading:!1,totalPages:t,total:a})}).catch(()=>{e.signal.aborted||E(e=>({...e,loading:!1}))}),()=>e.abort()},[$,z,q]);const J=e=>{R.active||e>=1&&e<=A.totalPages&&(S(e),window.scrollTo({top:0,behavior:"smooth"}))},K=async()=>{if(b.trim()){k(!0);try{const e=new FormData;e.append("hospital_name",b);const s=await D.post("/admin/create-hospital-account",e);if(!s)throw new Error("لم يتم استلام رد من الخادم");M(s),u("تم إنشاء حساب المشفى بنجاح"),y(""),f(!1),_(!0),G(),S(1)}catch(e){let s=(null==e?void 0:e.message)||"حدث خطأ غير متوقع";"Validation failed"===(null==e?void 0:e.message)||s.includes("Validation failed")?s="اسم المشفى موجود مسبقاً أو البيانات غير صحيحة":s.includes("already been taken")&&(s="اسم المشفى موجود مسبقاً، يرجى استخدام اسم آخر"),h(s)}finally{k(!1)}}else p("يرجى إدخال اسم المشفى")},Y=e=>{navigator.clipboard.writeText(e).then(()=>{u("تم نسخ الرمز بنجاح")}).catch(()=>{h("فشل نسخ الرمز")})},Z=[{header:"اسم المشفى",accessor:e=>e.full_name||"غير محدد",sortable:!0,className:"font-medium text-white"},{header:"البريد الإلكتروني",accessor:e=>{var s;return(null==(s=e.account)?void 0:s.email)||"-"}},{header:"رقم الهاتف",accessor:e=>{var s;return(null==(s=e.account)?void 0:s.phone_number)||"-"}},{header:"العنوان",accessor:e=>N.jsx("div",{className:"max-w-xs truncate",title:e.address||"غير محدد",children:e.address||"-"})},{header:"التقييم",accessor:e=>N.jsx("div",{className:"flex items-center gap-2",children:void 0!==e.avg_rating&&null!==e.avg_rating?N.jsxs(N.Fragment,{children:[N.jsx("span",{className:"text-yellow-400 font-semibold",children:e.avg_rating.toFixed(1)}),N.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),void 0!==e.ratings_count&&null!==e.ratings_count&&N.jsxs("span",{className:"text-slate-400 text-xs",children:["(",e.ratings_count,")"]})]}):N.jsx("span",{className:"text-slate-500 text-sm",children:"-"})})},{header:"الإجراءات",accessor:e=>N.jsx(Q,{size:"sm",variant:"primary",onClick:s=>{s.stopPropagation(),v(e)},icon:N.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),children:"عرض التفاصيل"})}],ee=R.active?R.total:A.total,se=R.active?R.data:A.data,te=R.active?R.loading:A.loading,ae=R.active?R.loading?"جاري البحث في المشافي...":R.error||"لم يتم العثور على نتائج مطابقة.":"لا توجد مشافي مسجلة",le=R.active?Math.max(se.length,1):25;return N.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[N.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[N.jsxs("div",{className:"flex-1",children:[N.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة المشافي"}),N.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع المشافي المسجلة في النظام"})]}),N.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[N.jsx(Ae,{variant:"info",size:"lg",children:te?"...":`${ee} مشفى`}),N.jsxs(Q,{variant:"primary",size:"md",icon:N.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),onClick:()=>f(!0),children:[N.jsx("span",{className:"hidden sm:inline",children:"إضافة مشفى"}),N.jsx("span",{className:"sm:hidden",children:"إضافة"})]})]})]}),N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[N.jsx(X,{value:P,onChange:e=>B(e.target.value),placeholder:"ابحث في جميع المشافي بالاسم، البريد، الهاتف...",icon:N.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),$&&N.jsxs("div",{className:"mt-2 text-sm text-slate-400 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[R.loading?N.jsxs("span",{className:"flex items-center gap-2",children:[N.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري تحميل جميع المشافي لضمان دقة النتائج..."]}):N.jsx("span",{children:R.total>0?`تم العثور على ${R.total} مشفى مطابق`:"لم يتم العثور على نتائج مطابقة"}),R.error&&N.jsx("span",{className:"text-red-400",children:R.error})]})]}),N.jsx(Se,{data:se,columns:Z,loading:te,searchable:!1,emptyMessage:ae,itemsPerPage:le,onRowClick:e=>d(`/hospitals/${e.id}`)},R.active?"search-results":`page-${z}`),!R.active&&A.totalPages>1&&N.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[N.jsxs("div",{className:"text-sm text-slate-400",children:["الصفحة ",z," من ",A.totalPages," (",A.total," مشفى إجمالاً)"]}),N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>J(1),disabled:1===z||A.loading,children:"الأولى"}),N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>J(z-1),disabled:1===z||A.loading,icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"السابقة"}),N.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,A.totalPages)},(e,s)=>{let t;return t=A.totalPages<=5||z<=3?s+1:z>=A.totalPages-2?A.totalPages-4+s:z-2+s,N.jsx(Q,{variant:z===t?"primary":"secondary",size:"sm",onClick:()=>J(t),disabled:A.loading,className:"min-w-[40px]",children:t},t)})}),N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>J(z+1),disabled:z===A.totalPages||A.loading,icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),children:"التالية"}),N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>J(A.totalPages),disabled:z===A.totalPages||A.loading,children:"الأخيرة"})]})]}),N.jsx(Ee,{isOpen:j,onClose:()=>{f(!1),y("")},title:"إنشاء حساب مشفى جديد",footer:N.jsxs("div",{className:"flex gap-3 justify-end",children:[N.jsx(Q,{variant:"secondary",onClick:()=>f(!1),children:"إلغاء"}),N.jsx(Q,{variant:"primary",onClick:K,isLoading:w,children:"إنشاء المشفى"})]}),children:N.jsx(X,{label:"اسم المشفى",value:b,onChange:e=>y(e.target.value),onKeyPress:e=>{"Enter"!==e.key||w||K()},placeholder:"أدخل اسم المشفى",disabled:w,icon:N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})})}),N.jsx(Ee,{isOpen:C,onClose:()=>{_(!1),M(null)},title:"✅ تم إنشاء حساب المشفى بنجاح",footer:N.jsx("div",{className:"flex gap-3 justify-end",children:N.jsx(Q,{variant:"primary",onClick:()=>{_(!1),M(null)},children:"تم"})}),children:N.jsxs("div",{className:"space-y-4",children:[N.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:N.jsx("p",{className:"text-slate-300 text-center mb-2",children:"تم إنشاء حساب المشفى بنجاح. يمكن للمشفى تسجيل الدخول باستخدام الرمز الفريد التالي:"})}),L&&N.jsxs(N.Fragment,{children:[((null==(e=L.hospital)?void 0:e.full_name)||L.full_name)&&N.jsxs("div",{className:"space-y-2",children:[N.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"اسم المشفى"}),N.jsx("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3",children:N.jsx("p",{className:"text-white font-medium text-center",children:(null==(t=L.hospital)?void 0:t.full_name)||L.full_name})})]}),((null==(a=L.account)?void 0:a.email)||L.email)&&N.jsxs("div",{className:"space-y-2",children:[N.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"البريد الإلكتروني"}),N.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3 flex items-center justify-between",children:[N.jsx("p",{className:"text-white font-mono",children:(null==(l=L.account)?void 0:l.email)||L.email}),N.jsx("button",{onClick:()=>{var e;return Y((null==(e=L.account)?void 0:e.email)||L.email)},className:"px-3 py-1 bg-cyan-600 hover:bg-cyan-700 rounded-md text-sm transition-colors",children:"نسخ"})]})]}),(L.unique_code||L.code||L.password)&&N.jsxs("div",{className:"space-y-2",children:[N.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"الرمز الفريد / كلمة المرور"}),N.jsxs("div",{className:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 border-2 border-cyan-500/50 rounded-lg p-4 flex items-center justify-between",children:[N.jsx("p",{className:"text-white font-mono text-lg font-bold",children:L.unique_code||L.code||L.password}),N.jsxs("button",{onClick:()=>Y(L.unique_code||L.code||L.password),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-md font-medium transition-colors flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"نسخ"]})]})]}),((null==(n=L.account)?void 0:n.phone_number)||L.phone_number)&&N.jsxs("div",{className:"space-y-2",children:[N.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"رقم الهاتف"}),N.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3 flex items-center justify-between",children:[N.jsx("p",{className:"text-white font-mono",children:(null==(i=L.account)?void 0:i.phone_number)||L.phone_number}),N.jsx("button",{onClick:()=>{var e;return Y((null==(e=L.account)?void 0:e.phone_number)||L.phone_number)},className:"px-3 py-1 bg-cyan-600 hover:bg-cyan-700 rounded-md text-sm transition-colors",children:"نسخ"})]})]}),N.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mt-4",children:N.jsxs("div",{className:"flex items-start gap-3",children:[N.jsx("svg",{className:"w-6 h-6 text-yellow-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),N.jsxs("p",{className:"text-yellow-200 text-sm",children:[N.jsx("strong",{children:"تنبيه مهم:"})," يرجى حفظ الرمز الفريد وإرساله للمشفى. لن تتمكن من رؤيته مرة أخرى!"]})]})})]}),L&&!L.unique_code&&!L.code&&!L.password&&N.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4 mt-4",children:[N.jsx("p",{className:"text-slate-400 text-sm mb-2",children:"معلومات المشفى المُنشأ:"}),N.jsx("pre",{className:"text-xs text-slate-300 overflow-auto max-h-60",children:JSON.stringify(L,null,2)})]})]})}),N.jsx(Ee,{isOpen:!!g,onClose:()=>v(null),title:"تفاصيل المشفى",size:"lg",children:g&&N.jsxs("div",{className:"space-y-6",children:[N.jsx("div",{className:"bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-xl p-4 sm:p-6 border border-purple-500/30",children:N.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 sm:gap-6",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full bg-gradient-to-br from-purple-500 to-pink-600 flex items-center justify-center border-4 border-purple-400 shadow-lg shadow-purple-500/50",children:N.jsx("svg",{className:"w-12 h-12 sm:w-16 sm:h-16 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})})}),N.jsx("div",{className:"flex-1 text-center sm:text-right space-y-2",children:N.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white",children:g.full_name||"غير محدد"})})]})}),N.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[N.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"المعلومات الأساسية"]}),N.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[N.jsx(Oe,{label:"اسم المشفى",value:g.full_name||"غير متوفر"}),N.jsx(Oe,{label:"البريد الإلكتروني",value:(null==(o=g.account)?void 0:o.email)||"غير متوفر"}),N.jsx(Oe,{label:"رقم الهاتف",value:(null==(c=g.account)?void 0:c.phone_number)||"غير متوفر"}),N.jsx(Oe,{label:"العنوان",value:g.address||"غير متوفر"}),void 0!==g.avg_rating&&null!==g.avg_rating&&N.jsx(Oe,{label:"التقييم",value:N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("span",{className:"text-yellow-400 font-semibold",children:g.avg_rating.toFixed(1)}),N.jsx("svg",{className:"w-5 h-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),g.ratings_count&&N.jsxs("span",{className:"text-slate-400 text-sm",children:["(",g.ratings_count," تقييم)"]})]})}),g.created_at&&N.jsx(Oe,{label:"تاريخ التسجيل",value:new Date(g.created_at).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"})})]})]}),g.services_2&&g.services_2.length>0&&N.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[N.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"الخدمات"]}),N.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:g.services_2.map(e=>N.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3 border border-slate-600",children:[N.jsx("div",{className:"font-semibold text-white mb-1",children:e.service_name}),N.jsxs("div",{className:"text-sm text-slate-400",children:["السعر: ",e.pivot.price," ل.س | السعة: ",e.pivot.capacity]})]},e.id))})]}),g.work_schedule&&g.work_schedule.length>0&&N.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[N.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"الجدول الزمني"]}),N.jsx("div",{className:"space-y-2",children:g.work_schedule.map(e=>N.jsx("div",{className:"flex items-center justify-between bg-slate-700/50 rounded-lg p-3",children:N.jsx("span",{className:"font-medium text-white",children:{sunday:"الأحد",monday:"الإثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت"}[e.day_of_week]})},e.id))})]})]})}),m.map((e,s)=>N.jsx(Be,{message:e.message,type:e.type,duration:e.duration,offset:s,onClose:()=>x(e.id)},e.id))]})},Oe=({label:e,value:s})=>N.jsxs("div",{className:"space-y-1",children:[N.jsx("p",{className:"text-xs sm:text-sm text-slate-400 font-medium",children:e}),N.jsx("p",{className:"text-sm sm:text-base text-white font-semibold",children:s||N.jsx("span",{className:"text-slate-500",children:"غير متوفر"})})]}),qe=()=>{var e,t;const{id:a}=i(),l=r(),[n,o]=s.useState(null),[c,d]=s.useState([]),[m,x]=s.useState(!0),[u,h]=s.useState(!0),[p,g]=s.useState(""),[v,j]=s.useState(""),[f,b]=s.useState(""),[y,w]=s.useState({pending:0,confirmed:0,cancelled:0,total:0});s.useEffect(()=>{k()},[a]),s.useEffect(()=>{a&&C()},[a,p,v,f]);const k=async()=>{x(!0);try{const e=await D.get(`/admin/hospital/${a}`);o(e.hospital||e)}catch(e){}finally{x(!1)}},C=async()=>{h(!0);try{const e=new URLSearchParams;p&&e.append("status",p),v&&e.append("from",v),f&&e.append("to",f);const s=await D.get(`/admin/hospital/${a}/reservations?${e.toString()}`),t=s.data||s.reservations||s;d(Array.isArray(t)?t:[]),_(t)}catch(e){d([])}finally{h(!1)}},_=e=>{const s={pending:0,confirmed:0,cancelled:0,total:e.length};e.forEach(e=>{e.status in s&&s[e.status]++}),w(s)};return m?N.jsx("div",{className:"flex justify-center items-center h-64",children:N.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-400"})}):n?N.jsxs("div",{className:"space-y-6",children:[N.jsx("div",{className:"flex items-center justify-between",children:N.jsxs("div",{className:"flex items-center gap-4",children:[N.jsxs("button",{onClick:()=>l("/hospitals"),className:"flex items-center gap-2 px-4 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-cyan-500 rounded-lg transition-all duration-200 group",children:[N.jsx("svg",{className:"w-5 h-5 text-cyan-400 group-hover:text-cyan-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),N.jsx("span",{className:"text-slate-300 group-hover:text-white font-medium transition-colors",children:"رجوع"})]}),N.jsxs("h1",{className:"text-3xl font-bold text-slate-100",children:["تفاصيل المشفى - ",n.full_name]})]})}),N.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[N.jsxs("div",{className:"lg:col-span-2 bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[N.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"المعلومات الأساسية"}),N.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"اسم المشفى"}),N.jsx("p",{className:"text-white font-medium",children:n.full_name||"غير محدد"})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"البريد الإلكتروني"}),N.jsx("p",{className:"text-white font-medium",children:(null==(e=n.account)?void 0:e.email)||"غير محدد"})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"رقم الهاتف"}),N.jsx("p",{className:"text-white font-medium",children:(null==(t=n.account)?void 0:t.phone_number)||"غير محدد"})]}),N.jsxs("div",{className:"col-span-2",children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"العنوان"}),N.jsx("p",{className:"text-white font-medium",children:n.address||"غير محدد"})]})]})]}),N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[N.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"إحصائيات الحجوزات"}),N.jsxs("div",{className:"space-y-3",children:[N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-slate-400",children:"الإجمالي"}),N.jsx("span",{className:"text-2xl font-bold text-white",children:y.total})]}),N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-yellow-400",children:"قيد الانتظار"}),N.jsx("span",{className:"font-bold text-yellow-400",children:y.pending})]}),N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-green-400",children:"مؤكدة"}),N.jsx("span",{className:"font-bold text-green-400",children:y.confirmed})]}),N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx("span",{className:"text-gray-400",children:"ملغاة"}),N.jsx("span",{className:"font-bold text-gray-400",children:y.cancelled})]})]})]})]}),n.services_2&&n.services_2.length>0&&N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[N.jsxs("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:["الخدمات المتاحة (",n.services_2.length,")"]}),N.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.services_2.map(e=>N.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:[N.jsx("h3",{className:"text-white font-medium mb-2",children:e.service_name}),N.jsxs("div",{className:"flex justify-between items-center text-sm",children:[N.jsx("span",{className:"text-slate-400",children:"السعر:"}),N.jsxs("span",{className:"text-cyan-400 font-bold",children:[e.pivot.price," ل.س"]})]}),N.jsxs("div",{className:"flex justify-between items-center text-sm mt-1",children:[N.jsx("span",{className:"text-slate-400",children:"السعة:"}),N.jsxs("span",{className:"text-white",children:[e.pivot.capacity," شخص"]})]})]},e.id))})]}),n.work_schedule&&n.work_schedule.length>0&&N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[N.jsxs("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:["أيام العمل (",n.work_schedule.length," أيام)"]}),N.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.work_schedule.map(e=>{return N.jsx("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3 text-center",children:N.jsx("p",{className:"text-white font-medium",children:(s=e.day_of_week,{sunday:"الأحد",monday:"الاثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت"}[s]||s)})},e.id);var s})})]}),N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[N.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 space-y-4 md:space-y-0",children:[N.jsx("h2",{className:"text-xl font-bold text-cyan-400",children:"الحجوزات"}),N.jsxs("div",{className:"flex flex-wrap gap-2",children:[N.jsxs("select",{value:p,onChange:e=>g(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",children:[N.jsx("option",{value:"",children:"جميع الحالات"}),N.jsx("option",{value:"pending",children:"قيد الانتظار"}),N.jsx("option",{value:"confirmed",children:"مؤكدة"}),N.jsx("option",{value:"cancelled",children:"ملغاة"})]}),N.jsx("input",{type:"date",value:v,onChange:e=>j(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",placeholder:"من تاريخ"}),N.jsx("input",{type:"date",value:f,onChange:e=>b(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",placeholder:"إلى تاريخ"}),(p||v||f)&&N.jsx("button",{onClick:()=>{g(""),j(""),b("")},className:"px-3 py-2 bg-red-600 hover:bg-red-700 rounded-md text-sm",children:"إلغاء الفلاتر"})]})]}),N.jsx("div",{className:"overflow-x-auto",children:N.jsxs("table",{className:"w-full text-sm text-right text-slate-300",children:[N.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800",children:N.jsxs("tr",{children:[N.jsx("th",{scope:"col",className:"px-6 py-3",children:"#"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"المريض"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"الخدمة"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"من تاريخ"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"إلى تاريخ"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"السعر"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"الحالة"})]})}),N.jsx("tbody",{children:u?N.jsx("tr",{children:N.jsx("td",{colSpan:7,className:"text-center p-8",children:"جاري التحميل..."})}):c.length>0?c.map(e=>{var s,t,a,l,r,n,i,o,c,d,m,x,u,h;return N.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-800",children:[N.jsx("td",{className:"px-6 py-4",children:e.id}),N.jsx("td",{className:"px-6 py-4",children:N.jsxs("div",{children:[N.jsx("p",{className:"font-medium",children:(null==(s=e.user)?void 0:s.full_name)||`مريض #${e.user_id}`}),N.jsxs("p",{className:"text-xs text-slate-400",children:["📞 ",(null==(a=null==(t=e.user)?void 0:t.account)?void 0:a.phone_number)||(null==(l=e.user)?void 0:l.phone_number)||(null==(n=null==(r=e.user)?void 0:r.account)?void 0:n.phone)||(null==(i=e.user)?void 0:i.phone)||(null==(c=null==(o=e.user)?void 0:o.account)?void 0:c.mobile)||(null==(d=e.user)?void 0:d.mobile)||"غير متوفر"]})]})}),N.jsx("td",{className:"px-6 py-4",children:(null==(x=null==(m=e.hospital_service)?void 0:m.service)?void 0:x.service_name)||"-"}),N.jsx("td",{className:"px-6 py-4",children:e.start_date}),N.jsx("td",{className:"px-6 py-4",children:e.end_date}),N.jsx("td",{className:"px-6 py-4",children:N.jsxs("span",{className:"text-cyan-400 font-bold",children:[(null==(u=e.hospital_service)?void 0:u.price)||"-"," ل.س"]})}),N.jsx("td",{className:"px-6 py-4",children:(h=e.status,N.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${{pending:"bg-yellow-600",confirmed:"bg-green-600",cancelled:"bg-gray-600"}[h]||"bg-gray-600"}`,children:{pending:"قيد الانتظار",confirmed:"مؤكدة",cancelled:"ملغاة"}[h]||h}))})]},e.id)}):N.jsx("tr",{children:N.jsx("td",{colSpan:7,className:"text-center p-8",children:"لا توجد حجوزات."})})})]})})]})]}):N.jsxs("div",{className:"text-center p-8",children:[N.jsx("p",{className:"text-xl text-slate-300 mb-6",children:"لم يتم العثور على المشفى"}),N.jsxs("button",{onClick:()=>l("/hospitals"),className:"inline-flex items-center gap-2 px-6 py-3 bg-cyan-600 hover:bg-cyan-700 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-cyan-500/20",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"العودة إلى قائمة المشافي"]})]})},Ue=()=>{var e,t;const[a,l]=s.useState(null),n=r(),[i,o]=s.useState(1),[c,d]=s.useState({data:[],loading:!0,totalPages:1,total:0}),[m,x]=s.useState(""),[u,h]=s.useState(""),[p,g]=s.useState({active:!1,loading:!1,data:[],total:0,error:""}),[v,j]=s.useState({current:0,total:0}),f=s.useRef(null),b=s.useRef(null),y=s.useRef(null),w=s.useCallback(async(e,s,t)=>{const a=(e=>{const s=new URLSearchParams;return Object.entries(e).forEach(([e,t])=>{null!=t&&""!==t&&s.append(e,String(t))}),s.toString()})({page:e,per_page:s});return(e=>{var s,t,a,l,r,n;let i=[null==e?void 0:e.users,null==e?void 0:e.data,e].find(e=>null!=e);i&&"object"==typeof i&&"users"in i&&(i=i.users);let o=[];Array.isArray(null==i?void 0:i.data)?o=i.data:Array.isArray(i)?o=i:Array.isArray(null==(s=null==e?void 0:e.users)?void 0:s.data)?o=e.users.data:Array.isArray(null==(t=null==e?void 0:e.data)?void 0:t.data)?o=e.data.data:Array.isArray(null==e?void 0:e.data)?o=e.data:Array.isArray(e)&&(o=e);const c=(null==i?void 0:i.current_page)??(null==e?void 0:e.current_page)??(null==(a=null==e?void 0:e.data)?void 0:a.current_page)??1,d=(null==i?void 0:i.last_page)??(null==e?void 0:e.last_page)??(null==(l=null==e?void 0:e.data)?void 0:l.last_page)??c,m=(null==i?void 0:i.total)??(null==e?void 0:e.total)??(null==(r=null==e?void 0:e.data)?void 0:r.total)??o.length,x=(null==i?void 0:i.per_page)??(null==e?void 0:e.per_page)??(null==(n=null==e?void 0:e.data)?void 0:n.per_page)??o.length;return{items:o,currentPage:Number(c)||1,lastPage:Number(d)||1,total:Number(m)||o.length,perPage:Number(x)||o.length}})(await D.get(`/admin/user/all?${a}`,{signal:t}))},[]),k=s.useCallback(async e=>{const s=null==e?void 0:e.signal,t=null==e?void 0:e.onProgress;if(f.current)return null==t||t(f.current.length?1:0,1),f.current;if(b.current)return b.current;const a=(async()=>{Ve(s);const e=[],{items:a,lastPage:l,total:r,perPage:n}=await w(1,200,s);e.push(...a);const i=n||200,o=r||e.length,c=i>0?Math.ceil(o/i):1,d=Math.max(l||1,c||1);if(null==t||t(Math.min(1,d),d),d>1){const a=Array.from({length:d-1},(e,s)=>s+2);let l=1;(await Te(a,4,async e=>{Ve(s);const{items:a}=await w(e,200,s);return l+=1,null==t||t(Math.min(l,d),d),a})).forEach(s=>{e.push(...s)})}return f.current=e,e})();b.current=a;try{const e=await a;return b.current=null,e}catch(l){throw b.current=null,(null==s?void 0:s.aborted)||(f.current=null),l}},[w]);s.useEffect(()=>{const e=setTimeout(()=>{h(m.trim())},350);return()=>clearTimeout(e)},[m]),s.useEffect(()=>{if(u){y.current&&y.current.abort();const e=new AbortController;y.current=e,g({active:!0,loading:!0,data:[],total:0,error:""}),j({current:0,total:0});const s=(s,t)=>{e.signal.aborted||j({current:s,total:t})};return k({signal:e.signal,onProgress:s}).then(s=>{if(e.signal.aborted)return;const t=s.filter(e=>((e,s)=>{var t,a;const l=s.trim().toLowerCase();return!l||[e.full_name,null==(t=e.account)?void 0:t.email,null==(a=e.account)?void 0:a.phone_number,e.age?String(e.age):void 0].filter(e=>!!e).some(e=>e.toLowerCase().includes(l))})(e,u));g({active:!0,loading:!1,data:t,total:t.length,error:""})}).catch(()=>{e.signal.aborted||g({active:!0,loading:!1,data:[],total:0,error:"تعذر تحميل البيانات. يرجى المحاولة مرة أخرى."})}).finally(()=>{y.current===e&&(y.current=null)}),()=>e.abort()}y.current&&(y.current.abort(),y.current=null),g({active:!1,loading:!1,data:[],total:0,error:""}),j({current:0,total:0})},[u,k]),s.useEffect(()=>{if(u)return;const e=new AbortController;return d(e=>({...e,loading:!0})),w(i,100,e.signal).then(({items:s,lastPage:t,total:a})=>{e.signal.aborted||d({data:s,loading:!1,totalPages:t,total:a})}).catch(()=>{e.signal.aborted||d(e=>({...e,loading:!1}))}),()=>e.abort()},[u,i,w]),s.useEffect(()=>{if(u||f.current||b.current)return;const e=new AbortController,s=window.setTimeout(()=>{k({signal:e.signal}).catch(()=>{e.abort()})},800);return()=>{e.abort(),window.clearTimeout(s)}},[u,k]);const C=e=>{p.active||e>=1&&e<=c.totalPages&&(o(e),window.scrollTo({top:0,behavior:"smooth"}))},_=p.active?p.total:c.total,L=p.active?p.data:c.data,M=p.active?p.loading:c.loading,z=p.active?p.loading?"جاري البحث في المستخدمين...":p.error||"لم يتم العثور على نتائج مطابقة.":"لا يوجد مستخدمون مسجلون",S=p.active?Math.max(L.length,1):100,A=[{header:"الاسم الكامل",accessor:"full_name",sortable:!0,className:"font-medium text-white"},{header:"البريد الإلكتروني",accessor:e=>{var s;return(null==(s=e.account)?void 0:s.email)||"-"}},{header:"رقم الهاتف",accessor:e=>{var s;return(null==(s=e.account)?void 0:s.phone_number)||"-"}},{header:"العمر",accessor:"age",sortable:!0},{header:"الجنس",accessor:e=>N.jsx(Ae,{variant:"male"===e.gender?"info":"success",size:"sm",children:"male"===e.gender?"ذكر":"female"===e.gender?"أنثى":"-"})},{header:"الإجراءات",accessor:e=>N.jsxs("div",{className:"flex flex-wrap gap-2",children:[N.jsx(Q,{size:"sm",variant:"primary",onClick:s=>{s.stopPropagation(),l(e)},children:"عرض الملخص"}),N.jsx(Q,{size:"sm",variant:"secondary",onClick:s=>{s.stopPropagation(),n(`/users/${e.id}`,{state:{user:e}})},children:"الحجوزات"})]})}];return N.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[N.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة المستخدمين"}),N.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع المستخدمين المسجلين في النظام"})]}),N.jsx("div",{className:"flex items-center gap-2",children:N.jsx(Ae,{variant:"info",size:"lg",children:M?"...":`${_} مستخدم`})})]}),N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[N.jsx(X,{value:m,onChange:e=>x(e.target.value),placeholder:"ابحث في جميع المستخدمين بالاسم، البريد، الهاتف، العمر...",icon:N.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),u&&N.jsxs("div",{className:"mt-2 text-sm text-slate-400",children:[p.loading?N.jsxs("div",{className:"space-y-2",children:[N.jsxs("span",{className:"flex items-center gap-2",children:[N.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري البحث في جميع الصفحات..."]}),v.total>0&&N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("div",{className:"flex-1 bg-slate-700 rounded-full h-2 overflow-hidden",children:N.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 h-full transition-all duration-300",style:{width:v.current/v.total*100+"%"}})}),N.jsxs("span",{className:"text-xs text-slate-500 min-w-[80px] text-right",children:[v.current," / ",v.total]})]})]}):N.jsxs("span",{className:"flex items-center gap-2",children:[N.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),p.total>0?`تم العثور على ${p.total} نتيجة مطابقة`:"لم يتم العثور على نتائج مطابقة"]}),p.error&&N.jsx("span",{className:"mt-1 text-sm text-red-400 block",children:p.error})]})]}),N.jsx(Se,{data:L,columns:A,loading:M,searchable:!1,emptyMessage:z,itemsPerPage:S,onRowClick:l},p.active?"search-results":`page-${i}`),!p.active&&c.totalPages>1&&N.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[N.jsxs("div",{className:"text-sm text-slate-400",children:["الصفحة ",i," من ",c.totalPages," (",c.total," مستخدم إجمالاً)"]}),N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>C(1),disabled:1===i||c.loading,children:"الأولى"}),N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>C(i-1),disabled:1===i||c.loading,icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"السابقة"}),N.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,c.totalPages)},(e,s)=>{let t;return t=c.totalPages<=5||i<=3?s+1:i>=c.totalPages-2?c.totalPages-4+s:i-2+s,N.jsx(Q,{variant:i===t?"primary":"secondary",size:"sm",onClick:()=>C(t),disabled:c.loading,className:"min-w-[40px]",children:t},t)})}),N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>C(i+1),disabled:i===c.totalPages||c.loading,icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),children:"التالية"}),N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>C(c.totalPages),disabled:i===c.totalPages||c.loading,children:"الأخيرة"})]})]}),N.jsx(Ee,{isOpen:!!a,onClose:()=>l(null),title:"تفاصيل المستخدم",footer:N.jsxs("div",{className:"flex flex-wrap gap-2",children:[N.jsx(Q,{variant:"primary",onClick:()=>{a&&n(`/users/${a.id}`,{state:{user:a}})},children:"فتح صفحة الحجوزات"}),N.jsx(Q,{variant:"secondary",onClick:()=>l(null),children:"إغلاق"})]}),children:a&&N.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[N.jsxs("div",{className:"space-y-1",children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"الاسم الكامل"}),N.jsx("p",{className:"text-white font-medium text-lg",children:a.full_name||"-"})]}),N.jsxs("div",{className:"space-y-1",children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"العمر"}),N.jsxs("p",{className:"text-white font-medium text-lg",children:[a.age||"-"," سنة"]})]}),N.jsxs("div",{className:"space-y-1",children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"الجنس"}),N.jsx(Ae,{variant:"male"===a.gender?"info":"success",children:"male"===a.gender?"ذكر":"أنثى"})]}),N.jsxs("div",{className:"space-y-1",children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"معرف المستخدم"}),N.jsxs("p",{className:"text-white font-medium text-lg",children:["#",a.id]})]}),N.jsxs("div",{className:"space-y-1 col-span-2",children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"البريد الإلكتروني"}),N.jsx("p",{className:"text-white font-medium text-lg",children:(null==(e=a.account)?void 0:e.email)||"-"})]}),N.jsxs("div",{className:"space-y-1 col-span-2",children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"رقم الهاتف"}),N.jsx("p",{className:"text-white font-medium text-lg direction-ltr text-right",children:(null==(t=a.account)?void 0:t.phone_number)||"-"})]})]})})]})},Ge=[{value:"",label:"كل الحالات"},{value:"pending",label:"قيد الانتظار"},{value:"approved",label:"موافق عليها"},{value:"rejected",label:"مرفوضة"},{value:"cancelled",label:"ملغاة"},{value:"completed",label:"مكتملة"}],Je={doctor:{label:"حجوزات الأطباء",statuses:{pending:{label:"قيد الانتظار",color:"bg-amber-500/20 text-amber-300"},approved:{label:"موافق عليها",color:"bg-emerald-500/20 text-emerald-300"},rejected:{label:"مرفوضة",color:"bg-rose-500/20 text-rose-300"},cancelled:{label:"ملغاة",color:"bg-slate-500/30 text-slate-200"},completed:{label:"مكتملة",color:"bg-sky-500/20 text-sky-300"}}},hospital:{label:"حجوزات المشافي",statuses:{pending:{label:"قيد الانتظار",color:"bg-amber-500/20 text-amber-300"},confirmed:{label:"مؤكدة",color:"bg-emerald-500/20 text-emerald-300"},cancelled:{label:"ملغاة",color:"bg-slate-500/30 text-slate-200"}}},nurse:{label:"حجوزات الممرضين",statuses:{pending:{label:"قيد الانتظار",color:"bg-amber-500/20 text-amber-300"},approved:{label:"موافق عليها",color:"bg-emerald-500/20 text-emerald-300"},rejected:{label:"مرفوضة",color:"bg-rose-500/20 text-rose-300"},cancelled:{label:"ملغاة",color:"bg-slate-500/30 text-slate-200"},completed:{label:"مكتملة",color:"bg-sky-500/20 text-sky-300"}}}},Ke=e=>Array.isArray(e)?e:Array.isArray(null==e?void 0:e.data)?e.data:[],Ye=e=>{if(!e)return"-";const s=e.includes("T")?e:e.replace(" ","T"),t=new Date(s);return Number.isNaN(t.getTime())?e:t.toLocaleString("ar-EG",{dateStyle:"medium",timeStyle:"short"})},Ze=e=>{if(!e)return"-";const s=e.includes("T")?e:`${e}T00:00:00`,t=new Date(s);return Number.isNaN(t.getTime())?e:t.toLocaleDateString("ar-EG")},Xe=()=>{var e,t,a;const{id:l}=i(),n=r(),c=(null==(e=o().state)?void 0:e.user)??null,[d,m]=s.useState(c),[x,u]=s.useState(!c),[h,p]=s.useState([]),[g,v]=s.useState([]),[j,f]=s.useState([]),[b,y]=s.useState(!0),[w,k]=s.useState(""),[C,_]=s.useState("doctor"),[L,M]=s.useState(""),[z,S]=s.useState(""),[A,E]=s.useState("");s.useEffect(()=>{if(l)return c&&c.id===Number(l)?(m(c),void u(!1)):void P(l)},[l]),s.useEffect(()=>{l&&B(l)},[l,L,z,A]);const P=async e=>{u(!0);try{let s=null;try{const t=await D.get(`/admin/user/${e}`),a=(null==t?void 0:t.user)||(null==t?void 0:t.data)||t;(null==a?void 0:a.id)&&(s=a)}catch{}if(!s){const t=(e=>{var s,t,a,l,r;if(!e)return[];if((null==e?void 0:e.user)&&e.user.id)return[e.user];const n=[null==(s=null==e?void 0:e.users)?void 0:s.data,null==e?void 0:e.users,null==(a=null==(t=null==e?void 0:e.data)?void 0:t.users)?void 0:a.data,null==(l=null==e?void 0:e.data)?void 0:l.users,null==(r=null==e?void 0:e.data)?void 0:r.data,null==e?void 0:e.data,e];for(const i of n)if(Array.isArray(i))return i;return[]})(await D.get("/admin/user/all?per_page=1000"));s=t.find(s=>s.id===Number(e))??null}m(s)}catch{m(null)}finally{u(!1)}},B=async e=>{var s,t,a;y(!0),k("");try{const l=new URLSearchParams;L&&l.append("status",L),z&&l.append("from",z),A&&l.append("to",A);const r=l.toString(),n=r?`/admin/user/${e}/reservations?${r}`:`/admin/user/${e}/reservations`,i=await D.get(n),o=(null==i?void 0:i.data)||i;p(Ke((null==o?void 0:o.doctor_reservations)||(null==(s=null==o?void 0:o.data)?void 0:s.doctor_reservations))),v(Ke((null==o?void 0:o.hospital_reservations)||(null==(t=null==o?void 0:o.data)?void 0:t.hospital_reservations))),f(Ke((null==o?void 0:o.nurse_reservations)||(null==(a=null==o?void 0:o.data)?void 0:a.nurse_reservations)))}catch(l){p([]),v([]),f([]),k((null==l?void 0:l.message)||"فشل تحميل الحجوزات")}finally{y(!1)}},$=s.useMemo(()=>{switch(C){case"hospital":return g;case"nurse":return j;default:return h}},[C,h,g,j]),W=s.useMemo(()=>{const e=Je[C],s=Object.keys(e.statuses).reduce((e,s)=>(e[s]=0,e),{});return $.forEach(e=>{const t=e.status;t in s&&(s[t]+=1)}),s},[$,C]);return l?x?N.jsx("div",{className:"flex justify-center items-center h-80",children:N.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-400"})}):d?N.jsxs("div",{className:"space-y-6",children:[N.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[N.jsxs("div",{className:"flex items-center gap-3",children:[N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>n("/users"),icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"رجوع"}),N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white",children:d.full_name||"مستخدم غير معروف"}),N.jsxs("p",{className:"text-slate-400 text-sm",children:["#",d.id]})]})]}),N.jsxs("div",{className:"flex gap-2",children:[N.jsx(Ae,{variant:"info",children:(null==(t=d.account)?void 0:t.email)||"لا يوجد بريد"}),N.jsx(Ae,{variant:"secondary",children:(null==(a=d.account)?void 0:a.phone_number)||"-"})]})]}),N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:[N.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-2",children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"الاسم الكامل"}),N.jsx("p",{className:"text-white font-semibold text-lg",children:d.full_name||"-"})]}),N.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-2",children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"العمر"}),N.jsx("p",{className:"text-white font-semibold text-lg",children:d.age?`${d.age} سنة`:"-"})]}),N.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-2",children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"الجنس"}),N.jsx(Ae,{variant:"male"===d.gender?"info":"success",children:"male"===d.gender?"ذكر":"أنثى"})]})]}),N.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-4",children:[N.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[N.jsxs("div",{children:[N.jsx("p",{className:"text-lg font-semibold text-white",children:"مرشحات الحجوزات"}),N.jsx("p",{className:"text-slate-400 text-sm",children:"يمكن تطبيق نفس المرشح على جميع أنواع الحجوزات"})]}),N.jsxs("div",{className:"flex flex-wrap gap-2",children:[N.jsx("select",{value:L,onChange:e=>M(e.target.value),className:"px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-white focus:outline-none focus:border-cyan-500",children:Ge.map(e=>N.jsx("option",{value:e.value,children:e.label},e.value))}),N.jsx("input",{type:"date",value:z,onChange:e=>S(e.target.value),className:"px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-white focus:outline-none focus:border-cyan-500"}),N.jsx("input",{type:"date",value:A,onChange:e=>E(e.target.value),className:"px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-white focus:outline-none focus:border-cyan-500"}),(L||z||A)&&N.jsx("button",{onClick:()=>{M(""),S(""),E("")},className:"px-3 py-2 text-sm rounded-lg border border-slate-600 text-slate-300 hover:border-cyan-400 hover:text-white transition-colors",children:"إعادة التعيين"})]})]}),w&&N.jsx("div",{className:"text-sm text-rose-400",children:w})]}),N.jsx("div",{className:"flex flex-wrap gap-3",children:["doctor","hospital","nurse"].map(e=>N.jsx("button",{onClick:()=>_(e),className:"px-4 py-2 rounded-xl border transition-all duration-200 "+(C===e?"bg-cyan-600/20 border-cyan-500 text-white shadow-cyan-500/20 shadow-lg":"bg-slate-800 border-slate-700 text-slate-300 hover:text-white"),children:N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("span",{children:Je[e].label}),N.jsx("span",{className:"text-xs text-slate-400",children:"doctor"===e?h.length:"hospital"===e?g.length:j.length})]})},e))}),N.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:Object.entries(Je[C].statuses).map(([e,s])=>N.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 text-center",children:[N.jsx("p",{className:"text-xs text-slate-400",children:s.label}),N.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:W[e]||0})]},e))}),N.jsx("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl overflow-x-auto",children:b?N.jsx("div",{className:"flex justify-center items-center py-16",children:N.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-cyan-400"})}):0===$.length?N.jsx("div",{className:"text-center py-12 text-slate-400",children:"لا توجد حجوزات مطابقة للمعايير الحالية."}):N.jsxs("table",{className:"w-full text-sm text-right text-slate-200",children:[N.jsxs("thead",{className:"bg-slate-900 text-xs uppercase text-slate-400",children:["doctor"===C&&N.jsxs("tr",{children:[N.jsx("th",{className:"px-4 py-3",children:"الخدمة"}),N.jsx("th",{className:"px-4 py-3",children:"السعر"}),N.jsx("th",{className:"px-4 py-3",children:"الحالة"}),N.jsx("th",{className:"px-4 py-3",children:"تاريخ الحجز"}),N.jsx("th",{className:"px-4 py-3",children:"الإنشاء"})]}),"hospital"===C&&N.jsxs("tr",{children:[N.jsx("th",{className:"px-4 py-3",children:"الخدمة"}),N.jsx("th",{className:"px-4 py-3",children:"الحالة"}),N.jsx("th",{className:"px-4 py-3",children:"تاريخ البداية"}),N.jsx("th",{className:"px-4 py-3",children:"تاريخ النهاية"}),N.jsx("th",{className:"px-4 py-3",children:"آخر تحديث"})]}),"nurse"===C&&N.jsxs("tr",{children:[N.jsx("th",{className:"px-4 py-3",children:"الخدمة"}),N.jsx("th",{className:"px-4 py-3",children:"نوع الحجز"}),N.jsx("th",{className:"px-4 py-3",children:"الموقع"}),N.jsx("th",{className:"px-4 py-3",children:"الحالة"}),N.jsx("th",{className:"px-4 py-3",children:"الفترة"})]})]}),N.jsxs("tbody",{className:"divide-y divide-slate-700",children:["doctor"===C&&$.map(e=>{var s,t;return N.jsxs("tr",{className:"hover:bg-slate-800/70",children:[N.jsxs("td",{className:"px-4 py-3",children:[N.jsx("p",{className:"font-semibold",children:(null==(s=e.doctor_service)?void 0:s.name)||"خدمة غير معروفة"}),N.jsxs("p",{className:"text-xs text-slate-400",children:["#",e.id]})]}),N.jsx("td",{className:"px-4 py-3",children:(null==(t=e.doctor_service)?void 0:t.price)?`${e.doctor_service.price} ل.س`:"-"}),N.jsx("td",{className:"px-4 py-3",children:N.jsx(Qe,{tab:C,status:e.status})}),N.jsxs("td",{className:"px-4 py-3",children:[N.jsx("p",{children:Ye(e.start_time)}),N.jsxs("p",{className:"text-xs text-slate-400",children:["حتى ",Ye(e.end_time)]})]}),N.jsx("td",{className:"px-4 py-3",children:Ye(e.created_at)})]},e.id)}),"hospital"===C&&$.map(e=>{var s,t;return N.jsxs("tr",{className:"hover:bg-slate-800/70",children:[N.jsxs("td",{className:"px-4 py-3",children:[N.jsx("p",{className:"font-semibold",children:(null==(t=null==(s=e.hospital_service)?void 0:s.service)?void 0:t.service_name)||"خدمة غير معروفة"}),N.jsxs("p",{className:"text-xs text-slate-400",children:["#",e.id]})]}),N.jsx("td",{className:"px-4 py-3",children:N.jsx(Qe,{tab:C,status:e.status})}),N.jsx("td",{className:"px-4 py-3",children:Ze(e.start_date)}),N.jsx("td",{className:"px-4 py-3",children:Ze(e.end_date)}),N.jsx("td",{className:"px-4 py-3",children:Ye(e.updated_at)})]},e.id)}),"nurse"===C&&$.map(e=>{var s,t,a;return N.jsxs("tr",{className:"hover:bg-slate-800/70",children:[N.jsxs("td",{className:"px-4 py-3",children:[N.jsx("p",{className:"font-semibold",children:(null==(s=e.nurse_service)?void 0:s.name)||"خدمة غير معروفة"}),N.jsxs("p",{className:"text-xs text-slate-400",children:["#",e.id]})]}),N.jsx("td",{className:"px-4 py-3 capitalize text-white",children:"manual"===e.reservation_type?"يدوي":"مباشر"}),N.jsx("td",{className:"px-4 py-3 text-slate-300",children:(null==(t=e.location)?void 0:t.lat)&&(null==(a=e.location)?void 0:a.lng)?`${e.location.lat}, ${e.location.lng}`:"-"}),N.jsx("td",{className:"px-4 py-3",children:N.jsx(Qe,{tab:C,status:e.status})}),N.jsxs("td",{className:"px-4 py-3",children:[N.jsx("p",{children:Ye(e.start_at)}),N.jsxs("p",{className:"text-xs text-slate-400",children:["حتى ",Ye(e.end_at)]})]})]},e.id)})]})]})})]}):N.jsxs("div",{className:"text-center py-20 space-y-4",children:[N.jsx("p",{className:"text-slate-300 text-xl",children:"لم يتم العثور على المستخدم"}),N.jsx(Q,{variant:"secondary",onClick:()=>n("/users"),children:"العودة لقائمة المستخدمين"})]}):N.jsx("div",{className:"text-center py-20 text-slate-400",children:"لا يوجد معرف مستخدم صالح."})},Qe=({tab:e,status:s})=>{const t=Je[e].statuses[s];return t?N.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.color}`,children:t.label}):N.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-slate-700 text-slate-300",children:s})},es=()=>{var e,t;r();const[a,l]=s.useState(null),[n,i]=s.useState(1),[o,c]=s.useState({data:[],loading:!0,totalPages:1,total:0}),[d,m]=s.useState(""),[x,u]=s.useState(""),[h,p]=s.useState({active:!1,loading:!1,data:[],total:0,error:""}),[g,v]=s.useState({current:0,total:0}),j=s.useRef(null),f=s.useRef(null),b=s.useRef(null),y=s.useCallback(async(e,s,t)=>{const a=(e=>{const s=new URLSearchParams;return Object.entries(e).forEach(([e,t])=>{null!=t&&""!==t&&s.append(e,String(t))}),s.toString()})({page:e,per_page:s});return(e=>{var s,t,a,l,r,n;let i=[null==e?void 0:e.nurses,null==e?void 0:e.data,e].find(e=>null!=e);i&&"object"==typeof i&&"nurses"in i&&(i=i.nurses);let o=[];Array.isArray(null==i?void 0:i.data)?o=i.data:Array.isArray(i)?o=i:Array.isArray(null==(s=null==e?void 0:e.nurses)?void 0:s.data)?o=e.nurses.data:Array.isArray(null==(t=null==e?void 0:e.data)?void 0:t.data)?o=e.data.data:Array.isArray(null==e?void 0:e.data)?o=e.data:Array.isArray(e)&&(o=e);const c=(null==i?void 0:i.current_page)??(null==e?void 0:e.current_page)??(null==(a=null==e?void 0:e.data)?void 0:a.current_page)??1,d=(null==i?void 0:i.last_page)??(null==e?void 0:e.last_page)??(null==(l=null==e?void 0:e.data)?void 0:l.last_page)??c,m=(null==i?void 0:i.total)??(null==e?void 0:e.total)??(null==(r=null==e?void 0:e.data)?void 0:r.total)??o.length,x=(null==i?void 0:i.per_page)??(null==e?void 0:e.per_page)??(null==(n=null==e?void 0:e.data)?void 0:n.per_page)??o.length;return{items:o,currentPage:Number(c)||1,lastPage:Number(d)||1,total:Number(m)||o.length,perPage:Number(x)||o.length}})(await D.get(`/admin/nurse/all?${a}`,{signal:t}))},[]),w=s.useCallback(async e=>{const s=null==e?void 0:e.signal,t=null==e?void 0:e.onProgress;if(j.current)return null==t||t(j.current.length?1:0,1),j.current;if(f.current)return f.current;const a=(async()=>{Ve(s);const e=[],{items:a,lastPage:l,total:r,perPage:n}=await y(1,200,s);e.push(...a);const i=n||200,o=r||e.length,c=i>0?Math.ceil(o/i):1,d=Math.max(l||1,c||1);if(null==t||t(Math.min(1,d),d),d>1){const a=Array.from({length:d-1},(e,s)=>s+2);let l=1;(await Te(a,4,async e=>{Ve(s);const{items:a}=await y(e,200,s);return l+=1,null==t||t(Math.min(l,d),d),a})).forEach(s=>{e.push(...s)})}return j.current=e,e})();f.current=a;try{const e=await a;return f.current=null,e}catch(l){throw f.current=null,(null==s?void 0:s.aborted)||(j.current=null),l}},[y]);s.useEffect(()=>{const e=setTimeout(()=>{u(d.trim())},350);return()=>clearTimeout(e)},[d]),s.useEffect(()=>{if(x){b.current&&b.current.abort();const e=new AbortController;b.current=e,p({active:!0,loading:!0,data:[],total:0,error:""}),v({current:0,total:0});const s=(s,t)=>{e.signal.aborted||v({current:s,total:t})};return w({signal:e.signal,onProgress:s}).then(s=>{if(e.signal.aborted)return;const t=s.filter(e=>((e,s)=>{var t,a;const l=s.trim().toLowerCase();return!l||[e.full_name,null==(t=e.account)?void 0:t.email,null==(a=e.account)?void 0:a.phone_number,e.graduation_type].filter(e=>!!e).some(e=>e.toLowerCase().includes(l))})(e,x));p({active:!0,loading:!1,data:t,total:t.length,error:""})}).catch(()=>{e.signal.aborted||p({active:!0,loading:!1,data:[],total:0,error:"تعذر تحميل البيانات. يرجى المحاولة مرة أخرى."})}).finally(()=>{b.current===e&&(b.current=null)}),()=>e.abort()}b.current&&(b.current.abort(),b.current=null),p({active:!1,loading:!1,data:[],total:0,error:""}),v({current:0,total:0})},[x,w]),s.useEffect(()=>{if(x)return;const e=new AbortController;return c(e=>({...e,loading:!0})),y(n,100,e.signal).then(({items:s,lastPage:t,total:a})=>{e.signal.aborted||c({data:s,loading:!1,totalPages:t,total:a})}).catch(()=>{e.signal.aborted||c(e=>({...e,loading:!1}))}),()=>e.abort()},[x,n,y]),s.useEffect(()=>{if(x||j.current||f.current)return;const e=new AbortController,s=window.setTimeout(()=>{w({signal:e.signal}).catch(()=>{e.abort()})},800);return()=>{e.abort(),window.clearTimeout(s)}},[x,w]);const k=e=>{h.active||e>=1&&e<=o.totalPages&&(i(e),window.scrollTo({top:0,behavior:"smooth"}))},C=h.active?h.total:o.total,_=h.active?h.data:o.data,L=h.active?h.loading:o.loading,M=h.active?h.loading?"جاري البحث في الممرضين...":h.error||"لم يتم العثور على نتائج مطابقة.":"لا يوجد ممرضون لعرضهم";return N.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[N.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة الممرضين"}),N.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع الممرضين المسجلين في النظام"})]}),N.jsx("div",{className:"flex items-center gap-2",children:N.jsx(Ae,{variant:"info",size:"lg",children:L?"...":`${C} ممرض/ة`})})]}),N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[N.jsx(X,{value:d,onChange:e=>m(e.target.value),placeholder:"ابحث في جميع الممرضين بالاسم، البريد، الهاتف، المؤهل...",icon:N.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),x&&N.jsxs("div",{className:"mt-2 text-sm text-slate-400",children:[h.loading?N.jsxs("div",{className:"space-y-2",children:[N.jsxs("span",{className:"flex items-center gap-2",children:[N.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري البحث في جميع الصفحات..."]}),g.total>0&&N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("div",{className:"flex-1 bg-slate-700 rounded-full h-2 overflow-hidden",children:N.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 h-full transition-all duration-300",style:{width:g.current/g.total*100+"%"}})}),N.jsxs("span",{className:"text-xs text-slate-500 min-w-[80px] text-right",children:[g.current," / ",g.total]})]})]}):N.jsxs("span",{className:"flex items-center gap-2",children:[N.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),h.total>0?`تم العثور على ${h.total} نتيجة مطابقة`:"لم يتم العثور على نتائج مطابقة"]}),h.error&&N.jsx("span",{className:"mt-1 text-sm text-red-400 block",children:h.error})]})]}),N.jsx("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl shadow-lg overflow-hidden",children:N.jsx("div",{className:"overflow-x-auto",children:N.jsxs("table",{className:"w-full text-sm text-right text-slate-300",children:[N.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800",children:N.jsxs("tr",{children:[N.jsx("th",{scope:"col",className:"px-6 py-3",children:"الاسم الكامل"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"البريد الإلكتروني"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"رقم الهاتف"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"المؤهل"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"التقييم"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"الحالة"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"الإجراءات"})]})}),N.jsx("tbody",{children:L?N.jsx("tr",{children:N.jsx("td",{colSpan:7,className:"text-center p-8",children:"جاري التحميل..."})}):_.length>0?_.map(e=>{var s,t;return N.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-800",children:[N.jsx("td",{className:"px-6 py-4 font-medium",children:e.full_name}),N.jsx("td",{className:"px-6 py-4",children:(null==(s=e.account)?void 0:s.email)||"-"}),N.jsx("td",{className:"px-6 py-4",children:(null==(t=e.account)?void 0:t.phone_number)||"-"}),N.jsx("td",{className:"px-6 py-4",children:e.graduation_type||"-"}),N.jsx("td",{className:"px-6 py-4",children:void 0!==e.avg_rating&&null!==e.avg_rating?N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("span",{className:"text-yellow-400 font-semibold",children:e.avg_rating.toFixed(1)}),N.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),void 0!==e.ratings_count&&null!==e.ratings_count&&N.jsxs("span",{className:"text-slate-400 text-xs",children:["(",e.ratings_count,")"]})]}):N.jsx("span",{className:"text-slate-500 text-sm",children:"-"})}),N.jsx("td",{className:"px-6 py-4",children:N.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+(e.is_active?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"),children:e.is_active?"نشط":"غير نشط"})}),N.jsx("td",{className:"px-6 py-4",children:N.jsxs("button",{onClick:()=>l(e),className:"px-3 py-1 text-xs bg-blue-600 hover:bg-blue-700 rounded-md transition-colors flex items-center gap-1",children:[N.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"عرض التفاصيل"]})})]},e.id)}):N.jsx("tr",{children:N.jsx("td",{colSpan:7,className:"text-center p-8",children:M})})})]})})}),!h.active&&o.totalPages>1&&N.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[N.jsxs("div",{className:"text-sm text-slate-400",children:["الصفحة ",n," من ",o.totalPages," (",o.total," ممرض/ة إجمالاً)"]}),N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>k(1),disabled:1===n||o.loading,children:"الأولى"}),N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>k(n-1),disabled:1===n||o.loading,icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"السابقة"}),N.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,o.totalPages)},(e,s)=>{let t;return t=o.totalPages<=5||n<=3?s+1:n>=o.totalPages-2?o.totalPages-4+s:n-2+s,N.jsx(Q,{variant:n===t?"primary":"secondary",size:"sm",onClick:()=>k(t),disabled:o.loading,className:"min-w-[40px]",children:t},t)})}),N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>k(n+1),disabled:n===o.totalPages||o.loading,icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),children:"التالية"}),N.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>k(o.totalPages),disabled:n===o.totalPages||o.loading,children:"الأخيرة"})]})]}),N.jsx(Ee,{isOpen:!!a,onClose:()=>l(null),title:"تفاصيل الممرض/ة",size:"lg",children:a&&N.jsxs("div",{className:"space-y-6",children:[N.jsx("div",{className:"bg-gradient-to-r from-emerald-500/10 to-green-500/10 rounded-xl p-4 sm:p-6 border border-emerald-500/30",children:N.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 sm:gap-6",children:[N.jsx("div",{className:"flex-shrink-0",children:N.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full bg-gradient-to-br from-emerald-500 to-green-600 flex items-center justify-center border-4 border-emerald-400 shadow-lg shadow-emerald-500/50",children:N.jsx("svg",{className:"w-12 h-12 sm:w-16 sm:h-16 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})}),N.jsxs("div",{className:"flex-1 text-center sm:text-right space-y-2",children:[N.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white",children:a.full_name}),N.jsx("div",{className:"flex items-center justify-center sm:justify-start gap-2",children:N.jsx(Ae,{variant:"success",size:"lg",children:N.jsxs("span",{className:"flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),a.graduation_type]})})})]})]})}),N.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[N.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"المعلومات الشخصية"]}),N.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[N.jsx(ss,{label:"الاسم الكامل",value:a.full_name}),N.jsx(ss,{label:"البريد الإلكتروني",value:(null==(e=a.account)?void 0:e.email)||"غير متوفر"}),N.jsx(ss,{label:"رقم الهاتف",value:(null==(t=a.account)?void 0:t.phone_number)||"غير متوفر"}),N.jsx(ss,{label:"العنوان",value:a.address||"غير متوفر"}),a.age&&N.jsx(ss,{label:"العمر",value:`${a.age} سنة`}),N.jsx(ss,{label:"الجنس",value:"male"===a.gender?"ذكر":"أنثى"})]})]}),N.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[N.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"المعلومات المهنية"]}),N.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[N.jsx(ss,{label:"نوع التخرج",value:N.jsx(Ae,{variant:"success",size:"md",children:a.graduation_type})}),N.jsx(ss,{label:"الحالة",value:N.jsx(Ae,{variant:a.is_active?"success":"danger",size:"md",children:a.is_active?"نشط":"غير نشط"})}),void 0!==a.avg_rating&&null!==a.avg_rating&&N.jsx(ss,{label:"التقييم",value:N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("span",{className:"text-yellow-400 font-semibold",children:a.avg_rating.toFixed(1)}),N.jsx("svg",{className:"w-5 h-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:N.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),a.ratings_count&&N.jsxs("span",{className:"text-slate-400 text-sm",children:["(",a.ratings_count," تقييم)"]})]})})]}),a.profile_description&&N.jsx("div",{className:"mt-4",children:N.jsx(ss,{label:"الوصف الشخصي",value:a.profile_description})})]})]})})]})},ss=({label:e,value:s})=>N.jsxs("div",{className:"space-y-1",children:[N.jsx("p",{className:"text-xs sm:text-sm text-slate-400 font-medium",children:e}),N.jsx("p",{className:"text-sm sm:text-base text-white font-semibold",children:s||N.jsx("span",{className:"text-slate-500",children:"غير متوفر"})})]}),ts=()=>{var e,t;const{id:a}=i(),l=r(),[n,o]=s.useState(null),[c,d]=s.useState(!0),[m,x]=s.useState([]),[u,h]=s.useState(!0),[p,g]=s.useState(""),[v,j]=s.useState(""),[f,b]=s.useState(""),[y,w]=s.useState({pending:0,approved:0,rejected:0,cancelled:0,completed:0,total:0});s.useEffect(()=>{k()},[a]),s.useEffect(()=>{a&&C()},[a,p,v,f]);const k=async()=>{d(!0);try{const e=await D.get(`/admin/nurse/${a}`);o(e.nurse||e)}catch(e){}finally{d(!1)}},C=async()=>{var e;h(!0);try{const s=new URLSearchParams;p&&s.append("status",p),v&&s.append("from",v),f&&s.append("to",f);const t=await D.get(`/admin/nurse/${a}/reservations?${s.toString()}`),l=(null==(e=t.data)?void 0:e.data)||t.data||t.reservations||t.nurse_reservations||t,r=Array.isArray(l)?l:Array.isArray(null==l?void 0:l.data)?l.data:[];x(r),_(r)}catch(s){x([]),w({pending:0,approved:0,rejected:0,cancelled:0,completed:0,total:0})}finally{h(!1)}},_=e=>{const s={pending:0,approved:0,rejected:0,cancelled:0,completed:0,total:e.length};e.forEach(e=>{e.status in s&&s[e.status]++}),w(s)},L=e=>{if(!e)return"-";return new Date(e.replace(" ","T")).toLocaleString("ar-EG",{dateStyle:"medium",timeStyle:"short"})};return c?N.jsx("div",{className:"flex justify-center items-center h-64",children:N.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-400"})}):n?N.jsxs("div",{className:"space-y-6",children:[N.jsx("div",{className:"flex items-center justify-between",children:N.jsxs("div",{className:"flex items-center gap-4",children:[N.jsxs("button",{onClick:()=>l("/nurses"),className:"flex items-center gap-2 px-4 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-cyan-500 rounded-lg transition-all duration-200 group",children:[N.jsx("svg",{className:"w-5 h-5 text-cyan-400 group-hover:text-cyan-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),N.jsx("span",{className:"text-slate-300 group-hover:text-white font-medium transition-colors",children:"رجوع"})]}),N.jsxs("h1",{className:"text-3xl font-bold text-slate-100",children:["تفاصيل الممرض - ",n.full_name]})]})}),N.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[N.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"المعلومات الأساسية"}),N.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"الاسم الكامل"}),N.jsx("p",{className:"text-white font-medium",children:n.full_name})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"البريد الإلكتروني"}),N.jsx("p",{className:"text-white font-medium",children:null==(e=n.account)?void 0:e.email})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"رقم الهاتف"}),N.jsx("p",{className:"text-white font-medium",children:null==(t=n.account)?void 0:t.phone_number})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"العمر"}),N.jsxs("p",{className:"text-white font-medium",children:[n.age," سنة"]})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"الجنس"}),N.jsx("p",{className:"text-white font-medium",children:"male"===n.gender?"ذكر":"أنثى"})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"نوع التخرج"}),N.jsx("p",{className:"text-white font-medium",children:n.graduation_type})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"الحالة"}),N.jsx("p",{className:"text-white font-medium",children:N.jsx("span",{className:"inline-block px-3 py-1 text-xs rounded-full "+(n.is_active?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"),children:n.is_active?"نشط":"غير نشط"})})]}),N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"العنوان"}),N.jsx("p",{className:"text-white font-medium",children:n.address})]}),n.profile_description&&N.jsxs("div",{children:[N.jsx("p",{className:"text-slate-400 text-sm",children:"الوصف"}),N.jsx("p",{className:"text-white font-medium",children:n.profile_description})]})]}),N.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-700",children:[N.jsx("h3",{className:"text-lg font-bold text-cyan-400 mb-4",children:"رخصة الممرضة"}),a&&N.jsx("div",{className:"flex items-center gap-4",children:N.jsxs("button",{onClick:async()=>{try{const e=await D.get(`/admin/nurse-license/${a}`,{skipAuth:!1});if(e instanceof Blob){const s=URL.createObjectURL(e);window.open(s,"_blank")}else e.url&&window.open(e.url,"_blank")}catch(e){alert("فشل تحميل صورة الرخصة: "+(e.message||"خطأ غير معروف"))}},className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-lg text-white font-medium transition-colors flex items-center gap-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"عرض الرخصة"]})})]})]}),N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6 flex flex-col",children:[N.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"الملف الشخصي"}),N.jsx("div",{className:"flex-1 flex items-center justify-center",children:N.jsxs("div",{className:"text-center",children:[N.jsx("div",{className:"w-48 h-48 mx-auto mb-4 rounded-full bg-slate-700 flex items-center justify-center",children:N.jsx("svg",{className:"w-24 h-24 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),N.jsx("p",{className:"text-slate-400 text-sm",children:"صورة الملف الشخصي"})]})})]})]}),N.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6 space-y-6",children:[N.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[N.jsxs("div",{children:[N.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-1",children:"حجوزات الممرض"}),N.jsx("p",{className:"text-slate-400 text-sm",children:"معاينة كل الطلبات المرتبطة بهذا الممرض"})]}),N.jsxs("div",{className:"flex flex-wrap gap-3",children:[N.jsxs("select",{value:p,onChange:e=>g(e.target.value),className:"bg-slate-900 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-cyan-500",children:[N.jsx("option",{value:"",children:"كل الحالات"}),N.jsx("option",{value:"pending",children:"قيد الانتظار"}),N.jsx("option",{value:"approved",children:"موافق عليها"}),N.jsx("option",{value:"rejected",children:"مرفوضة"}),N.jsx("option",{value:"cancelled",children:"ملغاة"}),N.jsx("option",{value:"completed",children:"مكتملة"})]}),N.jsx("input",{type:"date",value:v,onChange:e=>j(e.target.value),className:"bg-slate-900 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-cyan-500"}),N.jsx("input",{type:"date",value:f,onChange:e=>b(e.target.value),className:"bg-slate-900 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-cyan-500"}),(v||f||p)&&N.jsx("button",{onClick:()=>{g(""),j(""),b("")},className:"px-4 py-2 text-sm rounded-lg border border-slate-600 text-slate-300 hover:text-white hover:border-cyan-400 transition-colors",children:"إعادة تعيين"})]})]}),N.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[{label:"إجمالي",value:y.total,color:"text-slate-200"},{label:"قيد الانتظار",value:y.pending,color:"text-amber-300"},{label:"موافق عليها",value:y.approved,color:"text-emerald-300"},{label:"مرفوضة",value:y.rejected,color:"text-rose-300"},{label:"ملغاة",value:y.cancelled,color:"text-slate-400"},{label:"مكتملة",value:y.completed,color:"text-sky-300"}].map(e=>N.jsxs("div",{className:"bg-slate-900/60 border border-slate-700 rounded-lg p-3 text-center",children:[N.jsx("p",{className:"text-xs text-slate-400",children:e.label}),N.jsx("p",{className:`text-xl font-bold ${e.color}`,children:e.value})]},e.label))}),u?N.jsx("div",{className:"flex justify-center items-center py-12",children:N.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-cyan-400"})}):m.length>0?N.jsx("div",{className:"overflow-x-auto",children:N.jsxs("table",{className:"min-w-full divide-y divide-slate-700",children:[N.jsx("thead",{children:N.jsxs("tr",{className:"text-left text-xs uppercase tracking-wider text-slate-400",children:[N.jsx("th",{className:"px-4 py-3",children:"المستخدم"}),N.jsx("th",{className:"px-4 py-3",children:"الخدمة"}),N.jsx("th",{className:"px-4 py-3",children:"الحالة"}),N.jsx("th",{className:"px-4 py-3",children:"نوع الحجز"}),N.jsx("th",{className:"px-4 py-3",children:"الموقع"}),N.jsx("th",{className:"px-4 py-3",children:"بداية الحجز"}),N.jsx("th",{className:"px-4 py-3",children:"نهاية الحجز"})]})}),N.jsx("tbody",{className:"divide-y divide-slate-800 text-sm",children:m.map(e=>{var s,t,a,l,r,n,i,o,c,d;return N.jsxs("tr",{className:"hover:bg-slate-800/60 transition-colors",children:[N.jsxs("td",{className:"px-4 py-3",children:[N.jsx("p",{className:"text-white font-medium",children:(null==(s=e.user)?void 0:s.full_name)||"غير معروف"}),N.jsx("p",{className:"text-xs text-slate-400",children:(null==(a=null==(t=e.user)?void 0:t.account)?void 0:a.phone_number)||(null==(r=null==(l=e.user)?void 0:l.account)?void 0:r.email)||"-"})]}),N.jsxs("td",{className:"px-4 py-3",children:[N.jsx("p",{className:"text-white font-medium",children:(null==(n=e.nurse_service)?void 0:n.name)||"خدمة عامة"}),N.jsx("p",{className:"text-xs text-slate-400",children:(null==(i=e.nurse_service)?void 0:i.price)?`${e.nurse_service.price} ل.س`:""})]}),N.jsx("td",{className:"px-4 py-3",children:(d=e.status,N.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${{pending:"bg-yellow-600",approved:"bg-green-600",rejected:"bg-red-600",cancelled:"bg-gray-600",completed:"bg-blue-600"}[d]||"bg-slate-600"}`,children:{pending:"قيد الانتظار",approved:"موافق عليها",rejected:"مرفوضة",cancelled:"ملغاة",completed:"مكتملة"}[d]||d}))}),N.jsx("td",{className:"px-4 py-3 capitalize text-white",children:e.reservation_type}),N.jsx("td",{className:"px-4 py-3 text-slate-300",children:(null==(o=e.location)?void 0:o.lat)&&(null==(c=e.location)?void 0:c.lng)?`${e.location.lat}, ${e.location.lng}`:"-"}),N.jsx("td",{className:"px-4 py-3 text-slate-300",children:L(e.start_at)}),N.jsx("td",{className:"px-4 py-3 text-slate-300",children:L(e.end_at)})]},e.id)})})]})}):N.jsx("div",{className:"text-center py-12 text-slate-400",children:"لا توجد حجوزات مطابقة للمعايير الحالية."})]})]}):N.jsxs("div",{className:"text-center p-8",children:[N.jsx("p",{className:"text-xl text-slate-300 mb-6",children:"لم يتم العثور على الممرض"}),N.jsxs("button",{onClick:()=>l("/nurses"),className:"inline-flex items-center gap-2 px-6 py-3 bg-cyan-600 hover:bg-cyan-700 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-cyan-500/20",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"العودة إلى قائمة الممرضين"]})]})},as=e=>{if(!e)return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;let s=e.replace(/^\/+/,"").replace(/^storage\//,"");return s.includes("images/specializations")||(s=`images/specializations/${s}`),`https://sahtee.evra-co.com/storage/${s}`},ls=()=>{const[e,t]=s.useState([]),[a,l]=s.useState(!0),[r,n]=s.useState(!1),[i,o]=s.useState({}),[c,d]=s.useState(!1),{toasts:m,removeToast:x,success:u,error:h}=Pe(),p=async()=>{l(!0);try{const e=await D.get("/admin/specializations");t(e||[])}catch(e){h("فشل تحميل التخصصات")}finally{l(!1)}};s.useEffect(()=>{p()},[]);const g=e=>{o(e||{name_ar:"",name_en:""}),n(!0)},v=()=>{n(!1),o({})};return N.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[N.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[N.jsxs("div",{children:[N.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة التخصصات"}),N.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة تخصصات الأطباء في النظام"})]}),N.jsxs("div",{className:"flex items-center gap-3",children:[N.jsxs(Ae,{variant:"info",size:"lg",children:[e.length," تخصص"]}),N.jsxs(Q,{variant:"primary",onClick:()=>g(),icon:N.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),children:[N.jsx("span",{className:"hidden sm:inline",children:"إضافة تخصص"}),N.jsx("span",{className:"sm:hidden",children:"إضافة"})]})]})]}),a?N.jsx("div",{className:"flex justify-center py-20",children:N.jsx(ze,{text:"جاري تحميل التخصصات..."})}):e.length>0?N.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6",children:e.map(s=>N.jsxs(fe,{gradient:!0,hover:!0,className:"p-4 md:p-6 text-center group",children:[N.jsx("div",{className:"relative inline-block mb-4",children:as(s.image)?N.jsx("img",{src:as(s.image),alt:s.name_ar,className:"w-20 h-20 md:w-24 md:h-24 rounded-full mx-auto object-cover border-4 border-slate-700 group-hover:border-cyan-500 transition-all duration-300 group-hover:scale-110",onError:e=>{const t=e.currentTarget,a=t.src;if(s.image&&!a.includes("data:image")){if(a.includes("images/specializations"))return void(t.src=`https://sahtee.evra-co.com/storage/${s.image.replace(/^\/+/,"")}`);if(!a.includes("specializations/"))return void(t.src=`https://sahtee.evra-co.com/storage/specializations/${s.image.replace(/^\/+/,"")}`)}t.onerror=null,t.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2306b6d4"%3E%3Cpath d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/%3E%3C/svg%3E'}}):N.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-full mx-auto flex items-center justify-center bg-slate-700 border-4 border-slate-600",children:N.jsx("svg",{className:"w-10 h-10 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),N.jsx("h3",{className:"font-bold text-base md:text-lg text-white mb-1",children:s.name_ar}),N.jsx("p",{className:"text-slate-400 text-xs md:text-sm mb-4",children:s.name_en}),N.jsxs("div",{className:"flex justify-center gap-2",children:[N.jsx(Q,{size:"sm",variant:"ghost",onClick:()=>g(s),icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),children:"تعديل"}),N.jsx(Q,{size:"sm",variant:"danger",onClick:()=>(async s=>{if(window.confirm("هل أنت متأكد من رغبتك في حذف هذا التخصص؟"))try{await D.delete(`/admin/specializations/${s}`),t(e.filter(e=>e.id!==s)),u("تم حذف التخصص بنجاح")}catch(a){h(`فشل الحذف: ${a.message}`)}})(s.id),icon:N.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),children:"حذف"})]})]},s.id))}):N.jsx(Me,{icon:N.jsx("svg",{className:"w-16 h-16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),title:"لا توجد تخصصات",description:"ابدأ بإضافة تخصص جديد للأطباء",action:{label:"إضافة تخصص",onClick:()=>g()}}),r&&N.jsx(rs,{spec:i,onClose:v,onSave:async e=>{var s,t;d(!0);try{let s;i.id?(s=await D.post(`/admin/specializations/${i.id}`,e),u("تم تحديث التخصص بنجاح")):(s=await D.post("/admin/specializations",e),u("تم إضافة التخصص بنجاح")),await p(),v()}catch(a){h(`فشل الحفظ: ${(null==(t=null==(s=a.response)?void 0:s.data)?void 0:t.message)||a.message||"حدث خطأ غير متوقع"}`)}finally{d(!1)}},saving:c}),m.map((e,s)=>N.jsx(Be,{message:e.message,type:e.type,duration:e.duration,offset:s,onClose:()=>x(e.id)},e.id))]})},rs=({spec:e,onClose:t,onSave:a,saving:l})=>{const[r,n]=s.useState(e.name_ar||""),[i,o]=s.useState(e.name_en||""),[c,d]=s.useState(null),[m,x]=s.useState(null),{showToast:u}=Pe();s.useEffect(()=>{if(e.image){const s=as(e.image);s&&x(s)}},[e.image]);const h=async e=>{if(e.preventDefault(),!r.trim()||!i.trim())return void u.warning("الرجاء إدخال اسم التخصص بالعربية والإنجليزية");const s=new FormData;s.append("name_ar",r.trim()),s.append("name_en",i.trim()),c&&s.append("image",c),await a(s)};return N.jsx(Ee,{isOpen:!0,onClose:t,title:e.id?"تعديل التخصص":"إضافة تخصص جديد",size:"md",footer:N.jsxs("div",{className:"flex gap-3 justify-end",children:[N.jsx(Q,{variant:"secondary",onClick:t,disabled:l,children:"إلغاء"}),N.jsx(Q,{variant:"primary",onClick:h,isLoading:l,icon:!l&&N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),children:l?"جاري الحفظ...":"حفظ"})]}),children:N.jsxs("form",{onSubmit:h,className:"space-y-4",children:[m&&N.jsx("div",{className:"flex justify-center mb-4",children:N.jsx("div",{className:"relative",children:N.jsx("img",{src:m,alt:"Preview",className:"w-24 h-24 rounded-full object-cover border-4 border-cyan-500/30",onError:e=>{e.currentTarget.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2306b6d4"%3E%3Cpath d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/%3E%3C/svg%3E'}})})}),N.jsx(X,{label:"الاسم بالعربية",value:r,onChange:e=>n(e.target.value),placeholder:"مثال: جراحة عامة",required:!0,icon:N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),N.jsx(X,{label:"الاسم بالإنجليزية",value:i,onChange:e=>o(e.target.value),placeholder:"Example: General Surgery",required:!0,icon:N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),N.jsxs("div",{children:[N.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["صورة التخصص ",e.id&&"(اختياري للتحديث)",N.jsx("span",{className:"text-xs text-slate-400 block mt-1",children:"الصيغ المدعومة: JPG, PNG, GIF, WEBP, SVG (الحد الأقصى 5 ميجابايت)"})]}),N.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp,image/svg+xml",onChange:e=>{var s;const t=null==(s=e.target.files)?void 0:s[0];if(t){const s=5242880;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/svg+xml"].includes(t.type))return u.warning("يرجى اختيار صورة صالحة (JPG, PNG, GIF, WEBP, SVG)"),void(e.target.value="");if(t.size>s)return u.warning("حجم الصورة كبير جداً. الحد الأقصى 5 ميجابايت"),void(e.target.value="");d(t);const a=new FileReader;a.onloadend=()=>{x(a.result)},a.readAsDataURL(t)}},className:"w-full px-4 py-2.5 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent hover:border-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-cyan-500 file:text-white hover:file:bg-cyan-600 cursor-pointer",required:!e.id})]})]})})},ns=()=>{const[e,t]=s.useState([]),[a,l]=s.useState(!0),[r,n]=s.useState(!1),[i,o]=s.useState({}),[c,d]=s.useState(1),{toasts:m,removeToast:x,success:u,error:h,warning:p}=Pe(),[g,v]=s.useState(!1),[j,f]=s.useState([]),[b,y]=s.useState(!1),[w,k]=s.useState(""),C=async()=>{l(!0);try{const e=await D.get("/admin/service"),s=e.services||e.data||e;t(Array.isArray(s)?s:[])}catch(e){}finally{l(!1)}};s.useEffect(()=>{C()},[]);const _=e=>{o(e||{}),n(!0)},L=()=>{n(!1),o({})},M=Math.ceil(e.length/10),z=10*(c-1),S=z+10,A=e.slice(z,S),E=e=>{if(!e)return"-";const s=e.includes("T")?e:e.replace(" ","T"),t=new Date(s);return Number.isNaN(t.getTime())?e:t.toLocaleDateString("ar-EG")},P=async()=>{y(!0),k("");try{const e=await D.get("/admin/service/trashed"),s=Array.isArray(e)?e:Array.isArray(null==e?void 0:e.data)?e.data:[];f(s)}catch(e){k((null==e?void 0:e.message)||"فشل تحميل العناصر المحذوفة"),f([])}finally{y(!1)}};return N.jsxs("div",{children:[N.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between mb-6",children:[N.jsx("h1",{className:"text-3xl font-bold text-slate-100",children:"إدارة خدمات المشافي"}),N.jsxs("div",{className:"flex flex-wrap gap-3",children:[N.jsx("button",{onClick:async()=>{v(!0),await P()},className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-md text-white font-semibold transition-colors",children:"العناصر المحذوفة"}),N.jsx("button",{onClick:()=>_(),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-md text-white font-semibold transition-colors",children:"إضافة خدمة"})]})]}),N.jsx("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl shadow-lg overflow-hidden",children:N.jsx("div",{className:"overflow-x-auto",children:N.jsxs("table",{className:"w-full text-sm text-right text-slate-300",children:[N.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800",children:N.jsxs("tr",{children:[N.jsx("th",{scope:"col",className:"px-6 py-3",children:"#"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"اسم الخدمة"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"تاريخ الإنشاء"}),N.jsx("th",{scope:"col",className:"px-6 py-3",children:"الإجراءات"})]})}),N.jsx("tbody",{children:a?N.jsx("tr",{children:N.jsx("td",{colSpan:4,className:"text-center p-8",children:"جاري التحميل..."})}):e.length>0?A.map(e=>N.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-800",children:[N.jsx("td",{className:"px-6 py-4",children:e.id}),N.jsx("td",{className:"px-6 py-4 font-medium",children:e.service_name}),N.jsx("td",{className:"px-6 py-4",children:E(e.created_at??e.createdAt??e.updated_at??e.updatedAt??null)}),N.jsxs("td",{className:"px-6 py-4 flex space-x-2 space-x-reverse",children:[N.jsx("button",{onClick:()=>_(e),className:"px-3 py-1 text-xs bg-blue-600 hover:bg-blue-700 rounded-md",children:"تعديل"}),N.jsx("button",{onClick:()=>(async e=>{if(window.confirm("هل أنت متأكد من رغبتك في حذف هذه الخدمة؟"))try{await D.delete(`/admin/service/${e}`),u("تم حذف الخدمة بنجاح"),C()}catch(s){h(`فشل الحذف: ${(null==s?void 0:s.message)||"خطأ غير معروف"}`)}})(e.id),className:"px-3 py-1 text-xs bg-red-600 hover:bg-red-700 rounded-md",children:"حذف"})]})]},e.id)):N.jsx("tr",{children:N.jsx("td",{colSpan:4,className:"text-center p-8",children:"لا توجد خدمات لعرضها."})})})]})})}),!a&&e.length>0&&M>1&&N.jsxs("div",{className:"mt-6",children:[N.jsxs("div",{className:"text-center text-slate-400 text-sm mb-4",children:["عرض ",z+1," - ",Math.min(S,e.length)," من إجمالي ",e.length," خدمة"]}),N.jsxs("div",{className:"flex justify-center items-center gap-2",children:[N.jsx("button",{onClick:()=>{c<M&&d(c+1)},disabled:c===M,className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(c===M?"bg-slate-700/50 text-slate-500 cursor-not-allowed":"bg-slate-700 text-slate-200 hover:bg-slate-600 hover:shadow-lg"),children:"التالي ←"}),N.jsx("div",{className:"flex gap-1.5",children:(()=>{const e=[];if(M<=7)for(let s=1;s<=M;s++)e.push(s);else{e.push(1),c>3&&e.push("...");const s=Math.max(2,c-1),t=Math.min(M-1,c+1);for(let a=s;a<=t;a++)e.push(a);c<M-2&&e.push("..."),e.push(M)}return e})().map((e,s)=>"number"==typeof e?N.jsx("button",{onClick:()=>(e=>{d(e)})(e),className:"min-w-[40px] px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(c===e?"bg-cyan-600 text-white shadow-lg shadow-cyan-600/30 scale-105":"bg-slate-700 text-slate-200 hover:bg-slate-600 hover:shadow-md"),children:e},`page-${e}`):N.jsx("span",{className:"px-2 py-2 text-slate-500 text-sm flex items-center",children:e},`dots-${s}`))}),N.jsx("button",{onClick:()=>{c>1&&d(c-1)},disabled:1===c,className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(1===c?"bg-slate-700/50 text-slate-500 cursor-not-allowed":"bg-slate-700 text-slate-200 hover:bg-slate-600 hover:shadow-lg"),children:"→ السابق"})]})]}),r&&N.jsx(is,{service:i,onClose:L,onSave:async e=>{if(e.trim())try{if(i.id)await D.put(`/admin/service/${i.id}`,{service_name:e}),u("تم تحديث الخدمة بنجاح");else{const s=new FormData;s.append("service_name",e),await D.post("/admin/service",s),u("تم إضافة الخدمة بنجاح")}C(),L()}catch(s){h(`فشل الحفظ: ${(null==s?void 0:s.message)||"خطأ غير معروف"}`)}else p("يرجى إدخال اسم الخدمة.")}}),g&&N.jsx(os,{services:j,loading:b,error:w,onClose:()=>v(!1),onRefresh:P,onRestore:async e=>{try{await D.patch(`/admin/service/${e}`),u("تمت استعادة الخدمة بنجاح"),await C(),await P()}catch(s){h((null==s?void 0:s.message)||"فشل استعادة الخدمة")}},formatDate:E}),m.map((e,s)=>N.jsx(Be,{message:e.message,type:e.type,duration:e.duration,offset:s,onClose:()=>x(e.id)},e.id))]})},is=({service:e,onClose:t,onSave:a})=>{const[l,r]=s.useState(e.service_name||"");return N.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",onClick:t,children:N.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-xl p-6 w-full max-w-md",onClick:e=>e.stopPropagation(),children:[N.jsx("h2",{className:"text-xl font-bold mb-4",children:e.id?"تعديل الخدمة":"إضافة خدمة جديدة"}),N.jsxs("form",{onSubmit:e=>{e.preventDefault(),a(l)},children:[N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{className:"block mb-2",children:"اسم الخدمة"}),N.jsx("input",{type:"text",value:l,onChange:e=>r(e.target.value),required:!0,className:"w-full p-2 bg-slate-700 rounded-md border border-slate-600"})]}),N.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse mt-6",children:[N.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-md",children:"إلغاء"}),N.jsx("button",{type:"submit",className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-md",children:"حفظ"})]})]})]})})},os=({services:e,loading:s,error:t,onClose:a,onRefresh:l,onRestore:r,formatDate:n})=>N.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex justify-center items-center px-4",onClick:a,children:N.jsxs("div",{className:"bg-slate-900 rounded-2xl shadow-2xl border border-slate-700 w-full max-w-3xl max-h-[85vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[N.jsxs("div",{className:"flex items-center justify-between border-b border-slate-700 px-6 py-4",children:[N.jsxs("div",{children:[N.jsx("h2",{className:"text-xl font-bold text-white",children:"العناصر المحذوفة"}),N.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"يمكنك استعادة الخدمات المحذوفة خلال فترة السماح."})]}),N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("button",{onClick:l,className:"px-3 py-1.5 text-sm rounded-lg bg-slate-800 hover:bg-slate-700 text-white border border-slate-600 transition-colors",children:"تحديث"}),N.jsx("button",{onClick:a,className:"p-2 rounded-full hover:bg-slate-800 text-slate-400 hover:text-white transition-colors","aria-label":"إغلاق",children:N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]}),N.jsxs("div",{className:"p-6 overflow-y-auto max-h-[70vh] space-y-4",children:[t&&N.jsx("div",{className:"text-sm text-rose-400 bg-rose-500/10 border border-rose-500/30 rounded-lg px-4 py-2",children:t}),s?N.jsx("div",{className:"flex justify-center py-10",children:N.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-cyan-400"})}):0===e.length?N.jsx("div",{className:"text-center py-10 text-slate-400",children:"لا توجد عناصر محذوفة حالياً."}):N.jsx("div",{className:"space-y-3",children:e.map(e=>N.jsxs("div",{className:"border border-slate-700 rounded-xl p-4 flex flex-col md:flex-row md:items-center md:justify-between gap-4 bg-slate-900/60",children:[N.jsxs("div",{children:[N.jsx("p",{className:"text-white font-semibold",children:e.service_name}),N.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["معرف الخدمة #",e.id]}),N.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["حذف في: ",n(e.deleted_at)]})]}),N.jsx("div",{className:"flex gap-2 flex-wrap",children:N.jsx("button",{onClick:()=>r(e.id),className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 rounded-lg text-white text-sm font-semibold transition-colors",children:"استعادة"})})]},e.id))})]})]})}),cs={hospital:{endpoint:"/admin/hospital/all",key:"hospitals"},doctor:{endpoint:"/admin/doctor/all",key:"doctors"},nurse:{endpoint:"/admin/nurse/all",key:"nurses"}},ds=()=>{const[e,t]=s.useState("hospital"),[a,l]=s.useState([]),[r,n]=s.useState(""),[i,o]=s.useState(""),[c,d]=s.useState(!1),[m,x]=s.useState(!1),[u,h]=s.useState(""),[p,g]=s.useState(null);s.useEffect(()=>{o(""),g(null),h(""),v()},[e]),s.useEffect(()=>{if(!i)return g(null),void h("");j(i)},[i,e]);const v=async()=>{const s=cs[e];d(!0);try{const t=((e,s)=>{var t,a,l,r,n;return e?Array.isArray(null==(t=null==e?void 0:e[s])?void 0:t.data)?e[s].data:Array.isArray(null==e?void 0:e[s])?e[s]:Array.isArray(null==(l=null==(a=null==e?void 0:e.data)?void 0:a[s])?void 0:l.data)?e.data[s].data:Array.isArray(null==(r=null==e?void 0:e.data)?void 0:r[s])?e.data[s]:Array.isArray(null==(n=null==e?void 0:e.data)?void 0:n.data)?e.data.data:Array.isArray(null==e?void 0:e.data)?e.data:Array.isArray(e)?e:[]:[]})(await D.get(`${s.endpoint}?per_page=200`).catch(()=>null),s.key),a=t.filter(e=>null==e?void 0:e.id).map(s=>{var t,a,l,r;switch(e){case"doctor":return{id:s.id,name:s.full_name||"طبيب غير معروف",subtitle:(null==(t=s.specialization)?void 0:t.name_ar)||(null==(a=s.account)?void 0:a.email)};case"nurse":return{id:s.id,name:s.full_name||"ممرض/ة غير معروف",subtitle:s.graduation_type||(null==(l=s.account)?void 0:l.email)};default:return{id:s.id,name:s.full_name||"مشفى غير معروف",subtitle:(null==(r=s.account)?void 0:r.email)||s.address}}});l(a)}catch{l([])}finally{d(!1)}},j=async s=>{x(!0),h("");try{const a=await D.get(`/admin/entity-rates?id=${s}&entity=${e}`),l=(null==a?void 0:a.data)||a,r=(t=null==l?void 0:l.ratings,Array.isArray(t)?t:Array.isArray(null==t?void 0:t.data)?t.data:[]);g({avg:Number(null==l?void 0:l.avg_rating)||0,count:Number(null==l?void 0:l.ratings_count)||r.length,ratings:r})}catch(a){g(null),h((null==a?void 0:a.message)||"فشل تحميل بيانات التقييمات")}finally{x(!1)}var t},f=s.useMemo(()=>{const e=r.trim().toLowerCase();return e?a.filter(s=>{var t;return s.name.toLowerCase().includes(e)||(null==(t=s.subtitle)?void 0:t.toLowerCase().includes(e))}):a},[a,r]);return N.jsxs("div",{className:"space-y-6",children:[N.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[N.jsxs("div",{children:[N.jsx("h1",{className:"text-3xl font-bold text-white",children:"تقارير التقييمات"}),N.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"راقب رضا المستخدمين عن الأطباء، الممرضين والمشافي"})]}),p&&N.jsxs(Ae,{variant:"info",children:["متوسط ",p.avg.toFixed(1)," من ",p.count," تقييم"]})]}),N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[N.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-2",children:[N.jsx("label",{className:"text-sm text-slate-400",children:"نوع الكيان"}),N.jsxs("select",{value:e,onChange:e=>t(e.target.value),className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[N.jsx("option",{value:"hospital",children:"المشافي"}),N.jsx("option",{value:"doctor",children:"الأطباء"}),N.jsx("option",{value:"nurse",children:"الممرضون"})]})]}),N.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-2",children:[N.jsx("label",{className:"text-sm text-slate-400",children:"بحث بالاسم أو البريد"}),N.jsx("input",{type:"text",value:r,onChange:e=>n(e.target.value),placeholder:"اكتب للبحث...",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]}),N.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-3",children:[N.jsx("label",{className:"text-sm text-slate-400",children:"اختر الكيان المطلوب"}),c?N.jsx("div",{className:"flex justify-center py-6",children:N.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-cyan-400"})}):N.jsxs("select",{value:i,onChange:e=>o(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[N.jsxs("option",{value:"",children:["اختر من القائمة (",f.length,")"]}),f.map(e=>N.jsxs("option",{value:e.id,children:["#",e.id," - ",e.name," ",e.subtitle?`(${e.subtitle})`:""]},e.id))]})]}),i&&N.jsx("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-4",children:m?N.jsx("div",{className:"flex justify-center py-10",children:N.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-cyan-400"})}):u?N.jsx("div",{className:"text-center py-6 text-rose-400",children:u}):p?N.jsxs(N.Fragment,{children:[N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[N.jsxs("div",{className:"bg-slate-900/60 border border-slate-700 rounded-xl p-4 text-center",children:[N.jsx("p",{className:"text-sm text-slate-400",children:"متوسط التقييم"}),N.jsx("p",{className:"text-4xl font-bold text-white mt-2",children:p.avg.toFixed(1)}),N.jsx("p",{className:"text-xs text-slate-500",children:"من 5"})]}),N.jsxs("div",{className:"bg-slate-900/60 border border-slate-700 rounded-xl p-4 text-center",children:[N.jsx("p",{className:"text-sm text-slate-400",children:"عدد التقييمات"}),N.jsx("p",{className:"text-4xl font-bold text-white mt-2",children:p.count})]}),N.jsxs("div",{className:"bg-slate-900/60 border border-slate-700 rounded-xl p-4 text-center",children:[N.jsx("p",{className:"text-sm text-slate-400",children:"آخر تحديث"}),N.jsx("p",{className:"text-lg font-semibold text-white mt-2",children:(new Date).toLocaleDateString("ar-EG")})]})]}),0===p.ratings.length?N.jsx("div",{className:"text-center py-10 text-slate-400",children:"لا توجد تقييمات لهذا الكيان حتى الآن."}):N.jsx("div",{className:"overflow-x-auto",children:N.jsxs("table",{className:"w-full text-sm text-right text-slate-200",children:[N.jsx("thead",{className:"bg-slate-900 text-xs uppercase text-slate-400",children:N.jsxs("tr",{children:[N.jsx("th",{className:"px-4 py-3",children:"المستخدم"}),N.jsx("th",{className:"px-4 py-3",children:"التقييم"}),N.jsx("th",{className:"px-4 py-3",children:"المراجعة"}),N.jsx("th",{className:"px-4 py-3",children:"التاريخ"})]})}),N.jsx("tbody",{className:"divide-y divide-slate-700",children:p.ratings.map(e=>{var s;return N.jsxs("tr",{className:"hover:bg-slate-800/70",children:[N.jsxs("td",{className:"px-4 py-3",children:[N.jsx("p",{className:"font-semibold",children:(null==(s=e.user)?void 0:s.full_name)||`مستخدم #${e.user_id}`}),N.jsxs("p",{className:"text-xs text-slate-400",children:["#",e.id]})]}),N.jsx("td",{className:"px-4 py-3",children:N.jsxs(Ae,{variant:"warning",children:[e.rating.toFixed(1)," / 5"]})}),N.jsx("td",{className:"px-4 py-3 text-slate-300",children:e.review||"—"}),N.jsx("td",{className:"px-4 py-3 text-slate-400",children:new Date(e.created_at).toLocaleString("ar-EG")})]},e.id)})})]})})]}):N.jsx("div",{className:"text-center py-8 text-slate-400",children:"اختر كياناً لعرض بياناته."})})]})},ms=()=>{const{toasts:e,removeToast:t,success:a,error:l,warning:r}=Pe(),[n,i]=s.useState([]),[o,c]=s.useState(!0),[d,m]=s.useState(!1),[x,u]=s.useState(!1),[h,p]=s.useState(null),[g,v]=s.useState({name_ar:"",name_en:""}),[j,f]=s.useState(!1);s.useEffect(()=>{b()},[]);const b=async()=>{var e,s;c(!0);try{const e=await D.get("/admin/provinces"),s=Array.isArray(e)?e:e.data||[];i(s)}catch(t){if(404===(null==t?void 0:t.status)||(null==(e=null==t?void 0:t.message)?void 0:e.includes("404"))||(null==(s=null==t?void 0:t.message)?void 0:s.includes("Not Found")))return void i([]);l("فشل تحميل المحافظات: "+(t.message||"خطأ غير معروف"))}finally{c(!1)}},y=e=>{e?(u(!0),p(e.id),v({name_ar:e.name_ar||"",name_en:e.name_en||""})):(u(!1),p(null),v({name_ar:"",name_en:""})),m(!0)},w=()=>{m(!1),u(!1),p(null),v({name_ar:"",name_en:""})},k=[{header:"ID",accessor:e=>e.id,className:"font-mono text-slate-400"},{header:"الاسم بالعربية",accessor:e=>e.name_ar||"-",sortable:!0,className:"font-medium text-white"},{header:"الاسم بالإنجليزية",accessor:e=>e.name_en||"-",sortable:!0},{header:"الإجراءات",accessor:e=>N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx(Q,{size:"sm",variant:"secondary",onClick:s=>{s.stopPropagation(),y(e)},children:"تعديل"}),N.jsx(Q,{size:"sm",variant:"secondary",onClick:s=>{s.stopPropagation(),(async e=>{var s,t;if(confirm("هل أنت متأكد من حذف هذه المحافظة؟"))try{await D.delete(`/admin/provinces/${e}`),a("تم حذف المحافظة بنجاح"),b()}catch(r){404===(null==r?void 0:r.status)||(null==(s=null==r?void 0:r.message)?void 0:s.includes("404"))||(null==(t=null==r?void 0:r.message)?void 0:t.includes("Not Found"))?l("API المحافظات غير متوفر بعد. يرجى التواصل مع فريق الباك اند."):l("فشل حذف المحافظة: "+(r.message||"خطأ غير معروف"))}})(e.id)},className:"bg-red-600 hover:bg-red-700",children:"حذف"})]})}];return N.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[N.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[N.jsxs("div",{className:"flex-1",children:[N.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة المحافظات"}),N.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع المحافظات المسجلة في النظام"})]}),N.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[N.jsx(Ae,{variant:"info",size:"lg",children:o?"...":`${n.length} محافظة`}),N.jsxs(Q,{variant:"primary",size:"md",icon:N.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),onClick:()=>y(),children:[N.jsx("span",{className:"hidden sm:inline",children:"إضافة محافظة"}),N.jsx("span",{className:"sm:hidden",children:"إضافة"})]})]})]}),N.jsx(Se,{data:n,columns:k,loading:o,searchable:!1,emptyMessage:"لا توجد محافظات مسجلة",itemsPerPage:25}),N.jsx(Ee,{isOpen:d,onClose:w,title:x?"تعديل المحافظة":"إنشاء محافظة جديدة",footer:N.jsxs("div",{className:"flex gap-3 justify-end",children:[N.jsx(Q,{variant:"secondary",onClick:w,children:"إلغاء"}),N.jsx(Q,{variant:"primary",onClick:async()=>{var e,s;if(g.name_ar.trim()&&g.name_en.trim()){f(!0);try{x&&h?(await D.put(`/admin/provinces/${h}`,g),a("تم تحديث المحافظة بنجاح")):(await D.post("/admin/provinces",g),a("تم إنشاء المحافظة بنجاح")),w(),b()}catch(t){404===(null==t?void 0:t.status)||(null==(e=null==t?void 0:t.message)?void 0:e.includes("404"))||(null==(s=null==t?void 0:t.message)?void 0:s.includes("Not Found"))?l("API المحافظات غير متوفر بعد. يرجى التواصل مع فريق الباك اند."):l("فشل حفظ المحافظة: "+(t.message||"خطأ غير معروف"))}finally{f(!1)}}else r("يرجى إدخال اسم المحافظة بالعربية والإنجليزية")},isLoading:j,children:x?"تحديث":"إنشاء"})]}),children:N.jsxs("div",{className:"space-y-4",children:[N.jsx(X,{label:"الاسم بالعربية",value:g.name_ar,onChange:e=>v({...g,name_ar:e.target.value}),placeholder:"أدخل اسم المحافظة بالعربية",disabled:j}),N.jsx(X,{label:"الاسم بالإنجليزية",value:g.name_en,onChange:e=>v({...g,name_en:e.target.value}),placeholder:"Enter province name in English",disabled:j})]})}),e.map((e,s)=>N.jsx(Be,{message:e.message,type:e.type,duration:e.duration,offset:s,onClose:()=>t(e.id)},e.id))]})},xs=()=>N.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[N.jsx("h1",{className:"text-9xl font-extrabold text-cyan-400 tracking-widest",children:"404"}),N.jsx("div",{className:"bg-slate-700 px-2 text-sm rounded rotate-12 absolute",children:"الصفحة غير موجودة"}),N.jsx("p",{className:"mt-4 text-lg text-slate-300",children:"عذراً، الصفحة التي تبحث عنها غير موجودة."}),N.jsx(c,{to:"/",className:"mt-6 inline-block px-5 py-3 text-sm font-medium text-white bg-cyan-600 rounded-lg hover:bg-cyan-700 focus:outline-none focus:ring",children:"العودة إلى لوحة التحكم"})]}),us=()=>{const e=r();return N.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4",children:N.jsxs("div",{className:"max-w-md w-full text-center",children:[N.jsxs("div",{className:"bg-slate-800 rounded-lg p-8 shadow-xl border border-slate-700",children:[N.jsx("div",{className:"mb-6",children:N.jsx("div",{className:"mx-auto w-20 h-20 bg-red-500/10 rounded-full flex items-center justify-center",children:N.jsx("svg",{className:"w-10 h-10 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),N.jsx("h1",{className:"text-3xl font-bold text-white mb-4",children:"غير مصرح لك بالدخول"}),N.jsx("p",{className:"text-slate-300 mb-2",children:"عذراً، ليس لديك الصلاحيات الكافية للوصول إلى هذه الصفحة."}),N.jsx("p",{className:"text-slate-400 text-sm mb-8",children:"إذا كنت تعتقد أن هذا خطأ، يرجى التواصل مع المسؤول."}),N.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[N.jsx(Q,{onClick:()=>e(-1),variant:"secondary",className:"flex-1",children:"العودة للخلف"}),N.jsx(Q,{onClick:()=>e("/"),variant:"primary",className:"flex-1",children:"العودة للرئيسية"})]})]}),N.jsx("div",{className:"mt-6 text-slate-500 text-sm",children:N.jsx("p",{children:"رقم الخطأ: 403 - Forbidden"})})]})})},hs=()=>{const{sessionTimeRemaining:e,isAuthenticated:t}=K(),[a,l]=s.useState(!1);s.useEffect(()=>{l(!!(t&&e>0&&e<=300))},[e,t]);if(!a)return null;const r=Math.floor(e/60),n=e%60;return N.jsx(Ee,{isOpen:a,onClose:()=>l(!1),title:"تحذير انتهاء الجلسة",children:N.jsxs("div",{className:"space-y-4",children:[N.jsx("p",{className:"text-slate-300",children:"ستنتهي جلستك قريباً بسبب عدم النشاط."}),N.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:N.jsxs("p",{className:"text-yellow-400 text-center text-xl font-bold",children:["الوقت المتبقي: ",r,":",n.toString().padStart(2,"0")]})}),N.jsx("p",{className:"text-slate-400 text-sm",children:"هل تريد الاستمرار في العمل؟"}),N.jsx("div",{className:"flex gap-3",children:N.jsx(Q,{onClick:()=>{l(!1),document.dispatchEvent(new Event("mousedown"))},variant:"primary",className:"flex-1",children:"متابعة الجلسة"})})]})})},ps=()=>(s.useEffect(()=>{const e=e=>{e.blockedURI,e.violatedDirective,e.originalPolicy,e.sourceFile,e.lineno,e.colno},s=e=>{(e=>{if(e){if("string"==typeof e)return C(e);if(e instanceof Error)return C(e.message);try{return C(JSON.stringify(e))}catch{return}}})(e.reason)},t=e=>{C(e.message),e.filename,e.lineno,e.colno},a=e=>{"undefined"!=typeof window&&(e.origin===window.location.origin||(e.origin,e.data))};return window.addEventListener("securitypolicyviolation",e),window.addEventListener("unhandledrejection",s),window.addEventListener("error",t),window.addEventListener("message",a,!0),()=>{window.removeEventListener("securitypolicyviolation",e),window.removeEventListener("unhandledrejection",s),window.removeEventListener("error",t),window.removeEventListener("message",a,!0)}},[]),N.jsx(J,{children:N.jsxs(Z,{children:[N.jsx(gs,{}),N.jsx(hs,{})]})})),gs=()=>{const{isAuthenticated:e,loading:t}=K(),a=s.useMemo(()=>{const s=[{path:"/login",element:e?N.jsx(x,{to:"/",replace:!0}):N.jsx(ee,{})},{path:"/unauthorized",element:N.jsx(us,{})},{path:"/",element:e?N.jsx(je,{}):N.jsx(x,{to:"/login",replace:!0}),children:[{index:!0,element:N.jsx(Ne,{})},{path:"approvals",element:N.jsx($e,{})},{path:"doctors",element:N.jsx(He,{})},{path:"doctors/:id",element:N.jsx(De,{})},{path:"nurses",element:N.jsx(es,{})},{path:"nurses/:id",element:N.jsx(ts,{})},{path:"hospitals",element:N.jsx(Fe,{})},{path:"hospitals/:id",element:N.jsx(qe,{})},{path:"users",element:N.jsx(Ue,{})},{path:"users/:id",element:N.jsx(Xe,{})},{path:"specializations",element:N.jsx(ls,{})},{path:"hospital-services",element:N.jsx(ns,{})},{path:"entity-ratings",element:N.jsx(ds,{})},{path:"provinces",element:N.jsx(ms,{})},{path:"*",element:N.jsx(xs,{})}]}];return e||s.push({path:"*",element:N.jsx(x,{to:"/login",replace:!0})}),d(s,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0}})},[e]);return t?N.jsx("div",{className:"flex justify-center items-center h-screen bg-slate-900 text-white",children:N.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-cyan-400"})}):N.jsx(m,{router:a})},vs=document.getElementById("root");if(!vs)throw new Error("Could not find root element to mount to");w.createRoot(vs).render(N.jsx(a.StrictMode,{children:N.jsx(ps,{})}));
