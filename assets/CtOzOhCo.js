var e;import{r as t,a as s,R as a,N as r,u as l,O as n,b as i,c as o,L as c,d,e as m,f as x}from"./BefVZcvG.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var u={exports:{}},h={},p=t,g=Symbol.for("react.element"),v=Symbol.for("react.fragment"),j=Object.prototype.hasOwnProperty,f=p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,b={key:!0,ref:!0,__self:!0,__source:!0};function y(e,t,s){var a,r={},l=null,n=null;for(a in void 0!==s&&(l=""+s),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(n=t.ref),t)j.call(t,a)&&!b.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:g,type:e,key:l,ref:n,props:r,_owner:f.current}}h.Fragment=v,h.jsx=y,h.jsxs=y,u.exports=h;var w=u.exports,N={},k=s;N.createRoot=k.createRoot,N.hydrateRoot=k.hydrateRoot;const C=e=>e?e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"").trim():"",_=e=>{if(null==e)return e;if("string"==typeof e)return C(e);if(Array.isArray(e))return e.map(e=>_(e));if("object"==typeof e){const t={};return Object.entries(e).forEach(([e,s])=>{t[e]=_(s)}),t}return e};class L{constructor(e=100,t=6e4){this.requests=new Map,this.maxRequests=e,this.timeWindow=t}canMakeRequest(e){const t=Date.now(),s=(this.requests.get(e)||[]).filter(e=>t-e<this.timeWindow);return!(s.length>=this.maxRequests)&&(s.push(t),this.requests.set(e,s),!0)}reset(e){this.requests.delete(e)}getRemainingRequests(e){const t=Date.now(),s=(this.requests.get(e)||[]).filter(e=>t-e<this.timeWindow);return Math.max(0,this.maxRequests-s.length)}}const A=new L(100,6e4),S=new L(5,3e5),z=e=>{try{const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(t).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(s)}catch{return null}},M="sahtee_secure_",E=`${M}session_key`,$=new TextEncoder,P=new TextDecoder,W="undefined"!=typeof window&&!!(null==(e=window.crypto)?void 0:e.subtle),B=e=>{const t=new Uint8Array(e);let s="";return t.forEach(e=>{s+=String.fromCharCode(e)}),btoa(s)},T=e=>{const t=atob(e),s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s.buffer},R=async()=>{if(!W)return null;let e=sessionStorage.getItem(E);if(!e){const t=window.crypto.getRandomValues(new Uint8Array(32));e=B(t.buffer),sessionStorage.setItem(E,e)}const t=T(e);return window.crypto.subtle.importKey("raw",t,{name:"AES-GCM"},!1,["encrypt","decrypt"])},D={async setItem(e,t){if("string"!=typeof t)throw new Error("secureStorage expects string values only");const s=await(async e=>{if(!W)return e;const t=await R();if(!t)return e;const s=window.crypto.getRandomValues(new Uint8Array(12)),a=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:s},t,$.encode(e)),r=new Uint8Array(s.byteLength+a.byteLength);return r.set(s,0),r.set(new Uint8Array(a),s.byteLength),B(r.buffer)})(t);try{localStorage.setItem(`${M}${e}`,s)}catch{try{localStorage.setItem(`${M}${e}`,t)}catch{}}},async getItem(e){let t=null;try{t=localStorage.getItem(`${M}${e}`)}catch{return null}if(!t)return null;const s=await(async e=>{if(!W)return e;const t=await R();if(!t)return e;try{const s=new Uint8Array(T(e)),a=s.slice(0,12),r=s.slice(12),l=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:a},t,r);return P.decode(l)}catch{return null}})(t);return s??null},removeItem(e){try{localStorage.removeItem(`${M}${e}`)}catch{}},clearSecureNamespace(){try{Object.keys(localStorage).filter(e=>e.startsWith(M)).forEach(e=>{try{localStorage.removeItem(e)}catch{}})}catch{}},clearSessionKey(){try{sessionStorage.removeItem(E)}catch{}}},I="https://sahtee.evra-co.com/api",V="auth_token",H={isRefreshing:!1,refreshSubscribers:[],subscribeTokenRefresh(e){this.refreshSubscribers.push(e)},onTokenRefreshed(e){this.refreshSubscribers.forEach(t=>t(e)),this.refreshSubscribers=[]},async refreshToken(){try{const e=await D.getItem(V);if(!e)return null;const t=await fetch(`${I}/admin/refresh`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Token refresh failed");const s=await t.json();return s.access_token?(await D.setItem(V,s.access_token),s.access_token):null}catch(e){return D.removeItem(V),window.location.hash="#/login",null}},async request(e,t={}){var s;const{skipAuth:a=!1,skipRateLimit:r=!1,retryCount:l=0,...n}=t;if(!r&&!A.canMakeRequest("api"))throw new Error("Too many requests. Please try again later.");const i=`${I}${e}`;let o=null;if(a||(o=await D.getItem(V)),!a){if(!o)throw new Error("No authentication token found");if(!(e=>{if(!e)return!1;const t=e.split(".");if(3!==t.length)return!1;try{return t.forEach(e=>atob(e.replace(/-/g,"+").replace(/_/g,"/"))),!0}catch{return!1}})(o))throw D.removeItem(V),new Error("Invalid authentication token");if((e=>{const t=z(e);return t&&t.exp?Date.now()>=1e3*t.exp:(null==t||t.exp,!1)})(o)){const e=await this.refreshToken();if(!e)throw D.removeItem(V),new Error("Authentication token expired");o=e}}const c=new Headers(n.headers||{});o&&!a&&c.set("Authorization",`Bearer ${o}`),n.body instanceof FormData||c.has("Content-Type")||c.set("Content-Type","application/json"),c.has("Accept")||c.set("Accept","application/json");const d=null==(s=document.querySelector('meta[name="csrf-token"]'))?void 0:s.getAttribute("content");d&&c.set("X-CSRF-Token",d),t.provinceId&&c.set("Province-ID",String(t.provinceId));const m=new AbortController,x=setTimeout(()=>m.abort(),3e4),u={...n,headers:c,signal:m.signal,credentials:"same-origin"};try{const s=await fetch(i,u);clearTimeout(x);const r=s.headers.get("content-type")||"";if(e.includes("/license")||e.includes("/image")||e.includes("/file")){const e=await s.arrayBuffer(),t=new Uint8Array(e);if(!s.ok){try{const t=(new TextDecoder).decode(e);if(t.trim().startsWith("{")||t.trim().startsWith("[")){const e=JSON.parse(t),a=new Error(e.message||e.error||s.statusText||"An unknown error occurred");throw a.status=s.status,a}}catch(p){if(p.status)throw p}const t=new Error(s.statusText||"An unknown error occurred");throw t.status=s.status,t}const a=t.length>=4&&137===t[0]&&80===t[1]&&78===t[2]&&71===t[3],l=t.length>=3&&255===t[0]&&216===t[1]&&255===t[2];if(a||l||r.startsWith("image/")){return new Blob([e],{type:r||"image/png"})}return new Blob([e],{type:r||"application/octet-stream"})}if(r.startsWith("image/")||r.startsWith("application/pdf")||r.startsWith("application/octet-stream")){const e=await s.blob();if(!s.ok){try{const t=await e.text();if(t.trim().startsWith("{")||t.trim().startsWith("[")){const e=JSON.parse(t),a=e.message||e.error||s.statusText||"An unknown error occurred",r=new Error(a);throw r.status=s.status,r}}catch(p){}const t=s.statusText||"An unknown error occurred",a=new Error(t);throw a.status=s.status,a}return e}const l=await s.text();let n=!1;if(l.length>=4){const e=l.charCodeAt(0),t=l.charCodeAt(1);n=137===e&&"PNG"===l.substring(1,4)||255===e&&216===t}if(n&&!s.ok){const e=new Error("Image file not found or error occurred");throw e.status=s.status,e}let o={};if(l&&!n)try{o=JSON.parse(l)}catch(p){if(!s.ok){const e=new Error(s.statusText||"Invalid response format");throw e.status=s.status,e}o=l}if(401===s.status&&!a){if(this.isRefreshing)return new Promise(s=>{this.subscribeTokenRefresh(a=>{s(this.request(e,t))})});{this.isRefreshing=!0;const s=await this.refreshToken();if(this.isRefreshing=!1,s)return this.onTokenRefreshed(s),this.request(e,t)}}if(!s.ok){const e="object"==typeof o&&null!==o?o.message||o.error||s.statusText||"An unknown error occurred":s.statusText||"An unknown error occurred";403!==s.status||a?s.status>=500&&s.status:s.status;const t=new Error(e);throw t.status=s.status,t}return o}catch(g){if(clearTimeout(x),l<3&&("AbortError"===g.name||g.message.includes("network")||g.message.includes("fetch")))return await(h=1e3*(l+1),new Promise(e=>setTimeout(e,h))),this.request(e,{...t,retryCount:l+1});throw g.message,g}var h},get(e,t){return this.request(e,{...t,method:"GET",cache:"no-cache"})},post(e,t,s){if(t instanceof FormData){const a=new FormData;return t.forEach((e,t)=>{"string"==typeof e?a.append(t,C(e)):a.append(t,e)}),this.request(e,{...s,method:"POST",body:a})}const a=t?_(t):t;return this.request(e,{...s,method:"POST",body:void 0!==a?JSON.stringify(a):void 0})},put(e,t,s){const a=t?_(t):t;return this.request(e,{...s,method:"PUT",body:void 0!==a?JSON.stringify(a):void 0})},patch(e,t,s){const a=t?_(t):t;return this.request(e,{...s,method:"PATCH",body:void 0!==a?JSON.stringify(a):void 0})},delete(e,t){return this.request(e,{...t,method:"DELETE"})},async uploadFile(e,t,s){if(t.size>10485760)throw new Error("File size exceeds 10MB limit");if(!["image/jpeg","image/png","image/jpg","application/pdf"].includes(t.type))throw new Error("File type not allowed");const a=new FormData;return a.append("file",t),s&&Object.entries(s).forEach(([e,t])=>{a.append(e,C(t))}),this.post(e,a)},async getDoctorLicense(e){const t=`/admin/doctor/${e}/license`;try{return await this.request(t,{method:"GET",headers:{Accept:"image/jpeg,image/png,image/*"}})}catch(s){if(404===s.status)return null;throw s}},async getNurseLicense(e){const t=`/admin/nurse/${e}/license`;try{return await this.request(t,{method:"GET",headers:{Accept:"image/jpeg,image/png,image/*"}})}catch(s){if(404===s.status)return null;throw s}}},O=t.createContext(void 0),F=18e5,U="auth_token",q="sahtee_last_activity",G="csrf_token",J=({children:e})=>{const[s,a]=t.useState(null),[r,l]=t.useState(!0),[n,i]=t.useState(0),o=t.useRef(Date.now()),c=t.useRef(),d=t.useRef(),m=t.useCallback(()=>{o.current=Date.now(),localStorage.setItem(q,String(Date.now()))},[]),x=t.useCallback(async()=>{await g(),window.location.hash="#/login"},[]),u=t.useCallback(()=>{const e=Number(localStorage.getItem(q))||o.current;if(!((e,t=18e5)=>Date.now()-e<t)(e,F))return x(),!1;const t=Math.floor((F-(Date.now()-e))/1e3);return i(Math.max(0,t)),!0},[x]),h=t.useCallback(async()=>{const e=await D.getItem(U);if(!e)return;const t=(e=>{const t=z(e);if(!t||!t.exp)return 0;const s=1e3*t.exp-Date.now();return Math.max(0,Math.floor(s/1e3))})(e);if(t<600&&t>0)try{await H.refreshToken()}catch(s){}},[]);t.useEffect(()=>{if(!s)return;const e=["mousedown","keydown","scroll","touchstart","click"],t=()=>{m(),u()},a=()=>{"visible"===document.visibilityState&&(u(),h())};return e.forEach(e=>{document.addEventListener(e,t)}),document.addEventListener("visibilitychange",a),d.current=setInterval(()=>{u()||clearInterval(d.current)},6e4),c.current=setInterval(()=>{h()},3e5),()=>{e.forEach(e=>{document.removeEventListener(e,t)}),document.removeEventListener("visibilitychange",a),d.current&&clearInterval(d.current),c.current&&clearInterval(c.current)}},[s,m,u,h]),t.useEffect(()=>{window.self!==window.top&&(window.top.location=window.self.location)},[]),t.useEffect(()=>{const e=e=>{e.key===`${M}${U}`&&null===e.newValue&&x()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[x]),t.useEffect(()=>{if(!localStorage.getItem(G)){const e=(()=>{const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")})();localStorage.setItem(G,e);const t=document.createElement("meta");t.name="csrf-token",t.content=e,document.head.appendChild(t)}},[]),t.useEffect(()=>{(async()=>{if(await D.getItem(U))try{const e=await H.get("/admin/me");a(e),m(),e.id}catch(e){D.removeItem(U),a(null)}l(!1)})()},[m]);const p=async(e,t)=>{if(!(e=>/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e))(e))throw new Error("صيغة البريد الإلكتروني غير صحيحة");if(!S.canMakeRequest(e))throw S.getRemainingRequests(e),new Error("محاولات تسجيل دخول كثيرة. يرجى المحاولة بعد 5 دقائق.");const s=new FormData;s.append("email",e),s.append("password",t);try{const t=await H.post("/admin/login",s,{skipAuth:!0,skipRateLimit:!0});if(!t.access_token)throw new Error("فشل تسجيل الدخول، لم يتم استلام التوكن");await D.setItem(U,t.access_token),m();const l=await D.getItem(U);if(!l||l!==t.access_token)throw new Error("فشل في حفظ التوكن");try{const t=await H.get("/admin/me",{skipRateLimit:!0});if(!t||!t.id)throw new Error("بيانات المستخدم غير صحيحة");a(t),S.reset(e),t.id,t.email}catch(r){throw D.removeItem(U),new Error("فشل في الحصول على بيانات المستخدم: "+(r.message||"خطأ غير معروف"))}}catch(l){throw l.message.includes("محاولات")||l.message.includes("صيغة")||l.message.includes("استلام")||l.message,l}},g=async()=>{try{await D.getItem(U)&&await H.post("/admin/logout").catch(()=>{}),null==s||s.id}catch(e){await D.getItem(U)}finally{a(null),D.removeItem(U),D.clearSecureNamespace(),D.clearSessionKey(),localStorage.removeItem(q),d.current&&clearInterval(d.current),c.current&&clearInterval(c.current)}},v=t.useMemo(()=>({isAuthenticated:!!s,admin:s,login:p,logout:g,loading:r,sessionTimeRemaining:n}),[s,r,n]);return w.jsx(O.Provider,{value:v,children:e})},K=()=>{const e=t.useContext(O);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},Y=t.createContext(void 0),Z=({children:e})=>{const{isAuthenticated:s}=K(),[a,r]=t.useState([]),[l,n]=t.useState(!1),i=t.useCallback(async()=>{var e,t;if(!s)return r([]),void n(!1);try{n(!0);const e=await H.get("/admin/notifications");r(e.data||[])}catch(a){if(404===(null==a?void 0:a.status)||(null==(e=null==a?void 0:a.message)?void 0:e.includes("404"))||(null==(t=null==a?void 0:a.message)?void 0:t.includes("Not Found")))return void r([]);r([])}finally{n(!1)}},[s]),o=a.filter(e=>!e.read).length;return t.useEffect(()=>{if(!s)return r([]),void n(!1);i();const e=setInterval(()=>{i()},3e4);return()=>clearInterval(e)},[i,s]),w.jsx(Y.Provider,{value:{notifications:a,unreadCount:o,loading:l,fetchNotifications:i,markAsRead:async e=>{try{await H.put(`/admin/notifications/${e}/read`),r(t=>t.map(t=>t.id===e?{...t,read:!0}:t))}catch(t){}},markAllAsRead:async()=>{try{await H.put("/admin/notifications/read-all"),r(e=>e.map(e=>({...e,read:!0})))}catch(e){}},deleteNotification:async e=>{try{await H.delete(`/admin/notifications/${e}`),r(t=>t.filter(t=>t.id!==e))}catch(t){}}},children:e})},X=({label:e,error:t,icon:s,helperText:r,className:l="",id:n,...i})=>{const o=a.useId(),c=n??o;return w.jsxs("div",{className:"w-full",children:[e&&w.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-slate-300 mb-2",children:e}),w.jsxs("div",{className:"relative",children:[s&&w.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:s}),w.jsx("input",{id:c,className:`\n            w-full px-4 py-2.5 \n            ${s?"pr-10":""} \n            bg-slate-700/50 backdrop-blur-sm \n            border ${t?"border-red-500":"border-slate-600"} \n            rounded-lg text-white placeholder-slate-400 \n            transition-all duration-200\n            focus:outline-none focus:ring-2 \n            ${t?"focus:ring-red-500":"focus:ring-cyan-500"} \n            focus:border-transparent\n            hover:border-slate-500\n            ${l}\n          `,...i})]}),t&&w.jsxs("p",{className:"mt-1.5 text-xs text-red-400 flex items-center gap-1",children:[w.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:w.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),t]}),r&&!t&&w.jsx("p",{className:"mt-1.5 text-xs text-slate-400",children:r})]})},Q=a.memo(({variant:e="primary",size:s="md",isLoading:a=!1,icon:r,children:l,className:n="",disabled:i,...o})=>{const c=t.useMemo(()=>({primary:"bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white shadow-lg shadow-cyan-500/50 focus:ring-cyan-500",secondary:"bg-slate-700 hover:bg-slate-600 text-white shadow-lg shadow-slate-700/50 focus:ring-slate-500",success:"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600 text-white shadow-lg shadow-emerald-500/50 focus:ring-emerald-500",danger:"bg-gradient-to-r from-red-500 to-rose-500 hover:from-red-600 hover:to-rose-600 text-white shadow-lg shadow-red-500/50 focus:ring-red-500",warning:"bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white shadow-lg shadow-amber-500/50 focus:ring-amber-500",ghost:"bg-transparent hover:bg-slate-800/50 text-slate-300 hover:text-white border border-slate-700 hover:border-slate-600 focus:ring-slate-500"}),[]),d=t.useMemo(()=>({sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}),[]);return w.jsxs("button",{className:`inline-flex items-center justify-center gap-2 font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 disabled:opacity-50 disabled:cursor-not-allowed transform active:scale-95 ${c[e]} ${d[s]} ${n}`,disabled:i||a,...o,children:[a&&w.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!a&&r&&w.jsx("span",{children:r}),w.jsx("span",{children:l})]})}),ee=()=>{const[e,s]=t.useState(""),[a,r]=t.useState(""),[l,n]=t.useState(""),[i,o]=t.useState(!1),{login:c}=K();return w.jsxs("div",{className:"relative flex items-center justify-center min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 overflow-hidden p-3 sm:p-4",dir:"rtl",children:[w.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[w.jsx("div",{className:"absolute -top-20 sm:-top-40 -right-20 sm:-right-40 w-40 h-40 sm:w-80 sm:h-80 bg-cyan-500/30 rounded-full blur-3xl animate-pulse"}),w.jsx("div",{className:"absolute -bottom-20 sm:-bottom-40 -left-20 sm:-left-40 w-40 h-40 sm:w-80 sm:h-80 bg-blue-500/30 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),w.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-60 h-60 sm:w-96 sm:h-96 bg-purple-500/20 rounded-full blur-3xl animate-pulse",style:{animationDelay:"2s"}})]}),w.jsxs("div",{className:"relative w-full max-w-md animate-scale-in",children:[w.jsxs("div",{className:"relative p-6 sm:p-8 space-y-6 sm:space-y-8 bg-gradient-to-br from-slate-800/90 to-slate-900/90 backdrop-blur-xl rounded-xl sm:rounded-2xl shadow-2xl border border-slate-700/50",children:[w.jsxs("div",{className:"text-center space-y-3 sm:space-y-4",children:[w.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-xl sm:rounded-2xl bg-gradient-to-br from-cyan-500 to-blue-500 shadow-2xl shadow-cyan-500/50 animate-pulse-glow",children:w.jsx("svg",{className:"w-8 h-8 sm:w-10 sm:h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),w.jsxs("div",{children:[w.jsx("h1",{className:"text-3xl sm:text-4xl font-bold gradient-text mb-1 sm:mb-2",children:"صحتي"}),w.jsx("p",{className:"text-lg sm:text-xl font-semibold text-white",children:"لوحة التحكم"}),w.jsx("p",{className:"mt-2 text-sm sm:text-base text-slate-400",children:"مرحباً بعودتك! الرجاء تسجيل الدخول للمتابعة"})]})]}),w.jsxs("form",{className:"space-y-4 sm:space-y-6",onSubmit:async t=>{t.preventDefault(),n("");const r=C(e);if(r&&a.trim()){r!==e&&s(r),o(!0);try{await c(r,a)}catch(l){n(l.message||"فشل تسجيل الدخول. الرجاء التحقق من بيانات الاعتماد.")}finally{o(!1)}}else n("الرجاء إدخال البريد الإلكتروني وكلمة المرور.")},children:[w.jsx(X,{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>s(C(e.target.value)),label:"البريد الإلكتروني",placeholder:"admin@example.com",error:l&&!e?"الرجاء إدخال البريد الإلكتروني":"",icon:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})})}),w.jsx(X,{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:a,onChange:e=>r(e.target.value),label:"كلمة المرور",placeholder:"••••••••",error:l&&!a?"الرجاء إدخال كلمة المرور":"",icon:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),l&&w.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-red-500/10 border border-red-500/30 animate-scale-in",children:[w.jsx("svg",{className:"w-5 h-5 text-red-400 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:w.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),w.jsx("p",{className:"text-red-400 text-sm flex-1",children:l})]}),w.jsx(Q,{type:"submit",variant:"primary",size:"lg",isLoading:i,className:"w-full",icon:!i&&w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),children:i?"جاري تسجيل الدخول...":"تسجيل الدخول"})]}),w.jsx("div",{className:"pt-4 sm:pt-6 border-t border-slate-700/50",children:w.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs sm:text-sm text-slate-400",children:[w.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),w.jsx("span",{className:"text-center",children:"جميع الحقوق محفوظة © 2025 صحتي"})]})})]}),w.jsx("div",{className:"absolute -top-3 sm:-top-4 -right-3 sm:-right-4 w-16 h-16 sm:w-24 sm:h-24 bg-gradient-to-br from-cyan-500/20 to-blue-500/20 rounded-full blur-2xl -z-10"}),w.jsx("div",{className:"absolute -bottom-3 sm:-bottom-4 -left-3 sm:-left-4 w-20 h-20 sm:w-32 sm:h-32 bg-gradient-to-br from-purple-500/20 to-pink-500/20 rounded-full blur-2xl -z-10"})]})]})},te=({to:e,icon:t,label:s,badge:a,onClick:l})=>w.jsx(r,{to:e,end:!0,onClick:l,className:({isActive:e})=>"flex items-center justify-between px-4 py-3 my-1 rounded-xl transition-all duration-200 group relative overflow-hidden\n                "+(e?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg shadow-cyan-500/30":"text-slate-300 hover:bg-slate-800/50 hover:text-white hover:translate-x-1"),children:({isActive:e})=>w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[w.jsx("span",{className:"transition-transform duration-200 "+(e?"":"group-hover:scale-110"),children:t}),w.jsx("span",{className:"font-medium text-sm",children:s})]}),void 0!==a&&a>0&&w.jsx("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full animate-pulse",children:a}),!e&&w.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500/0 to-blue-500/0 group-hover:from-cyan-500/10 group-hover:to-blue-500/10 transition-all duration-300"})]})}),se=({isOpen:e,onClose:t})=>w.jsxs(w.Fragment,{children:[e&&w.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 lg:hidden animate-fade-in",onClick:t}),w.jsxs("aside",{className:`\n        fixed lg:static inset-y-0 right-0 z-50\n        w-64 bg-gradient-to-b from-slate-900 to-slate-950\n        border-l border-slate-700/50 h-full flex flex-col\n        transition-all duration-300 shadow-2xl\n        ${e?"translate-x-0":"translate-x-full lg:translate-x-0"}\n      `,children:[w.jsxs("div",{className:"flex items-center justify-between h-20 border-b border-slate-700/50 px-4",children:[w.jsxs("div",{className:"text-center flex-1",children:[w.jsx("h1",{className:"text-2xl font-bold gradient-text",children:"صحتي"}),w.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"لوحة التحكم"})]}),w.jsx("button",{onClick:t,className:"lg:hidden p-2 rounded-lg hover:bg-slate-800 transition-colors",children:w.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),w.jsxs("nav",{className:"flex-1 px-3 py-6 overflow-y-auto custom-scrollbar",children:[w.jsx(te,{to:"/",label:"لوحة التحكم",icon:w.jsx(ae,{}),onClick:t}),w.jsx(te,{to:"/approvals",label:"طلبات الموافقة",icon:w.jsx(re,{}),onClick:t}),w.jsxs("div",{className:"px-4 mt-6 mb-2 flex items-center gap-2",children:[w.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"}),w.jsx("p",{className:"text-xs uppercase text-slate-500 font-semibold",children:"الإدارة"}),w.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"})]}),w.jsx(te,{to:"/users",label:"المستخدمون",icon:w.jsx(le,{}),onClick:t}),w.jsx(te,{to:"/doctors",label:"الأطباء",icon:w.jsx(ne,{}),onClick:t}),w.jsx(te,{to:"/nurses",label:"الممرضون",icon:w.jsx(ie,{}),onClick:t}),w.jsx(te,{to:"/hospitals",label:"المشافي",icon:w.jsx(oe,{}),onClick:t}),w.jsxs("div",{className:"px-4 mt-6 mb-2 flex items-center gap-2",children:[w.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"}),w.jsx("p",{className:"text-xs uppercase text-slate-500 font-semibold",children:"الخدمات"}),w.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"})]}),w.jsx(te,{to:"/specializations",label:"التخصصات",icon:w.jsx(ce,{}),onClick:t}),w.jsx(te,{to:"/hospital-services",label:"خدمات المشافي",icon:w.jsx(de,{}),onClick:t}),w.jsx(te,{to:"/provinces",label:"المحافظات",icon:w.jsx(xe,{}),onClick:t}),w.jsxs("div",{className:"px-4 mt-6 mb-2 flex items-center gap-2",children:[w.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"}),w.jsx("p",{className:"text-xs uppercase text-slate-500 font-semibold",children:"التقارير"}),w.jsx("div",{className:"h-px flex-1 bg-gradient-to-r from-transparent via-slate-700 to-transparent"})]}),w.jsx(te,{to:"/entity-ratings",label:"تقييمات الكيانات",icon:w.jsx(me,{}),onClick:t})]}),w.jsx("div",{className:"p-4 border-t border-slate-700/50",children:w.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-br from-cyan-500/10 to-blue-500/10 border border-cyan-500/20",children:w.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[w.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center",children:w.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-xs font-semibold text-cyan-400",children:"الإصدار"}),w.jsx("p",{className:"text-xs text-slate-400",children:"v1.0.0"})]})]})})})]})]}),ae=()=>w.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),re=()=>w.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),le=()=>w.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 016-6h6a6 6 0 016 6v1h-1M15 21a3 3 0 116 0v-1a3 3 0 11-6 0v1z"})}),ne=()=>w.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547a2 2 0 00-.547 1.806l.477 2.387a6 6 0 00.517 3.86l.158.318a6 6 0 00.517 3.86l2.387.477a2 2 0 001.806-.547a2 2 0 00.547-1.806l-.477-2.387a6 6 0 00-.517-3.86l-.158-.318a6 6 0 00-.517-3.86l-2.387-.477zM12 12a3 3 0 100-6 3 3 0 000 6z"})}),ie=()=>w.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),oe=()=>w.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),ce=()=>w.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16v4m-2-2h4m5 10v4m-2-2h4M5 11h14M5 11a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v3a2 2 0 01-2 2M5 11a2 2 0 00-2 2v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 00-2-2"})}),de=()=>w.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),me=()=>w.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.966a1 1 0 00.95.69h4.178c.969 0 1.371 1.24.588 1.81l-3.382 2.46a1 1 0 00-.364 1.118l1.287 3.966c.3.922-.755 1.688-1.54 1.118l-3.382-2.46a1 1 0 00-1.176 0l-3.382 2.46c-.784.57-1.838-.196-1.539-1.118l1.287-3.966a1 1 0 00-.364-1.118L2.997 9.393c-.783-.57-.38-1.81.588-1.81h4.178a1 1 0 00.95-.69l1.286-3.966z"})}),xe=()=>w.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),ue=e=>e.toLocaleLowerCase("ar-SY"),he=e=>e.map(e=>null==e?"":String(e).toLocaleLowerCase("ar-SY")).filter(Boolean).join(" "),pe={hospital:{endpoint:"/admin/hospital/all",key:"hospitals",perPage:100},doctor:{endpoint:"/admin/doctor/all",key:"doctors",perPage:100},nurse:{endpoint:"/admin/nurse/all",key:"nurses",perPage:100},user:{endpoint:"/admin/user/all",key:"users",perPage:100}},ge=()=>{const[e,s]=t.useState(""),[a,r]=t.useState([]),[n,i]=t.useState(!1),[o,c]=t.useState(!1),d=t.useRef(null),m=l(),x=t.useRef(0),u=t.useRef(!1),h=t.useRef({hospital:{data:null,promise:null,lastFetchedAt:null,normalized:null},doctor:{data:null,promise:null,lastFetchedAt:null,normalized:null},nurse:{data:null,promise:null,lastFetchedAt:null,normalized:null},user:{data:null,promise:null,lastFetchedAt:null,normalized:null}}),p=t.useCallback((e,t,s)=>{var a;let r=[],l=s;return(null==(a=null==e?void 0:e[t])?void 0:a.data)&&Array.isArray(e[t].data)?(r=e[t].data,l=e[t].last_page??l):(null==e?void 0:e[t])&&Array.isArray(e[t])?r=e[t]:(null==e?void 0:e.data)&&Array.isArray(e.data)?r=e.data:Array.isArray(e)&&(r=e),(!Number.isFinite(l)||l<1)&&(l=s),{data:r,lastPage:l}},[]),g=t.useCallback(async e=>{const t=pe[e],s=[],a=await H.get(`${t.endpoint}?page=1&per_page=${t.perPage}`).catch(()=>null);if(!a)return s;const{data:r,lastPage:l}=p(a,t.key,1);s.push(...r);const n=Math.min(Math.max(l,1),3);if(n>1){const e=[];for(let s=2;s<=n;s++)e.push(H.get(`${t.endpoint}?page=${s}&per_page=${t.perPage}`).catch(()=>null));(await Promise.all(e)).forEach(e=>{if(!e)return;const{data:a}=p(e,t.key,1);s.push(...a)})}return s},[p]),v=t.useCallback(async e=>{const t=h.current[e];return t.data?t.data:(t.promise||(t.promise=g(e).then(e=>(t.data=e,t.lastFetchedAt=Date.now(),t.normalized=null,e)).catch(e=>{throw t.data=null,t.lastFetchedAt=null,t.normalized=null,e}).finally(()=>{t.promise=null})),t.promise)},[g]);t.useEffect(()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),t.useEffect(()=>{const t=setTimeout(()=>{e.trim().length>=2?f(e.trim()):r([])},300);return()=>clearTimeout(t)},[e]);const j=t.useCallback(async()=>{if(u.current)return;u.current=!0;const e=["hospital","doctor","nurse","user"];for(const t of e)try{await v(t)}catch{}},[v]),f=async e=>{const t=++x.current;i(!0);try{const[s,a,l,n]=await Promise.all([b(e),y(e),N(e),k(e)]),i=[...s,...a,...l,...n];x.current===t&&(r(i),c(!0))}catch(s){x.current===t&&(r([]),c(!1))}finally{x.current===t&&i(!1)}},b=async e=>{var t,s;try{const a=h.current.hospital,r=await v("hospital");a.normalized&&a.normalized.length===r.length||(a.normalized=r.map(e=>{var t,s;return he([null==e?void 0:e.full_name,null==(t=null==e?void 0:e.account)?void 0:t.email,null==e?void 0:e.address,null==(s=null==e?void 0:e.account)?void 0:s.phone_number])}));const l=ue(e.trim()),n=[];for(let e=0;e<r.length&&!(n.length>=5);e++){if(!(null==(t=a.normalized)?void 0:t[e]))continue;if(!a.normalized[e].includes(l))continue;const i=r[e];(null==i?void 0:i.id)&&n.push({id:i.id,type:"hospital",name:i.full_name||"غير محدد",subtitle:(null==(s=i.account)?void 0:s.email)||i.address||"",data:i})}return n}catch(a){return[]}},y=async e=>{var t,s,a;try{const r=h.current.doctor,l=await v("doctor");r.normalized&&r.normalized.length===l.length||(r.normalized=l.map(e=>{var t,s,a,r;return he([null==e?void 0:e.full_name,null==(t=null==e?void 0:e.account)?void 0:t.email,null==(s=null==e?void 0:e.account)?void 0:s.phone_number,null==(a=null==e?void 0:e.specialization)?void 0:a.name_ar,null==(r=null==e?void 0:e.specialization)?void 0:r.name_en])}));const n=ue(e.trim()),i=[];for(let e=0;e<l.length&&!(i.length>=5);e++){if(!(null==(t=r.normalized)?void 0:t[e]))continue;if(!r.normalized[e].includes(n))continue;const o=l[e];(null==o?void 0:o.id)&&i.push({id:o.id,type:"doctor",name:o.full_name,subtitle:(null==(s=o.specialization)?void 0:s.name_ar)||(null==(a=o.account)?void 0:a.email),data:o})}return i}catch(r){return[]}},N=async e=>{var t,s;try{const a=h.current.nurse,r=await v("nurse");a.normalized&&a.normalized.length===r.length||(a.normalized=r.map(e=>{var t,s;return he([null==e?void 0:e.full_name,null==(t=null==e?void 0:e.account)?void 0:t.email,null==(s=null==e?void 0:e.account)?void 0:s.phone_number,null==e?void 0:e.graduation_type,null==e?void 0:e.address])}));const l=ue(e.trim()),n=[];for(let e=0;e<r.length&&!(n.length>=5);e++){if(!(null==(t=a.normalized)?void 0:t[e]))continue;if(!a.normalized[e].includes(l))continue;const i=r[e];(null==i?void 0:i.id)&&n.push({id:i.id,type:"nurse",name:i.full_name,subtitle:i.graduation_type||(null==(s=i.account)?void 0:s.email),data:i})}return n}catch(a){return[]}},k=async e=>{var t,s;try{const a=h.current.user,r=await v("user");a.normalized&&a.normalized.length===r.length||(a.normalized=r.map(e=>{var t,s,a;return he([null==e?void 0:e.full_name,null==(t=null==e?void 0:e.account)?void 0:t.email,null==(s=null==e?void 0:e.account)?void 0:s.phone_number,null==(a=null==e?void 0:e.account)?void 0:a.username,null==e?void 0:e.address])}));const l=ue(e.trim()),n=[];for(let e=0;e<r.length&&!(n.length>=5);e++){if(!(null==(t=a.normalized)?void 0:t[e]))continue;if(!a.normalized[e].includes(l))continue;const i=r[e];(null==i?void 0:i.id)&&n.push({id:i.id,type:"user",name:i.full_name,subtitle:null==(s=i.account)?void 0:s.email,data:i})}return n}catch(a){return[]}},C=e=>{switch(e){case"hospital":return"مشفى";case"doctor":return"طبيب";case"nurse":return"ممرض/ة";case"user":return"مستخدم"}},_=e=>{switch(e){case"hospital":return w.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"doctor":return w.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})});case"nurse":return w.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})});case"user":return w.jsx("svg",{className:"w-5 h-5 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}},L=e=>{switch(e){case"hospital":return"bg-blue-500/10 text-blue-400 border-blue-500/30";case"doctor":return"bg-green-500/10 text-green-400 border-green-500/30";case"nurse":return"bg-purple-500/10 text-purple-400 border-purple-500/30";case"user":return"bg-cyan-500/10 text-cyan-400 border-cyan-500/30"}};return w.jsxs("div",{ref:d,className:"relative w-full max-w-2xl",children:[w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:n?w.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),w.jsx("input",{type:"text",value:e,onChange:e=>s(e.target.value),onFocus:()=>e.trim().length>=2&&a.length>0&&c(!0),onClick:()=>{e.trim().length>=2&&a.length>0&&c(!0)},onFocusCapture:()=>{j()},onClickCapture:()=>{j()},placeholder:"ابحث... (2 أحرف على الأقل)",className:"w-full pr-10 pl-4 py-2.5 bg-slate-700/50 backdrop-blur-sm border border-slate-600 rounded-lg text-white placeholder-slate-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent hover:border-slate-500"}),e&&w.jsx("button",{onClick:()=>{s(""),r([]),c(!1),x.current+=1},className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white transition-colors",children:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),o&&a.length>0&&w.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl max-h-96 overflow-y-auto custom-scrollbar z-50 animate-scale-in",children:w.jsxs("div",{className:"p-2",children:[w.jsxs("div",{className:"text-xs text-slate-400 px-3 py-2 font-medium",children:["تم العثور على ",a.length," نتيجة"]}),a.map((e,t)=>w.jsx("button",{onClick:()=>(e=>{switch(s(""),c(!1),r([]),e.type){case"hospital":m(`/hospitals/${e.id}`);break;case"doctor":m(`/doctors/${e.id}`);break;case"nurse":m(`/nurses/${e.id}`);break;case"user":m(`/users/${e.id}`,{state:{user:e.data}})}})(e),className:"w-full text-right px-3 py-3 rounded-lg hover:bg-slate-700/50 transition-colors group",children:w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"flex-shrink-0",children:_(e.type)}),w.jsxs("div",{className:"flex-1 min-w-0",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("p",{className:"text-sm font-medium text-white truncate group-hover:text-cyan-400 transition-colors",children:e.name}),w.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full border ${L(e.type)} flex-shrink-0`,children:C(e.type)})]}),e.subtitle&&w.jsx("p",{className:"text-xs text-slate-400 truncate mt-0.5",children:e.subtitle})]}),w.jsx("svg",{className:"w-4 h-4 text-slate-500 group-hover:text-cyan-400 transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})]})},`${e.type}-${e.id}-${t}`))]})}),o&&e.trim().length>=2&&0===a.length&&!n&&w.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl p-6 text-center z-50 animate-scale-in",children:[w.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-full bg-slate-700/50 flex items-center justify-center",children:w.jsx("svg",{className:"w-8 h-8 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),w.jsxs("p",{className:"text-slate-400 text-sm",children:['لم يتم العثور على نتائج لـ "',e,'"']}),w.jsx("p",{className:"text-slate-500 text-xs mt-1",children:"جرب البحث بكلمات أخرى أو تحقق من الإملاء"})]}),1===e.trim().length&&w.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl p-4 text-center z-50 animate-scale-in",children:w.jsx("p",{className:"text-slate-400 text-sm",children:"اكتب حرفاً آخر للبحث..."})})]})},ve=({onMenuClick:e})=>{const{logout:s}=K(),{notifications:a,unreadCount:r,markAsRead:l,markAllAsRead:n,deleteNotification:i}=(()=>{const e=t.useContext(Y);if(void 0===e)throw new Error("useNotifications must be used within a NotificationProvider");return e})(),[o,c]=t.useState(!1),d=t.useRef(null);t.useEffect(()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&c(!1)};return o&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[o]);const m=e=>{switch(e){case"approval":return w.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"reservation":return w.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})});case"alert":return w.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});default:return w.jsx("svg",{className:"w-5 h-5 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},x=e=>{const t=new Date(e),s=(new Date).getTime()-t.getTime(),a=Math.floor(s/36e5),r=Math.floor(a/24);if(r>0)return`منذ ${r} ${1===r?"يوم":"أيام"}`;if(a>0)return`منذ ${a} ${1===a?"ساعة":"ساعات"}`;{const e=Math.floor(s/6e4);return`منذ ${e} ${1===e?"دقيقة":"دقائق"}`}};return w.jsxs("header",{className:"bg-gradient-to-r from-slate-900/95 to-slate-800/95 backdrop-blur-md shadow-lg p-3 md:p-4 flex justify-between items-center z-10 border-b border-slate-700/50 animate-slide-down",children:[w.jsx("button",{onClick:e,className:"lg:hidden p-2 rounded-lg hover:bg-slate-700/50 transition-colors",children:w.jsx("svg",{className:"w-6 h-6 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),w.jsx("div",{className:"flex-1 px-2 md:px-4 max-w-3xl hidden sm:block",children:w.jsx(ge,{})}),w.jsx("div",{className:"flex-1 sm:hidden"}),w.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[w.jsxs("div",{className:"relative",ref:d,children:[w.jsxs("button",{onClick:()=>c(!o),className:"relative p-2 rounded-lg hover:bg-slate-700/50 transition-colors group",children:[w.jsx("svg",{className:"w-6 h-6 text-slate-300 group-hover:text-cyan-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),r>0&&w.jsx("span",{className:"absolute top-0 right-0 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center animate-pulse",children:r>9?"9+":r})]}),o&&w.jsxs("div",{className:"absolute left-0 mt-2 w-96 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl animate-scale-in overflow-hidden z-50",children:[w.jsxs("div",{className:"p-4 border-b border-slate-700/50 flex items-center justify-between",children:[w.jsx("h3",{className:"font-bold text-white",children:"الإشعارات"}),a.length>0&&r>0&&w.jsx("button",{onClick:n,className:"text-xs text-cyan-400 hover:text-cyan-300 transition-colors",children:"تعليم الكل كمقروء"})]}),w.jsx("div",{className:"max-h-96 overflow-y-auto custom-scrollbar",children:0===a.length?w.jsxs("div",{className:"p-8 text-center",children:[w.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-slate-700/50 flex items-center justify-center",children:w.jsx("svg",{className:"w-8 h-8 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),w.jsx("p",{className:"text-slate-400 text-sm",children:"لا توجد إشعارات جديدة"})]}):w.jsx("div",{className:"divide-y divide-slate-700/50",children:a.map(e=>w.jsx("div",{onClick:()=>(async e=>{e.read||await l(e.id)})(e),className:"p-4 hover:bg-slate-700/30 transition-colors cursor-pointer "+(e.read?"":"bg-cyan-500/5"),children:w.jsxs("div",{className:"flex gap-3",children:[w.jsx("div",{className:"flex-shrink-0 mt-1",children:m(e.type)}),w.jsxs("div",{className:"flex-1 min-w-0",children:[w.jsxs("div",{className:"flex items-start justify-between gap-2",children:[w.jsx("p",{className:"text-sm font-semibold text-white",children:e.title}),!e.read&&w.jsx("span",{className:"w-2 h-2 bg-cyan-400 rounded-full flex-shrink-0 mt-1"})]}),w.jsx("p",{className:"text-sm text-slate-300 mt-1 line-clamp-2",children:e.message}),w.jsxs("div",{className:"flex items-center justify-between mt-2",children:[w.jsx("span",{className:"text-xs text-slate-500",children:x(e.created_at)}),w.jsx("button",{onClick:t=>{t.stopPropagation(),i(e.id)},className:"text-xs text-red-400 hover:text-red-300 transition-colors",children:"حذف"})]})]})]})},e.id))})})]})]}),w.jsxs("div",{className:"relative group",children:[w.jsx("button",{className:"flex items-center gap-2 px-2 py-2 rounded-lg hover:bg-slate-700/50 transition-all duration-200",children:w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center shadow-lg",children:w.jsx("svg",{className:"w-6 h-6 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:w.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),w.jsx("span",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-400 border-2 border-slate-900 rounded-full"})]})}),w.jsx("div",{className:"absolute left-0 mt-2 w-48 bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 overflow-hidden animate-scale-in",children:w.jsxs("button",{onClick:s,className:"w-full text-right px-4 py-3 text-sm text-red-400 hover:bg-red-500/10 transition-colors flex items-center gap-2",children:[w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"تسجيل الخروج"]})})]})]})]})},je=()=>{const[e,s]=t.useState(!1);return w.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 text-slate-100 overflow-hidden",dir:"rtl",children:[w.jsx(se,{isOpen:e,onClose:()=>s(!1)}),w.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden w-full",children:[w.jsx(ve,{onMenuClick:()=>s(!0)}),w.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gradient-to-br from-slate-900/50 to-slate-800/50 p-3 sm:p-4 md:p-6 custom-scrollbar",children:w.jsx("div",{className:"max-w-7xl mx-auto",children:w.jsx(n,{})})})]}),w.jsxs("div",{className:"fixed inset-0 pointer-events-none overflow-hidden -z-10",children:[w.jsx("div",{className:"absolute top-1/4 -right-48 w-96 h-96 bg-cyan-500/5 rounded-full blur-3xl"}),w.jsx("div",{className:"absolute bottom-1/4 -left-48 w-96 h-96 bg-blue-500/5 rounded-full blur-3xl"})]})]})},fe=({children:e,className:t="",gradient:s=!1,hover:a=!1,onClick:r})=>{const l=s?"bg-gradient-to-br from-slate-800/90 to-slate-900/90 border-slate-700/50 backdrop-blur-sm":"bg-slate-800/50 border-slate-700",n=a?"hover:shadow-xl hover:shadow-cyan-500/10 hover:-translate-y-1 hover:border-cyan-500/50 cursor-pointer":"";return w.jsx("div",{className:`rounded-xl border transition-all duration-300 ${l} ${n} ${t}`,onClick:r,children:e})},be=({title:e,value:s,icon:a,color:r,loading:l,delay:n=0,onClick:i})=>{const[o,c]=t.useState(!1);return t.useEffect(()=>{const e=setTimeout(()=>c(!0),n);return()=>clearTimeout(e)},[n]),w.jsx(fe,{gradient:!0,hover:!0,onClick:i,className:"p-4 md:p-6 card-shine transform transition-all duration-500 "+(o?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("p",{className:"text-slate-400 text-xs md:text-sm font-medium mb-2",children:e}),l?w.jsx("div",{className:"h-8 w-20 skeleton rounded"}):w.jsx("p",{className:"text-2xl md:text-3xl font-bold text-white mb-2",children:s})]}),w.jsx("div",{className:`p-3 md:p-4 rounded-2xl ${r} shadow-lg transform transition-transform duration-300 hover:scale-110`,children:a})]})})},ye=({title:e,description:t,icon:s,color:a,onClick:r})=>w.jsxs("button",{onClick:r,className:`p-4 rounded-xl ${a} border border-slate-700/50 hover:border-cyan-500/50 transition-all duration-200 hover:shadow-xl hover:shadow-cyan-500/10 hover:-translate-y-1 group text-right w-full`,children:[w.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[w.jsx("div",{className:"p-2 rounded-lg bg-white/10 group-hover:bg-white/20 transition-colors",children:s}),w.jsx("h3",{className:"text-white font-semibold text-sm md:text-base",children:e})]}),w.jsx("p",{className:"text-slate-400 text-xs md:text-sm",children:t})]}),we=()=>{const e=l(),[s,a]=t.useState(new Date),[r,n]=t.useState(!0),[i,o]=t.useState({pendingCount:0,doctorsCount:0,usersCount:0,hospitalsCount:0});return t.useEffect(()=>{const e=setInterval(()=>a(new Date),1e3);return()=>clearInterval(e)},[]),t.useEffect(()=>{(async()=>{var e,t,s,a,r,l,i,c;n(!0);try{const[n,d,m,x,u]=await Promise.all([H.post("/admin/get-pending-accounts",{role:"doctor"}).catch(()=>({data:[]})),H.post("/admin/get-pending-accounts",{role:"nurse"}).catch(()=>({data:[]})),H.get("/admin/doctor/all?per_page=10000").catch(()=>({doctors:[]})),H.get("/admin/user/all?per_page=10000").catch(()=>({users:[]})),H.get("/admin/hospital/all?per_page=10000").catch(()=>({hospitals:{data:[]}}))]);let h=0;(null==(e=m.doctors)?void 0:e.total)?h=m.doctors.total:m.total?h=m.total:(null==(t=m.doctors)?void 0:t.data)&&Array.isArray(m.doctors.data)?h=m.doctors.data.length:m.doctors&&Array.isArray(m.doctors)?h=m.doctors.length:m.data&&Array.isArray(m.data)?h=m.data.length:Array.isArray(m)&&(h=m.length);let p=0;(null==(s=x.users)?void 0:s.total)?p=x.users.total:x.total?p=x.total:(null==(a=x.users)?void 0:a.data)&&Array.isArray(x.users.data)?p=x.users.data.length:x.users&&Array.isArray(x.users)?p=x.users.length:x.data&&Array.isArray(x.data)?p=x.data.length:Array.isArray(x)&&(p=x.length);let g=0;(null==(r=u.hospitals)?void 0:r.total)?g=u.hospitals.total:u.total?g=u.total:(null==(l=u.hospitals)?void 0:l.data)&&Array.isArray(u.hospitals.data)?g=u.hospitals.data.length:u.hospitals&&Array.isArray(u.hospitals)?g=u.hospitals.length:u.data&&Array.isArray(u.data)?g=u.data.length:Array.isArray(u)&&(g=u.length),o({pendingCount:((null==(i=n.data)?void 0:i.length)||0)+((null==(c=d.data)?void 0:c.length)||0),doctorsCount:h,usersCount:p,hospitalsCount:g})}catch(d){}finally{n(!1)}})()},[]),w.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[w.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-4",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold gradient-text mb-2",children:"لوحة التحكم الرئيسية"}),w.jsx("p",{className:"text-sm md:text-base text-slate-400",children:"مرحباً بك، إليك نظرة عامة على النظام"})]}),w.jsxs("div",{className:"text-right md:text-left",children:[w.jsx("p",{className:"text-xl md:text-2xl font-bold text-white",children:s.toLocaleTimeString("ar-EG")}),w.jsx("p",{className:"text-xs md:text-sm text-slate-400 hidden sm:block",children:s.toLocaleDateString("ar-EG",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),w.jsx("p",{className:"text-xs md:text-sm text-slate-400 sm:hidden",children:s.toLocaleDateString("ar-EG",{day:"numeric",month:"short"})})]})]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4 lg:gap-6",children:[w.jsx(be,{title:"طلبات موافقة",value:i.pendingCount,icon:w.jsx(Ne,{}),color:"bg-gradient-to-br from-amber-500/20 to-orange-500/20 text-amber-300",loading:r,delay:0,onClick:()=>e("/approvals")}),w.jsx(be,{title:"إجمالي الأطباء",value:i.doctorsCount,icon:w.jsx(Ce,{}),color:"bg-gradient-to-br from-cyan-500/20 to-blue-500/20 text-cyan-300",loading:r,delay:100,onClick:()=>e("/doctors")}),w.jsx(be,{title:"إجمالي المستخدمين",value:i.usersCount,icon:w.jsx(ke,{}),color:"bg-gradient-to-br from-emerald-500/20 to-green-500/20 text-emerald-300",loading:r,delay:200,onClick:()=>e("/users")}),w.jsx(be,{title:"إجمالي المشافي",value:i.hospitalsCount,icon:w.jsx(_e,{}),color:"bg-gradient-to-br from-rose-500/20 to-red-500/20 text-rose-300",loading:r,delay:300,onClick:()=>e("/hospitals")})]}),w.jsxs(fe,{gradient:!0,className:"p-4 md:p-6",children:[w.jsxs("h2",{className:"text-lg md:text-xl font-bold text-white mb-4 md:mb-6 flex items-center gap-2",children:[w.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"إجراءات سريعة"]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",children:[w.jsx(ye,{title:"مراجعة الطلبات",description:"عرض طلبات الموافقة المعلقة",icon:w.jsx(Ne,{}),color:"bg-gradient-to-br from-amber-500/10 to-orange-500/10",onClick:()=>e("/approvals")}),w.jsx(ye,{title:"إدارة الأطباء",description:"عرض وإدارة الأطباء",icon:w.jsx(Ce,{}),color:"bg-gradient-to-br from-cyan-500/10 to-blue-500/10",onClick:()=>e("/doctors")}),w.jsx(ye,{title:"إدارة المشافي",description:"عرض وإدارة المشافي",icon:w.jsx(_e,{}),color:"bg-gradient-to-br from-emerald-500/10 to-green-500/10",onClick:()=>e("/hospitals")})]})]}),w.jsxs(fe,{gradient:!0,className:"p-4 md:p-6",children:[w.jsxs("h2",{className:"text-lg md:text-xl font-bold text-white mb-4 md:mb-6 flex items-center gap-2",children:[w.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"حالة النظام"]}),w.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[w.jsxs("div",{className:"p-3 md:p-4 rounded-lg bg-emerald-500/10 border border-emerald-500/30",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsx("span",{className:"text-xs md:text-sm text-slate-300",children:"الخادم"}),w.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"})]}),w.jsx("p",{className:"text-xs text-emerald-400 font-medium",children:"نشط ويعمل"})]}),w.jsxs("div",{className:"p-3 md:p-4 rounded-lg bg-emerald-500/10 border border-emerald-500/30",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsx("span",{className:"text-xs md:text-sm text-slate-300",children:"قاعدة البيانات"}),w.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"})]}),w.jsx("p",{className:"text-xs text-emerald-400 font-medium",children:"متصلة"})]}),w.jsxs("div",{className:"p-3 md:p-4 rounded-lg bg-emerald-500/10 border border-emerald-500/30",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsx("span",{className:"text-xs md:text-sm text-slate-300",children:"API"}),w.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"})]}),w.jsx("p",{className:"text-xs text-emerald-400 font-medium",children:"جاهز"})]}),w.jsxs("div",{className:"p-3 md:p-4 rounded-lg bg-cyan-500/10 border border-cyan-500/30",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsx("span",{className:"text-xs md:text-sm text-slate-300",children:"الأداء"}),w.jsx("span",{className:"text-xs text-cyan-400 font-bold",children:"98%"})]}),w.jsx("div",{className:"w-full bg-slate-700 rounded-full h-1.5",children:w.jsx("div",{className:"bg-gradient-to-r from-cyan-400 to-blue-500 h-1.5 rounded-full",style:{width:"98%"}})})]})]})]})]})},Ne=()=>w.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),ke=()=>w.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 016-6h6a6 6 0 016 6v1h-1M15 21a3 3 0 116 0v-1a3 3 0 11-6 0v1z"})}),Ce=()=>w.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),_e=()=>w.jsx("svg",{className:"w-6 h-6 md:w-8 md:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),Le=({value:e,onChange:t,placeholder:s="بحث...",className:a=""})=>w.jsxs("div",{className:`relative ${a}`,children:[w.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),w.jsx("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:s,className:"w-full pr-10 pl-4 py-2.5 bg-slate-700/50 backdrop-blur-sm border border-slate-600 rounded-lg text-white placeholder-slate-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent hover:border-slate-500"}),e&&w.jsx("button",{onClick:()=>t(""),className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white transition-colors",children:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),Ae=({icon:e,title:t,description:s,action:a})=>w.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[e&&w.jsx("div",{className:"mb-6 p-4 rounded-full bg-slate-700/30 text-slate-400",children:e}),w.jsx("h3",{className:"text-lg font-semibold text-slate-300 mb-2",children:t}),s&&w.jsx("p",{className:"text-sm text-slate-400 text-center max-w-md mb-6",children:s}),a&&w.jsx("button",{onClick:a.onClick,className:"px-6 py-2.5 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white rounded-lg font-medium transition-all duration-200 shadow-lg shadow-cyan-500/30 transform hover:scale-105",children:a.label})]}),Se=({size:e="md",text:t})=>{const s={sm:"w-6 h-6",md:"w-12 h-12",lg:"w-16 h-16"};return w.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:`${s[e]} border-4 border-slate-700 border-t-cyan-500 rounded-full animate-spin`}),w.jsx("div",{className:`${s[e]} border-4 border-transparent border-t-cyan-400 rounded-full animate-spin absolute top-0 left-0`,style:{animationDirection:"reverse",animationDuration:"1s"}})]}),t&&w.jsx("p",{className:"text-slate-400 text-sm font-medium animate-pulse",children:t})]})};const ze=a.memo(function({data:e,columns:s,loading:a=!1,searchable:r=!0,searchPlaceholder:l="بحث...",emptyMessage:n="لا توجد بيانات لعرضها",itemsPerPage:i=10,onRowClick:o}){const[c,d]=t.useState(""),[m,x]=t.useState(1),[u,h]=t.useState(null),[p,g]=t.useState("asc"),v=(e,t)=>null!=e&&("object"!=typeof e?String(e).toLowerCase().includes(t.toLowerCase()):Array.isArray(e)?e.some(e=>v(e,t)):Object.values(e).some(e=>v(e,t))),j=t.useMemo(()=>c?e.filter(e=>v(e,c)):e,[e,c]),f=t.useMemo(()=>u?[...j].sort((e,t)=>{const a=s.find(e=>String(e.accessor)===u);if(!a)return 0;let r,l;return"function"==typeof a.accessor?0:(r=e[a.accessor],l=t[a.accessor],null==r?1:null==l?-1:"string"==typeof r&&"string"==typeof l?"asc"===p?r.localeCompare(l):l.localeCompare(r):r<l?"asc"===p?-1:1:r>l?"asc"===p?1:-1:0)}):j,[j,u,p,s]),b=t.useMemo(()=>{const e=(m-1)*i;return f.slice(e,e+i)},[f,m,i]),y=Math.ceil(f.length/i),N=(e,t)=>"function"==typeof t.accessor?t.accessor(e):e[t.accessor];return w.jsxs("div",{className:"space-y-3 md:space-y-4",children:[r&&w.jsx(Le,{value:c,onChange:d,placeholder:l,className:"w-full md:max-w-md"}),w.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 border border-slate-700/50 rounded-lg md:rounded-xl shadow-xl overflow-hidden backdrop-blur-sm",children:[w.jsx("div",{className:"overflow-x-auto custom-scrollbar -mx-2 sm:mx-0",children:w.jsxs("table",{className:"w-full text-xs sm:text-sm text-right text-slate-300 min-w-[600px]",children:[w.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800/80 backdrop-blur-sm sticky top-0 z-10",children:w.jsx("tr",{children:s.map((e,t)=>w.jsx("th",{scope:"col",className:`px-3 sm:px-4 md:px-6 py-3 md:py-4 whitespace-nowrap ${e.sortable&&"function"!=typeof e.accessor?"cursor-pointer hover:text-cyan-400 transition-colors select-none":""} ${e.className||""}`,onClick:()=>{return t=String(e.accessor),void(e.sortable&&"function"!=typeof e.accessor&&(u===t?g("asc"===p?"desc":"asc"):(h(t),g("asc"))));var t},children:w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{children:e.header}),e.sortable&&"function"!=typeof e.accessor&&u===String(e.accessor)&&w.jsx("svg",{className:"w-4 h-4 transform transition-transform "+("desc"===p?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 15l7-7 7 7"})})]})},t))})}),w.jsx("tbody",{children:a?w.jsx("tr",{children:w.jsx("td",{colSpan:s.length,className:"text-center p-12",children:w.jsx(Se,{text:"جاري التحميل..."})})}):b.length>0?b.map((e,t)=>w.jsx("tr",{className:"border-b border-slate-700/50 table-row-hover "+(o?"cursor-pointer":""),onClick:()=>null==o?void 0:o(e),children:s.map((t,s)=>w.jsx("td",{className:`px-3 sm:px-4 md:px-6 py-3 md:py-4 ${t.className||""}`,children:N(e,t)},s))},e.id)):w.jsx("tr",{children:w.jsx("td",{colSpan:s.length,className:"p-8",children:w.jsx(Ae,{icon:w.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),title:n,description:c?"جرب تعديل كلمات البحث":""})})})})]})}),!a&&y>1&&w.jsx("div",{className:"px-3 sm:px-4 md:px-6 py-3 md:py-4 bg-slate-800/50 border-t border-slate-700/50",children:w.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[w.jsxs("div",{className:"text-xs sm:text-sm text-slate-400 order-2 sm:order-1",children:["عرض ",(m-1)*i+1," إلى"," ",Math.min(m*i,f.length)," من"," ",f.length," نتيجة"]}),w.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 order-1 sm:order-2",children:[w.jsx("button",{onClick:()=>x(Math.max(1,m-1)),disabled:1===m,className:"px-2 sm:px-3 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-white",children:w.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),w.jsx("div",{className:"flex items-center gap-0.5 sm:gap-1",children:Array.from({length:Math.min(5,y)},(e,t)=>{let s;return s=y<=5||m<=3?t+1:m>=y-2?y-4+t:m-2+t,w.jsx("button",{onClick:()=>x(s),className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg transition-all text-xs sm:text-sm "+(m===s?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg":"bg-slate-700 hover:bg-slate-600 text-slate-300"),children:s},t)})}),w.jsx("button",{onClick:()=>x(Math.min(y,m+1)),disabled:m===y,className:"px-2 sm:px-3 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-white",children:w.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]})]})})]})]})}),Me=a.memo(({children:e,variant:s="default",size:a="md",className:r=""})=>{const l=t.useMemo(()=>({default:"bg-slate-600/20 text-slate-300 border border-slate-600/50",success:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/50",warning:"bg-amber-500/20 text-amber-400 border border-amber-500/50",danger:"bg-red-500/20 text-red-400 border border-red-500/50",info:"bg-cyan-500/20 text-cyan-400 border border-cyan-500/50"}),[]),n=t.useMemo(()=>({sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-xs",lg:"px-3 py-1.5 text-sm"}),[]);return w.jsx("span",{className:`inline-flex items-center justify-center font-medium rounded-full transition-all duration-200 ${l[s]} ${n[a]} ${r}`,children:e})}),Ee=({isOpen:e,onClose:a,title:r,children:l,size:n="md",footer:i})=>{if(t.useEffect(()=>{if(!e)return;const t=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=t}},[e]),t.useEffect(()=>{if(!e)return;const t=e=>{"Escape"===e.key&&a()};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,a]),!e||"undefined"==typeof document)return null;const o=w.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 sm:p-4 bg-black/70 backdrop-blur-sm animate-fade-in",onClick:a,children:w.jsxs("div",{className:`relative w-full ${{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[n]} bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700/50 rounded-xl sm:rounded-2xl shadow-2xl animate-scale-in max-h-[90vh] flex flex-col`,onClick:e=>e.stopPropagation(),children:[r&&w.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-3 sm:py-4 border-b border-slate-700/50 flex-shrink-0",children:[w.jsx("h2",{className:"text-lg sm:text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-400",children:r}),w.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white transition-colors p-1 rounded-lg hover:bg-slate-700/50",children:w.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),w.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 overflow-y-auto custom-scrollbar flex-1",children:l}),i&&w.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-t border-slate-700/50 bg-slate-800/50 flex-shrink-0",children:i})]})});return s.createPortal(o,document.body)},$e=()=>{const[e,s]=t.useState([]),a=t.useCallback(e=>{const t=Date.now();s(s=>[...s,{...e,id:t}])},[]),r=t.useCallback(e=>{s(t=>t.filter(t=>t.id!==e))},[]);return{toasts:e,showToast:a,removeToast:r,success:(e,t)=>a({message:e,type:"success",duration:t}),error:(e,t)=>a({message:e,type:"error",duration:t}),warning:(e,t)=>a({message:e,type:"warning",duration:t}),info:(e,t)=>a({message:e,type:"info",duration:t})}},Pe=({message:e,type:s="info",onClose:a,duration:r=3e3,offset:l=0})=>{t.useEffect(()=>{const e=setTimeout(a,r);return()=>clearTimeout(e)},[r,a]);const n={success:w.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:w.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),error:w.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:w.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),warning:w.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:w.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),info:w.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:w.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})},i=24+88*l;return w.jsxs("div",{className:`\n        fixed right-6 z-50\n        flex items-center gap-3 px-5 py-3 rounded-lg\n        ${{success:"bg-gradient-to-r from-emerald-500/90 to-green-500/90 border-emerald-400/50",error:"bg-gradient-to-r from-red-500/90 to-rose-500/90 border-red-400/50",warning:"bg-gradient-to-r from-amber-500/90 to-orange-500/90 border-amber-400/50",info:"bg-gradient-to-r from-cyan-500/90 to-blue-500/90 border-cyan-400/50"}[s]} backdrop-blur-md\n        border shadow-2xl\n        animate-slide-up\n        max-w-md\n      `,style:{top:`${i}px`},children:[w.jsx("div",{className:"flex-shrink-0",children:n[s]}),w.jsx("p",{className:"text-white font-medium text-sm flex-1",children:e}),w.jsx("button",{onClick:a,className:"flex-shrink-0 text-white/80 hover:text-white transition-colors",children:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})},We="https://sahtee.evra-co.com/storage",Be=e=>{if(!e||""===e.trim())return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;const t=e.replace(/^\/+/,"").trim();return""===t?null:`${We}/${t}`},Te=e=>{if(!e||""===e.trim())return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;const t=e.replace(/^\/+/,"").trim();return""===t?null:`${We}/${t}`},Re=e=>{if(!e||""===e.trim())return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;let t=e.replace(/^\/+/,"").replace(/^storage\//,"");return""===t?null:t.startsWith("specializations/")||t.startsWith("images/specializations/")||t.includes("/")?`${We}/${t}`:`${We}/images/specializations/${t}`},De=()=>{var e,s,a,r,l,n,i,o,c,d,m,x,u;const[h,p]=t.useState("doctor"),[g,v]=t.useState([]),[j,f]=t.useState([]),[b,y]=t.useState(!0),[N,k]=t.useState(null),{toasts:C,removeToast:_,success:L,error:A,warning:S}=$e(),[z,M]=t.useState(null),[E,$]=t.useState(!1),[P,W]=t.useState(null);t.useEffect(()=>{var e,t,s,a;if(N&&N.nurse){const r=(null==(e=N.nurse)?void 0:e.license_image_path)||(null==(t=N.nurse)?void 0:t.license_image)||(null==(s=N.nurse)?void 0:s.license)||(null==(a=N.nurse)?void 0:a.license_path);if(r){const e=Be(r);if(M(e),W(null),e){$(!0);const t=setTimeout(()=>{},3e4),s=new Image;let a=!1;return s.onload=()=>{a||(a=!0,clearTimeout(t),$(!1),W(null))},s.onerror=e=>{},setTimeout(()=>{s.src=e},100),()=>{clearTimeout(t)}}$(!1)}else M(null),$(!1),W(null)}else M(null),$(!1),W(null)},[N]);const B=t.useCallback(async()=>{var e,t,s,a,r,l,n,i;y(!0);try{const o=await H.post("/admin/get-pending-accounts",{role:h});let c=[];Array.isArray(o)?c=o:Array.isArray(null==o?void 0:o.data)?c=o.data:Array.isArray(null==(e=null==o?void 0:o.data)?void 0:e.data)?c=o.data.data:Array.isArray(null==o?void 0:o.accounts)?c=o.accounts:Array.isArray(null==o?void 0:o.pending_accounts)?c=o.pending_accounts:Array.isArray(null==(t=null==o?void 0:o.data)?void 0:t.accounts)?c=o.data.accounts:Array.isArray(null==(s=null==o?void 0:o.data)?void 0:s.pending_accounts)?c=o.data.pending_accounts:Array.isArray(null==(r=null==(a=null==o?void 0:o.data)?void 0:a.data)?void 0:r.data)?c=o.data.data.data:Array.isArray(null==(n=null==(l=null==o?void 0:o.data)?void 0:l.data)?void 0:n.accounts)&&(c=o.data.data.accounts),!c.length&&Array.isArray(null==o?void 0:o.data)&&(c=o.data),!c.length&&Array.isArray(null==(i=null==o?void 0:o.data)?void 0:i.data)&&(c=o.data.data),!c.length&&Array.isArray(null==o?void 0:o.data)&&(c=o.data),!c.length&&Array.isArray(null==o?void 0:o.data)&&(c=o.data),!c.length&&Array.isArray(null==o?void 0:o.data)&&(c=o.data),Array.isArray(c)||(c=[]);const d=c.filter(e=>"doctor"===h?!!e.doctor&&!e.nurse:"nurse"===h&&(!!e.nurse&&!e.doctor));v(d)}catch(o){A("فشل تحميل طلبات الموافقة"),v([])}finally{y(!1)}},[h]);t.useEffect(()=>{B()},[B]),t.useEffect(()=>{(async()=>{var e,t;try{const s=await H.get("/admin/specializations");let a=[];Array.isArray(s)?a=s:Array.isArray(s.data)?a=s.data:(null==(e=s.data)?void 0:e.data)&&Array.isArray(s.data.data)?a=s.data.data:(null==(t=s.data)?void 0:t.specializations)&&(a=s.data.specializations),f(a)}catch(s){429!==(null==s?void 0:s.status)&&A("فشل تحميل التخصصات")}})()},[A]);const T=e=>{if(!e)return"غير محدد";const t=j.find(t=>t.id===e);return(null==t?void 0:t.name_ar)||"غير محدد"},R=async e=>{try{if("doctor"===h)try{await H.get(`/admin/approveDoctor/${e}`)}catch(t){await H.get(`/admin/approveAccount/${e}`)}else await H.get(`/admin/approveAccount/${e}`);v(t=>t.filter(t=>t.id!==e)),L("تمت الموافقة على الحساب بنجاح")}catch(t){A(`فشلت الموافقة: ${(null==t?void 0:t.message)||"حدث خطأ غير متوقع"}`)}},D=async e=>{if(!window.confirm("هل أنت متأكد من رفض هذا الحساب؟"))return;try{await(async()=>{try{return void(await H.post(`/admin/rejectAccount/${e}`))}catch(t){await H.post("/admin/rejectAccount",{id:e})}})(),v(t=>t.filter(t=>t.id!==e)),S("تم رفض الحساب")}catch(t){A(`فشل رفض الحساب: ${(null==t?void 0:t.message)||"حدث خطأ غير متوقع"}`)}},I=[{header:"الاسم الكامل",accessor:e=>{var t,s;return(null==(t=e.doctor)?void 0:t.full_name)||(null==(s=e.nurse)?void 0:s.full_name)||"غير متوفر"},sortable:!0,className:"font-medium text-white"},{header:"البريد الإلكتروني",accessor:"email"},{header:"رقم الهاتف",accessor:"phone_number"},{header:"التخصص",accessor:e=>{var t;return w.jsxs("div",{className:"text-sm",children:[e.doctor&&w.jsx(Me,{variant:"info",size:"sm",children:(null==(t=e.doctor.specialization)?void 0:t.name_ar)||T(e.doctor.specialization_id)}),e.nurse&&w.jsx(Me,{variant:"success",size:"sm",children:e.nurse.graduation_type})]})}},{header:"تاريخ الطلب",accessor:e=>new Date(e.created_at).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"}),sortable:!0},{header:"الإجراءات",accessor:e=>w.jsxs("div",{className:"flex gap-2 flex-wrap",children:[w.jsx(Q,{size:"sm",variant:"primary",onClick:t=>{t.stopPropagation(),k(e)},icon:w.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),children:"عرض"}),w.jsx(Q,{size:"sm",variant:"success",onClick:t=>{t.stopPropagation(),R(e.id)},icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),children:"موافقة"}),w.jsx(Q,{size:"sm",variant:"danger",onClick:t=>{t.stopPropagation(),D(e.id)},icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),children:"رفض"})]})}];return w.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"طلبات الموافقة"}),w.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"مراجعة والموافقة على طلبات الانضمام للنظام"})]}),w.jsxs(Me,{variant:"warning",size:"lg",children:[g.length," طلب معلق"]})]}),w.jsxs("div",{className:"flex gap-1 sm:gap-2 p-1 bg-slate-800/50 rounded-lg border border-slate-700/50 w-full sm:w-fit overflow-x-auto",children:[w.jsx(Ie,{title:"الأطباء",isActive:"doctor"===h,onClick:()=>p("doctor"),icon:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),w.jsx(Ie,{title:"الممرضون",isActive:"nurse"===h,onClick:()=>p("nurse"),icon:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]}),w.jsx(ze,{data:g,columns:I,loading:b,searchable:!0,searchPlaceholder:"ابحث في طلبات الموافقة...",emptyMessage:`لا توجد طلبات موافقة من ${"doctor"===h?"الأطباء":"الممرضين"} حالياً`,itemsPerPage:10}),w.jsx(Ee,{isOpen:!!N,onClose:()=>k(null),title:"تفاصيل "+("doctor"===h?"الطبيب":"الممرض"),size:"lg",footer:w.jsxs("div",{className:"flex gap-3 justify-end",children:[w.jsx(Q,{variant:"danger",onClick:()=>{N&&(D(N.id),k(null))},icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),children:"رفض الحساب"}),w.jsx(Q,{variant:"success",onClick:()=>{N&&(R(N.id),k(null))},icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),children:"الموافقة على الحساب"})]}),children:N&&w.jsxs("div",{className:"space-y-6",children:[w.jsx("div",{className:"bg-gradient-to-r from-cyan-500/10 to-blue-500/10 rounded-xl p-4 sm:p-6 border border-cyan-500/30",children:w.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 sm:gap-6",children:[w.jsxs("div",{className:"flex-shrink-0",children:[(null==(e=N.doctor)?void 0:e.profile_image)||(null==(s=N.nurse)?void 0:s.profile_image)?w.jsx("img",{src:(null==(a=N.doctor)?void 0:a.profile_image)||(null==(r=N.nurse)?void 0:r.profile_image),alt:(null==(l=N.doctor)?void 0:l.full_name)||(null==(n=N.nurse)?void 0:n.full_name),className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full object-cover border-4 border-cyan-400 shadow-lg shadow-cyan-500/50",onError:e=>{var t;e.currentTarget.style.display="none",null==(t=e.currentTarget.nextElementSibling)||t.classList.remove("hidden")}}):null,w.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center border-4 border-cyan-400 shadow-lg shadow-cyan-500/50 "+((null==(i=N.doctor)?void 0:i.profile_image)||(null==(o=N.nurse)?void 0:o.profile_image)?"hidden":""),children:w.jsx("svg",{className:"w-12 h-12 sm:w-16 sm:h-16 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]}),w.jsxs("div",{className:"flex-1 text-center sm:text-right space-y-2",children:[w.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white",children:(null==(c=N.doctor)?void 0:c.full_name)||(null==(d=N.nurse)?void 0:d.full_name)||"غير متوفر"}),N.doctor&&w.jsx("div",{className:"flex items-center justify-center sm:justify-start gap-2",children:w.jsx(Me,{variant:"info",size:"lg",children:w.jsxs("span",{className:"flex items-center gap-2",children:[w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(null==(m=N.doctor.specialization)?void 0:m.name_ar)||T(N.doctor.specialization_id)]})})}),N.nurse&&w.jsx("div",{className:"flex items-center justify-center sm:justify-start gap-2",children:w.jsx(Me,{variant:"success",size:"lg",children:w.jsxs("span",{className:"flex items-center gap-2",children:[w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),N.nurse.graduation_type]})})})]})]})}),w.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[w.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"المعلومات الشخصية"]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[w.jsx(Ve,{label:"البريد الإلكتروني",value:N.email}),w.jsx(Ve,{label:"رقم الهاتف",value:N.phone_number}),w.jsx(Ve,{label:"تاريخ التسجيل",value:new Date(N.created_at).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),N.doctor&&w.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[w.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"المعلومات المهنية"]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[w.jsx(Ve,{label:"التخصص",value:w.jsx(Me,{variant:"info",size:"md",children:(null==(x=N.doctor.specialization)?void 0:x.name_ar)||T(N.doctor.specialization_id)})}),w.jsx(Ve,{label:"العنوان",value:N.doctor.address}),N.doctor.age&&w.jsx(Ve,{label:"العمر",value:`${N.doctor.age} سنة`}),N.doctor.gender&&w.jsx(Ve,{label:"الجنس",value:"male"===N.doctor.gender?"ذكر":"أنثى"}),N.doctor.profile_description&&w.jsx("div",{className:"sm:col-span-2",children:w.jsx(Ve,{label:"الوصف الشخصي",value:N.doctor.profile_description})}),N.doctor.instructions_before_booking&&w.jsx("div",{className:"sm:col-span-2",children:w.jsx(Ve,{label:"تعليمات قبل الحجز",value:N.doctor.instructions_before_booking})}),"nurse"===h&&w.jsxs("div",{className:"sm:col-span-2",children:[w.jsx("p",{className:"text-xs sm:text-sm text-slate-400 font-medium mb-2",children:"صورة رخصة الممرضة"}),!1,E&&!z?w.jsx("div",{className:"flex items-center justify-center p-6 bg-slate-700/50 rounded-lg border border-slate-600",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-cyan-400 mx-auto mb-2"}),w.jsx("p",{className:"text-slate-400 text-sm",children:"جاري التحميل..."}),w.jsx("p",{className:"text-slate-500 text-xs mt-1",children:"يرجى الانتظار، قد يستغرق الأمر بضع لحظات"})]})}):P&&!z?w.jsx("div",{className:"flex items-center justify-center p-6 bg-red-900/20 rounded-lg border border-red-600",children:w.jsxs("div",{className:"text-center",children:[w.jsx("svg",{className:"w-10 h-10 text-red-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w.jsx("p",{className:"text-red-400 text-sm font-medium",children:P}),z&&w.jsx("button",{onClick:()=>{z&&window.open(z,"_blank")},className:"mt-2 px-3 py-1.5 bg-red-600 hover:bg-red-700 rounded-lg text-white text-xs font-medium transition-colors",children:"محاولة فتح الرابط"})]})}):z?w.jsxs("div",{className:"relative group",children:[w.jsx("img",{src:z,alt:"doctor"===h?"رخصة طبية":"رخصة ممرضة",className:"w-full max-w-md rounded-lg border-2 border-slate-600 hover:border-cyan-400 transition-all duration-300 cursor-pointer shadow-lg",onClick:()=>{z&&window.open(z,"_blank")},onLoad:()=>{$(!1),W(null)},onError:e=>{const t=e.currentTarget,s=parseInt(t.dataset.retryCount||"0");if(s<3){t.dataset.retryCount=String(s+1);setTimeout(()=>{const e=(null==z?void 0:z.includes("?"))?"&":"?";t.src=`${z}${e}_retry=${Date.now()}`},[2e3,5e3,1e4][s])}else W("فشل تحميل صورة الرخصة بعد عدة محاولات"),$(!1)},loading:"lazy"}),w.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-all duration-300 rounded-lg flex items-center justify-center pointer-events-none",children:w.jsx("svg",{className:"w-10 h-10 text-white opacity-0 group-hover:opacity-100 transition-all duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})})})]}):w.jsx("div",{className:"flex items-center justify-center p-6 bg-slate-700/50 rounded-lg border border-slate-600",children:w.jsxs("div",{className:"text-center",children:[w.jsx("svg",{className:"w-10 h-10 text-slate-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),w.jsx("p",{className:"text-slate-400 text-sm mb-3",children:"لا توجد صورة رخصة متاحة"}),N&&(null==(u=N.nurse)?void 0:u.id)&&w.jsxs("button",{onClick:async()=>{var e;try{$(!0),W(null);const t=await H.get(`/admin/nurse/${null==(e=N.nurse)?void 0:e.id}/license`,{skipAuth:!1});if(t instanceof Blob){const e=URL.createObjectURL(t);M(e),$(!1),window.open(e,"_blank")}else t.url?(M(t.url),$(!1),window.open(t.url,"_blank")):($(!1),W("لم يتم العثور على صورة الرخصة"))}catch(t){$(!1),W("فشل تحميل صورة الرخصة من API")}},className:"px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 rounded-lg text-white text-xs font-medium transition-colors flex items-center gap-2 mx-auto",children:[w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"تحميل من API"]})]})})]})]})]}),N.nurse&&w.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[w.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"المعلومات المهنية"]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[w.jsx(Ve,{label:"نوع التخرج",value:w.jsx(Me,{variant:"success",size:"md",children:N.nurse.graduation_type})}),w.jsx(Ve,{label:"العنوان",value:N.nurse.address}),N.nurse.age&&w.jsx(Ve,{label:"العمر",value:`${N.nurse.age} سنة`}),N.nurse.gender&&w.jsx(Ve,{label:"الجنس",value:"male"===N.nurse.gender?"ذكر":"أنثى"}),N.nurse.profile_description&&w.jsx("div",{className:"sm:col-span-2",children:w.jsx(Ve,{label:"الوصف الشخصي",value:N.nurse.profile_description})})]})]}),w.jsx("div",{className:"flex items-center justify-center",children:w.jsx(Me,{variant:"approved"===N.is_approved?"success":"rejected"===N.is_approved?"danger":"warning",size:"lg",children:"approved"===N.is_approved?"✓ تمت الموافقة":"rejected"===N.is_approved?"✗ مرفوض":"⏳ قيد الانتظار"})})]})}),C.map((e,t)=>w.jsx(Pe,{message:e.message,type:e.type,duration:e.duration,offset:t,onClose:()=>_(e.id)},e.id))]})},Ie=({title:e,isActive:t,onClick:s,icon:a})=>w.jsxs("button",{onClick:s,className:"px-4 sm:px-6 py-2 sm:py-3 rounded-lg font-semibold text-xs sm:text-sm transition-all duration-200 flex items-center gap-1 sm:gap-2 whitespace-nowrap "+(t?"bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg shadow-cyan-500/30":"text-slate-400 hover:text-white hover:bg-slate-700/50"),children:[w.jsx("span",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",children:a}),e]}),Ve=({label:e,value:t})=>w.jsxs("div",{className:"space-y-1",children:[w.jsx("p",{className:"text-xs sm:text-sm text-slate-400 font-medium",children:e}),w.jsx("p",{className:"text-sm sm:text-base text-white font-semibold",children:t||w.jsx("span",{className:"text-slate-500",children:"غير متوفر"})})]});async function He(e,t,s){if(!e.length)return[];const a=new Array(e.length);let r=0;const l=[],n=async()=>{for(;r<e.length;){const t=r++;a[t]=await s(e[t],t)}},i=Math.min(t,e.length);for(let o=0;o<i;o++)l.push(n());return await Promise.all(l),a}function Oe(e){if(null==e?void 0:e.aborted)throw new DOMException("Aborted","AbortError")}const Fe=()=>{const e=l(),[s,a]=t.useState(1),[r,n]=t.useState({data:[],loading:!0,totalPages:1,total:0}),[i,o]=t.useState(""),[c,d]=t.useState(""),[m,x]=t.useState({active:!1,loading:!1,data:[],total:0,error:""}),[u,h]=t.useState(0),p=t.useRef(null),g=t.useRef(null),v=t.useRef(null),j=t.useCallback(async(e,t,s)=>{const a=(e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([e,s])=>{null!=s&&""!==s&&t.append(e,String(s))}),t.toString()})({page:e,per_page:t});return(e=>{var t,s,a,r,l,n;let i=[null==e?void 0:e.doctors,null==e?void 0:e.data,e].find(e=>null!=e);i&&"object"==typeof i&&"doctors"in i&&(i=i.doctors);let o=[];Array.isArray(null==i?void 0:i.data)?o=i.data:Array.isArray(i)?o=i:Array.isArray(null==(t=null==e?void 0:e.doctors)?void 0:t.data)?o=e.doctors.data:Array.isArray(null==(s=null==e?void 0:e.data)?void 0:s.data)?o=e.data.data:Array.isArray(null==e?void 0:e.data)?o=e.data:Array.isArray(e)&&(o=e);const c=(null==i?void 0:i.current_page)??(null==e?void 0:e.current_page)??(null==(a=null==e?void 0:e.data)?void 0:a.current_page)??1,d=(null==i?void 0:i.last_page)??(null==e?void 0:e.last_page)??(null==(r=null==e?void 0:e.data)?void 0:r.last_page)??c,m=(null==i?void 0:i.total)??(null==e?void 0:e.total)??(null==(l=null==e?void 0:e.data)?void 0:l.total)??o.length,x=(null==i?void 0:i.per_page)??(null==e?void 0:e.per_page)??(null==(n=null==e?void 0:e.data)?void 0:n.per_page)??o.length;return{items:o,currentPage:Number(c)||1,lastPage:Number(d)||1,total:Number(m)||o.length,perPage:Number(x)||o.length}})(await H.get(`/admin/doctor/all?${a}`,{signal:s}))},[]),f=t.useCallback(async e=>{if(p.current)return p.current;if(g.current)return g.current;const t=(async()=>{Oe(e);const t=[],{items:s,lastPage:a,total:r,perPage:l}=await j(1,200,e);t.push(...s);const n=l||200,i=r||t.length,o=n>0?Math.ceil(i/n):1,c=Math.max(a||1,o||1);if(c>1){const s=Array.from({length:c-1},(e,t)=>t+2);(await He(s,4,async t=>{Oe(e);const{items:s}=await j(t,200,e);return s})).forEach(e=>{t.push(...e)})}return p.current=t,t})();g.current=t;try{const e=await t;return g.current=null,e}catch(s){throw g.current=null,(null==e?void 0:e.aborted)||(p.current=null),s}},[j,u]);t.useEffect(()=>{const e=setTimeout(()=>{d(i.trim())},350);return()=>clearTimeout(e)},[i]),t.useEffect(()=>{if(c){v.current&&v.current.abort();const e=new AbortController;return v.current=e,x({active:!0,loading:!0,data:[],total:0,error:""}),f(e.signal).then(t=>{if(e.signal.aborted)return;const s=t.filter(e=>((e,t)=>{var s,a,r,l;const n=t.trim().toLowerCase();return!n||[e.full_name,null==(s=e.account)?void 0:s.email,null==(a=e.account)?void 0:a.phone_number,null==(r=e.specialization)?void 0:r.name_ar,null==(l=e.specialization)?void 0:l.name_en,e.address].filter(e=>!!e).some(e=>e.toLowerCase().includes(n))})(e,c));x({active:!0,loading:!1,data:s,total:s.length,error:""})}).catch(()=>{e.signal.aborted||x({active:!0,loading:!1,data:[],total:0,error:"تعذر تحميل البيانات. يرجى المحاولة مرة أخرى."})}).finally(()=>{v.current===e&&(v.current=null)}),()=>e.abort()}v.current&&(v.current.abort(),v.current=null),x({active:!1,loading:!1,data:[],total:0,error:""})},[c,f,u]),t.useEffect(()=>{if(c||p.current||g.current)return;const e=new AbortController,t=window.setTimeout(()=>{f(e.signal).catch(()=>{e.abort()})},800);return()=>{e.abort(),window.clearTimeout(t)}},[c,f]),t.useEffect(()=>{if(c)return;const e=new AbortController;return n(e=>({...e,loading:!0})),j(s,25,e.signal).then(({items:t,lastPage:s,total:a})=>{e.signal.aborted||n({data:t,loading:!1,totalPages:s,total:a})}).catch(()=>{e.signal.aborted||n(e=>({...e,loading:!1}))}),()=>e.abort()},[c,s,j]);const b=e=>{m.active||e>=1&&e<=r.totalPages&&(a(e),window.scrollTo({top:0,behavior:"smooth"}))},y=[{header:"الاسم الكامل",accessor:"full_name",sortable:!0,className:"font-medium text-white"},{header:"التخصص",accessor:e=>{var t;return(null==(t=e.specialization)?void 0:t.name_ar)||"-"},sortable:!0},{header:"البريد الإلكتروني",accessor:e=>{var t;return(null==(t=e.account)?void 0:t.email)||"-"}},{header:"رقم الهاتف",accessor:e=>{var t;return(null==(t=e.account)?void 0:t.phone_number)||"-"}},{header:"الجنس",accessor:e=>w.jsx(Me,{variant:"info",size:"sm",children:"male"===e.gender?"ذكر":"أنثى"})},{header:"الإجراءات",accessor:t=>w.jsx(Q,{size:"sm",variant:"primary",onClick:s=>{s.stopPropagation(),e(`/doctors/${t.id}`)},children:"عرض التفاصيل"})}],N=m.active?m.total:r.total,k=m.active?m.data:r.data,C=m.active?m.loading:r.loading,_=m.active?m.loading?"جاري البحث في الأطباء...":m.error||"لم يتم العثور على نتائج مطابقة.":"لا يوجد أطباء مسجلين",L=m.active?Math.max(k.length,1):25;return w.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة الأطباء"}),w.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع الأطباء المسجلين في النظام"})]}),w.jsx("div",{className:"flex items-center gap-2",children:w.jsx(Me,{variant:"info",size:"lg",children:C?"...":`${N} طبيب`})})]}),w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[w.jsx(X,{value:i,onChange:e=>o(e.target.value),placeholder:"ابحث في جميع الأطباء بالاسم، التخصص، البريد، الهاتف...",icon:w.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),c&&w.jsxs("div",{className:"mt-2 text-sm text-slate-400 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[m.loading?w.jsxs("span",{className:"flex items-center gap-2",children:[w.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري تحميل جميع الأطباء لضمان دقة النتائج..."]}):w.jsx("span",{children:m.total>0?`تم العثور على ${m.total} طبيب مطابق`:"لم يتم العثور على نتائج مطابقة"}),m.error&&w.jsx("span",{className:"text-red-400",children:m.error})]})]}),w.jsx(ze,{data:k,columns:y,loading:C,searchable:!1,emptyMessage:_,itemsPerPage:L,onRowClick:t=>e(`/doctors/${t.id}`)},m.active?"search-results":`page-${s}`),!m.active&&r.totalPages>1&&w.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[w.jsxs("div",{className:"text-sm text-slate-400",children:["الصفحة ",s," من ",r.totalPages," (",r.total," طبيب إجمالاً)"]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>b(1),disabled:1===s||r.loading,children:"الأولى"}),w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>b(s-1),disabled:1===s||r.loading,icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"السابقة"}),w.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,r.totalPages)},(e,t)=>{let a;return a=r.totalPages<=5||s<=3?t+1:s>=r.totalPages-2?r.totalPages-4+t:s-2+t,w.jsx(Q,{variant:s===a?"primary":"secondary",size:"sm",onClick:()=>b(a),disabled:r.loading,className:"min-w-[40px]",children:a},a)})}),w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>b(s+1),disabled:s===r.totalPages||r.loading,icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),children:"التالية"}),w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>b(r.totalPages),disabled:s===r.totalPages||r.loading,children:"الأخيرة"})]})]})]})},Ue=()=>{var e,s,a,r,n;const{id:o}=i(),c=l(),[d,m]=t.useState(null),[x,u]=t.useState([]),[h,p]=t.useState(!0),[g,v]=t.useState(!0),[j,f]=t.useState(null),[b,y]=t.useState(!1),[N,k]=t.useState(null),[C,_]=t.useState(""),[L,A]=t.useState(""),[S,z]=t.useState(""),[M,E]=t.useState({pending:0,approved:0,cancelled:0,completed:0,total:0});t.useEffect(()=>{$()},[o]),t.useEffect(()=>{o&&P()},[o,C,L,S]),t.useEffect(()=>{let e=null,t=!0;return d&&o&&(y(!0),k(null),H.getDoctorLicense(o).then(s=>{if(!t)return void URL.revokeObjectURL(URL.createObjectURL(s));const a=URL.createObjectURL(s);e=a,f(a),y(!1)}).catch(e=>{t&&(404===e.status?(k(null),f(null)):k(e.message||"فشل تحميل صورة الرخصة"),y(!1))})),()=>{t=!1,e&&URL.revokeObjectURL(e),f(t=>(t&&t!==e&&URL.revokeObjectURL(t),null))}},[d,o]);const $=async()=>{p(!0);try{const e=await H.get(`/admin/doctor/${o}`),t=e.doctor||e;m(t)}catch(e){}finally{p(!1)}},P=async()=>{v(!0);try{const e=new URLSearchParams;C&&e.append("status",C),L&&e.append("from",L),S&&e.append("to",S);const t=await H.get(`/admin/doctor/${o}/reservations?${e.toString()}`),s=t.data||t.reservations||t;u(Array.isArray(s)?s:[]),W(s)}catch(e){u([])}finally{v(!1)}},W=e=>{const t={pending:0,approved:0,cancelled:0,completed:0,total:e.length};e.forEach(e=>{e.status in t&&t[e.status]++}),E(t)};return h?w.jsx("div",{className:"flex justify-center items-center h-64",children:w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-400"})}):d?w.jsxs("div",{className:"space-y-6",children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsxs("button",{onClick:()=>c("/doctors"),className:"flex items-center gap-2 px-4 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-cyan-500 rounded-lg transition-all duration-200 group",children:[w.jsx("svg",{className:"w-5 h-5 text-cyan-400 group-hover:text-cyan-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),w.jsx("span",{className:"text-slate-300 group-hover:text-white font-medium transition-colors",children:"رجوع"})]}),w.jsxs("h1",{className:"text-3xl font-bold text-slate-100",children:["تفاصيل الطبيب - ",d.full_name]})]})}),w.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[w.jsxs("div",{className:"lg:col-span-2 bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[d.profile_image&&Te(d.profile_image)&&w.jsx("div",{className:"mb-6 flex justify-center",children:w.jsx("img",{src:Te(d.profile_image),alt:d.full_name,className:"w-32 h-32 rounded-full object-cover border-4 border-cyan-400 shadow-lg shadow-cyan-500/50 cursor-pointer hover:border-cyan-300 transition-all",onClick:()=>window.open(Te(d.profile_image),"_blank"),onError:e=>{e.currentTarget.style.display="none"}})}),w.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"المعلومات الأساسية"}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"رقم المعرف"}),w.jsxs("p",{className:"text-white font-medium",children:["#",d.id]})]}),d.account_id&&w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"رقم حساب المستخدم"}),w.jsxs("p",{className:"text-white font-medium",children:["#",d.account_id]})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"الاسم الكامل"}),w.jsx("p",{className:"text-white font-medium",children:d.full_name})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"التخصص"}),w.jsx("p",{className:"text-white font-medium",children:(null==(e=d.specialization)?void 0:e.name_ar)||(d.specialization_id?`#${d.specialization_id}`:"-")})]}),d.specialization_id&&w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"رقم التخصص"}),w.jsxs("p",{className:"text-white font-medium",children:["#",d.specialization_id]})]}),d&&w.jsxs("div",{className:"col-span-2",children:[w.jsx("p",{className:"text-slate-400 text-sm mb-2",children:"رخصة الطبيب"}),b?w.jsx("div",{className:"flex justify-center items-center h-48 bg-slate-700/30 rounded-lg border border-slate-600",children:w.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-cyan-400"})}):N?w.jsxs("div",{className:"text-center p-4 bg-slate-700/30 rounded-lg border border-red-500/50",children:[w.jsxs("p",{className:"text-red-400 text-sm mb-2",children:["⚠️ ",N]}),w.jsx("button",{onClick:()=>{o&&(k(null),y(!0),H.getDoctorLicense(o).then(e=>{const t=URL.createObjectURL(e);f(t),y(!1)}).catch(e=>{404===e.status?k("صورة الرخصة غير متوفرة"):k(e.message||"فشل تحميل صورة الرخصة"),y(!1)}))},className:"px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 rounded text-xs",children:"إعادة المحاولة"})]}):j?w.jsxs("div",{className:"relative group inline-block",children:[w.jsx("img",{src:j,alt:"رخصة الطبيب",className:"w-48 h-48 rounded-lg object-cover border-2 border-slate-600 hover:border-cyan-400 transition-all duration-300 cursor-pointer",onClick:()=>{const e=window.open();e&&e.document.write(`\n                                                        <html>\n                                                            <head>\n                                                                <title>رخصة الطبيب - ${null==d?void 0:d.full_name}</title>\n                                                                <style>\n                                                                    body {\n                                                                        margin: 0;\n                                                                        padding: 20px;\n                                                                        background: #1e293b;\n                                                                        display: flex;\n                                                                        justify-content: center;\n                                                                        align-items: center;\n                                                                        min-height: 100vh;\n                                                                    }\n                                                                    img {\n                                                                        max-width: 100%;\n                                                                        max-height: 100vh;\n                                                                        border-radius: 8px;\n                                                                        box-shadow: 0 10px 30px rgba(0,0,0,0.5);\n                                                                    }\n                                                                </style>\n                                                            </head>\n                                                            <body>\n                                                                <img src="${j}" alt="رخصة الطبيب" />\n                                                            </body>\n                                                        </html>\n                                                    `)}}),w.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-all duration-300 rounded-lg flex items-center justify-center pointer-events-none",children:w.jsx("svg",{className:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-all duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})})})]}):w.jsx("div",{className:"text-center p-4 bg-slate-700/30 rounded-lg border border-slate-600",children:w.jsx("p",{className:"text-slate-400 text-sm",children:"لا توجد صورة رخصة متوفرة"})})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"البريد الإلكتروني"}),w.jsx("p",{className:"text-white font-medium",children:(null==(s=d.account)?void 0:s.email)||"-"})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"رقم الهاتف"}),w.jsx("p",{className:"text-white font-medium",children:(null==(a=d.account)?void 0:a.phone_number)||"-"})]}),(null==(r=d.account)?void 0:r.created_at)&&w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"تاريخ إنشاء الحساب"}),w.jsx("p",{className:"text-white font-medium",children:new Date(d.account.created_at).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(null==(n=d.account)?void 0:n.updated_at)&&w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"تاريخ آخر تحديث للحساب"}),w.jsx("p",{className:"text-white font-medium",children:new Date(d.account.updated_at).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"العمر"}),w.jsxs("p",{className:"text-white font-medium",children:[d.age," سنة"]})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"الجنس"}),w.jsx("p",{className:"text-white font-medium",children:"male"===d.gender?"ذكر":"أنثى"})]}),w.jsxs("div",{className:"col-span-2",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"العنوان"}),w.jsx("p",{className:"text-white font-medium",children:d.address||"-"})]}),d.profile_description&&w.jsxs("div",{className:"col-span-2",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"الوصف الشخصي"}),w.jsx("p",{className:"text-white font-medium whitespace-pre-wrap",children:d.profile_description})]}),d.created_at&&w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"تاريخ الإنشاء"}),w.jsx("p",{className:"text-white font-medium",children:new Date(d.created_at).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),d.updated_at&&w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"تاريخ آخر تحديث"}),w.jsx("p",{className:"text-white font-medium",children:new Date(d.updated_at).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),d.deleted_at&&w.jsxs("div",{className:"col-span-2",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"تاريخ الحذف"}),w.jsx("p",{className:"text-red-400 font-medium",children:new Date(d.deleted_at).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]}),w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[w.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"إحصائيات الحجوزات"}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-slate-400",children:"الإجمالي"}),w.jsx("span",{className:"text-2xl font-bold text-white",children:M.total})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-yellow-400",children:"قيد الانتظار"}),w.jsx("span",{className:"font-bold text-yellow-400",children:M.pending})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-green-400",children:"موافق عليها"}),w.jsx("span",{className:"font-bold text-green-400",children:M.approved})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-blue-400",children:"مكتملة"}),w.jsx("span",{className:"font-bold text-blue-400",children:M.completed})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-gray-400",children:"ملغاة"}),w.jsx("span",{className:"font-bold text-gray-400",children:M.cancelled})]})]})]})]}),d.services&&d.services.length>0&&w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[w.jsxs("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:["الخدمات المتاحة (",d.services.length,")"]}),w.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.services.map(e=>w.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:[w.jsx("h3",{className:"text-white font-medium mb-2",children:e.name}),w.jsxs("div",{className:"flex justify-between items-center text-sm",children:[w.jsx("span",{className:"text-slate-400",children:"السعر:"}),w.jsxs("span",{className:"text-cyan-400 font-bold",children:[e.price," ل.س"]})]}),w.jsxs("div",{className:"flex justify-between items-center text-sm mt-1",children:[w.jsx("span",{className:"text-slate-400",children:"المدة:"}),w.jsxs("span",{className:"text-white",children:[e.duration_minutes," دقيقة"]})]})]},e.id))})]}),d.doctor_work_schedule&&d.doctor_work_schedule.length>0&&w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[w.jsxs("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:["أوقات العمل (",d.doctor_work_schedule.length," أيام)"]}),w.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.doctor_work_schedule.map(e=>{return w.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:[w.jsx("h3",{className:"text-white font-medium mb-2",children:(t=e.day_of_week,{sunday:"الأحد",monday:"الاثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت"}[t]||t)}),w.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse text-sm",children:[w.jsx("span",{className:"text-cyan-400",children:e.start_time}),w.jsx("span",{className:"text-slate-400",children:"-"}),w.jsx("span",{className:"text-cyan-400",children:e.end_time})]})]},e.id);var t})})]}),w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[w.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 space-y-4 md:space-y-0",children:[w.jsx("h2",{className:"text-xl font-bold text-cyan-400",children:"الحجوزات"}),w.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.jsxs("select",{value:C,onChange:e=>_(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",children:[w.jsx("option",{value:"",children:"جميع الحالات"}),w.jsx("option",{value:"pending",children:"قيد الانتظار"}),w.jsx("option",{value:"approved",children:"موافق عليها"}),w.jsx("option",{value:"completed",children:"مكتملة"}),w.jsx("option",{value:"rejected",children:"مرفوضة"}),w.jsx("option",{value:"cancelled",children:"ملغاة"})]}),w.jsx("input",{type:"date",value:L,onChange:e=>A(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",placeholder:"من تاريخ"}),w.jsx("input",{type:"date",value:S,onChange:e=>z(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",placeholder:"إلى تاريخ"}),(C||L||S)&&w.jsx("button",{onClick:()=>{_(""),A(""),z("")},className:"px-3 py-2 bg-red-600 hover:bg-red-700 rounded-md text-sm",children:"إلغاء الفلاتر"})]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full text-sm text-right text-slate-300",children:[w.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800",children:w.jsxs("tr",{children:[w.jsx("th",{scope:"col",className:"px-6 py-3",children:"#"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"المريض"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"الخدمة"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"التاريخ"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"الوقت"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"الحالة"})]})}),w.jsx("tbody",{children:g?w.jsx("tr",{children:w.jsx("td",{colSpan:6,className:"text-center p-8",children:"جاري التحميل..."})}):x.length>0?x.map(e=>{var t,s,a,r,l,n,i,o,c,d,m,x,u;const h=(null==(s=null==(t=e.user)?void 0:t.account)?void 0:s.phone_number)||(null==(a=e.user)?void 0:a.phone_number)||(null==(l=null==(r=e.user)?void 0:r.account)?void 0:l.phone)||(null==(n=e.user)?void 0:n.phone)||(null==(o=null==(i=e.user)?void 0:i.account)?void 0:o.mobile)||(null==(c=e.user)?void 0:c.mobile);return w.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-800",children:[w.jsx("td",{className:"px-6 py-4",children:e.id}),w.jsx("td",{className:"px-6 py-4",children:w.jsxs("div",{children:[w.jsx("p",{className:"font-medium",children:(null==(d=e.user)?void 0:d.full_name)||(null==(x=null==(m=e.user)?void 0:m.account)?void 0:x.full_name)||`مريض #${e.user_id}`}),w.jsxs("p",{className:"text-xs text-slate-400",children:["📞 ",h||"غير متوفر"]})]})}),w.jsx("td",{className:"px-6 py-4",children:(null==(u=e.doctor_service)?void 0:u.name)||"-"}),w.jsx("td",{className:"px-6 py-4",children:e.date}),w.jsx("td",{className:"px-6 py-4",children:w.jsxs("div",{className:"text-xs",children:[w.jsx("p",{children:e.start_time}),w.jsxs("p",{className:"text-slate-400",children:["إلى ",e.end_time]})]})}),w.jsx("td",{className:"px-6 py-4",children:(p=e.status,w.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${{pending:"bg-yellow-600",approved:"bg-green-600",rejected:"bg-red-600",cancelled:"bg-gray-600",completed:"bg-blue-600"}[p]||"bg-gray-600"}`,children:{pending:"قيد الانتظار",approved:"موافق عليها",rejected:"مرفوضة",cancelled:"ملغاة",completed:"مكتملة"}[p]||p}))})]},e.id);var p}):w.jsx("tr",{children:w.jsx("td",{colSpan:6,className:"text-center p-8",children:"لا توجد حجوزات."})})})]})})]})]}):w.jsxs("div",{className:"text-center p-8",children:[w.jsx("p",{className:"text-xl text-slate-300 mb-6",children:"لم يتم العثور على الطبيب"}),w.jsxs("button",{onClick:()=>c("/doctors"),className:"inline-flex items-center gap-2 px-6 py-3 bg-cyan-600 hover:bg-cyan-700 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-cyan-500/20",children:[w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"العودة إلى قائمة الأطباء"]})]})},qe=()=>{var e,s,a,r,n,i;const o=l(),{toasts:c,removeToast:d,success:m,error:x,warning:u}=$e(),[h,p]=t.useState(!1),[g,v]=t.useState(""),[j,f]=t.useState(!1),[b,y]=t.useState(!1),[N,k]=t.useState(null),[C,_]=t.useState(1),[L,A]=t.useState({data:[],loading:!0,totalPages:1,total:0}),[S,z]=t.useState(""),[M,E]=t.useState(""),[$,P]=t.useState({active:!1,loading:!1,data:[],total:0,error:""}),[W,B]=t.useState(0),T=t.useRef(null),R=t.useRef(null),D=t.useRef(null),I=t.useCallback(async(e,t,s)=>{const a=(e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([e,s])=>{null!=s&&""!==s&&t.append(e,String(s))}),t.toString()})({page:e,per_page:t});return(e=>{var t,s,a,r,l,n;let i=[null==e?void 0:e.hospitals,null==e?void 0:e.data,e].find(e=>null!=e);i&&"object"==typeof i&&"hospitals"in i&&(i=i.hospitals);let o=[];Array.isArray(null==i?void 0:i.data)?o=i.data:Array.isArray(i)?o=i:Array.isArray(null==(t=null==e?void 0:e.hospitals)?void 0:t.data)?o=e.hospitals.data:Array.isArray(null==(s=null==e?void 0:e.data)?void 0:s.data)?o=e.data.data:Array.isArray(null==e?void 0:e.data)?o=e.data:Array.isArray(e)&&(o=e);const c=(null==i?void 0:i.current_page)??(null==e?void 0:e.current_page)??(null==(a=null==e?void 0:e.data)?void 0:a.current_page)??1,d=(null==i?void 0:i.last_page)??(null==e?void 0:e.last_page)??(null==(r=null==e?void 0:e.data)?void 0:r.last_page)??c,m=(null==i?void 0:i.total)??(null==e?void 0:e.total)??(null==(l=null==e?void 0:e.data)?void 0:l.total)??o.length,x=(null==i?void 0:i.per_page)??(null==e?void 0:e.per_page)??(null==(n=null==e?void 0:e.data)?void 0:n.per_page)??o.length;return{items:o,currentPage:Number(c)||1,lastPage:Number(d)||1,total:Number(m)||o.length,perPage:Number(x)||o.length}})(await H.get(`/admin/hospital/all?${a}`,{signal:s}))},[]),V=t.useCallback(async e=>{if(T.current)return T.current;if(R.current)return R.current;const t=(async()=>{Oe(e);const t=[],{items:s,lastPage:a,total:r,perPage:l}=await I(1,200,e);t.push(...s);const n=l||200,i=r||t.length,o=n>0?Math.ceil(i/n):1,c=Math.max(a||1,o||1);if(c>1){const s=Array.from({length:c-1},(e,t)=>t+2);(await He(s,4,async t=>{Oe(e);const{items:s}=await I(t,200,e);return s})).forEach(e=>{t.push(...e)})}return T.current=t,t})();R.current=t;try{const e=await t;return R.current=null,e}catch(s){throw R.current=null,(null==e?void 0:e.aborted)||(T.current=null),s}},[I,W]),O=t.useCallback(()=>{T.current=null,R.current=null,B(e=>e+1)},[]);t.useEffect(()=>{const e=setTimeout(()=>{E(S.trim())},350);return()=>clearTimeout(e)},[S]),t.useEffect(()=>{if(M){D.current&&D.current.abort();const e=new AbortController;return D.current=e,P({active:!0,loading:!0,data:[],total:0,error:""}),V(e.signal).then(t=>{if(e.signal.aborted)return;const s=t.filter(e=>((e,t)=>{var s,a;const r=t.trim().toLowerCase();return!r||[e.full_name,null==(s=e.account)?void 0:s.email,null==(a=e.account)?void 0:a.phone_number,e.address].filter(e=>!!e).some(e=>e.toLowerCase().includes(r))})(e,M));P({active:!0,loading:!1,data:s,total:s.length,error:""})}).catch(()=>{e.signal.aborted||P({active:!0,loading:!1,data:[],total:0,error:"تعذر تحميل البيانات. يرجى المحاولة مرة أخرى."})}).finally(()=>{D.current===e&&(D.current=null)}),()=>e.abort()}D.current&&(D.current.abort(),D.current=null),P({active:!1,loading:!1,data:[],total:0,error:""})},[M,V,W]),t.useEffect(()=>{if(M||T.current||R.current)return;const e=new AbortController,t=window.setTimeout(()=>{V(e.signal).catch(()=>{e.abort()})},800);return()=>{e.abort(),window.clearTimeout(t)}},[M,V]),t.useEffect(()=>{if(M)return;const e=new AbortController;return A(e=>({...e,loading:!0})),I(C,25,e.signal).then(({items:t,lastPage:s,total:a})=>{e.signal.aborted||A({data:t,loading:!1,totalPages:s,total:a})}).catch(()=>{e.signal.aborted||A(e=>({...e,loading:!1}))}),()=>e.abort()},[M,C,I]);const F=e=>{$.active||e>=1&&e<=L.totalPages&&(_(e),window.scrollTo({top:0,behavior:"smooth"}))},U=async()=>{if(g.trim()){f(!0);try{const e=new FormData;e.append("hospital_name",g);const t=await H.post("/admin/create-hospital-account",e);if(!t)throw new Error("لم يتم استلام رد من الخادم");k(t),m("تم إنشاء حساب المشفى بنجاح"),v(""),p(!1),y(!0),O(),_(1)}catch(e){let t=(null==e?void 0:e.message)||"حدث خطأ غير متوقع";"Validation failed"===(null==e?void 0:e.message)||t.includes("Validation failed")?t="اسم المشفى موجود مسبقاً أو البيانات غير صحيحة":t.includes("already been taken")&&(t="اسم المشفى موجود مسبقاً، يرجى استخدام اسم آخر"),x(t)}finally{f(!1)}}else u("يرجى إدخال اسم المشفى")},q=e=>{navigator.clipboard.writeText(e).then(()=>{m("تم نسخ الرمز بنجاح")}).catch(()=>{x("فشل نسخ الرمز")})},G=[{header:"اسم المشفى",accessor:e=>e.full_name||"غير محدد",sortable:!0,className:"font-medium text-white"},{header:"البريد الإلكتروني",accessor:e=>{var t;return(null==(t=e.account)?void 0:t.email)||"-"}},{header:"رقم الهاتف",accessor:e=>{var t;return(null==(t=e.account)?void 0:t.phone_number)||"-"}},{header:"العنوان",accessor:e=>w.jsx("div",{className:"max-w-xs truncate",title:e.address||"غير محدد",children:e.address||"-"})},{header:"الإجراءات",accessor:e=>w.jsx(Q,{size:"sm",variant:"primary",onClick:t=>{t.stopPropagation(),o(`/hospitals/${e.id}`)},children:"عرض التفاصيل"})}],J=$.active?$.total:L.total,K=$.active?$.data:L.data,Y=$.active?$.loading:L.loading,Z=$.active?$.loading?"جاري البحث في المشافي...":$.error||"لم يتم العثور على نتائج مطابقة.":"لا توجد مشافي مسجلة",ee=$.active?Math.max(K.length,1):25;return w.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة المشافي"}),w.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع المشافي المسجلة في النظام"})]}),w.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[w.jsx(Me,{variant:"info",size:"lg",children:Y?"...":`${J} مشفى`}),w.jsxs(Q,{variant:"primary",size:"md",icon:w.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),onClick:()=>p(!0),children:[w.jsx("span",{className:"hidden sm:inline",children:"إضافة مشفى"}),w.jsx("span",{className:"sm:hidden",children:"إضافة"})]})]})]}),w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[w.jsx(X,{value:S,onChange:e=>z(e.target.value),placeholder:"ابحث في جميع المشافي بالاسم، البريد، الهاتف...",icon:w.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),M&&w.jsxs("div",{className:"mt-2 text-sm text-slate-400 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[$.loading?w.jsxs("span",{className:"flex items-center gap-2",children:[w.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري تحميل جميع المشافي لضمان دقة النتائج..."]}):w.jsx("span",{children:$.total>0?`تم العثور على ${$.total} مشفى مطابق`:"لم يتم العثور على نتائج مطابقة"}),$.error&&w.jsx("span",{className:"text-red-400",children:$.error})]})]}),w.jsx(ze,{data:K,columns:G,loading:Y,searchable:!1,emptyMessage:Z,itemsPerPage:ee,onRowClick:e=>o(`/hospitals/${e.id}`)},$.active?"search-results":`page-${C}`),!$.active&&L.totalPages>1&&w.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[w.jsxs("div",{className:"text-sm text-slate-400",children:["الصفحة ",C," من ",L.totalPages," (",L.total," مشفى إجمالاً)"]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>F(1),disabled:1===C||L.loading,children:"الأولى"}),w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>F(C-1),disabled:1===C||L.loading,icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"السابقة"}),w.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,L.totalPages)},(e,t)=>{let s;return s=L.totalPages<=5||C<=3?t+1:C>=L.totalPages-2?L.totalPages-4+t:C-2+t,w.jsx(Q,{variant:C===s?"primary":"secondary",size:"sm",onClick:()=>F(s),disabled:L.loading,className:"min-w-[40px]",children:s},s)})}),w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>F(C+1),disabled:C===L.totalPages||L.loading,icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),children:"التالية"}),w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>F(L.totalPages),disabled:C===L.totalPages||L.loading,children:"الأخيرة"})]})]}),w.jsx(Ee,{isOpen:h,onClose:()=>{p(!1),v("")},title:"إنشاء حساب مشفى جديد",footer:w.jsxs("div",{className:"flex gap-3 justify-end",children:[w.jsx(Q,{variant:"secondary",onClick:()=>p(!1),children:"إلغاء"}),w.jsx(Q,{variant:"primary",onClick:U,isLoading:j,children:"إنشاء المشفى"})]}),children:w.jsx(X,{label:"اسم المشفى",value:g,onChange:e=>v(e.target.value),onKeyPress:e=>{"Enter"!==e.key||j||U()},placeholder:"أدخل اسم المشفى",disabled:j,icon:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})})}),w.jsx(Ee,{isOpen:b,onClose:()=>{y(!1),k(null)},title:"✅ تم إنشاء حساب المشفى بنجاح",footer:w.jsx("div",{className:"flex gap-3 justify-end",children:w.jsx(Q,{variant:"primary",onClick:()=>{y(!1),k(null)},children:"تم"})}),children:w.jsxs("div",{className:"space-y-4",children:[w.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:w.jsx("p",{className:"text-slate-300 text-center mb-2",children:"تم إنشاء حساب المشفى بنجاح. يمكن للمشفى تسجيل الدخول باستخدام الرمز الفريد التالي:"})}),N&&w.jsxs(w.Fragment,{children:[((null==(e=N.hospital)?void 0:e.full_name)||N.full_name)&&w.jsxs("div",{className:"space-y-2",children:[w.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"اسم المشفى"}),w.jsx("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3",children:w.jsx("p",{className:"text-white font-medium text-center",children:(null==(s=N.hospital)?void 0:s.full_name)||N.full_name})})]}),((null==(a=N.account)?void 0:a.email)||N.email)&&w.jsxs("div",{className:"space-y-2",children:[w.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"البريد الإلكتروني"}),w.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3 flex items-center justify-between",children:[w.jsx("p",{className:"text-white font-mono",children:(null==(r=N.account)?void 0:r.email)||N.email}),w.jsx("button",{onClick:()=>{var e;return q((null==(e=N.account)?void 0:e.email)||N.email)},className:"px-3 py-1 bg-cyan-600 hover:bg-cyan-700 rounded-md text-sm transition-colors",children:"نسخ"})]})]}),(N.unique_code||N.code||N.password)&&w.jsxs("div",{className:"space-y-2",children:[w.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"الرمز الفريد / كلمة المرور"}),w.jsxs("div",{className:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 border-2 border-cyan-500/50 rounded-lg p-4 flex items-center justify-between",children:[w.jsx("p",{className:"text-white font-mono text-lg font-bold",children:N.unique_code||N.code||N.password}),w.jsxs("button",{onClick:()=>q(N.unique_code||N.code||N.password),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-md font-medium transition-colors flex items-center gap-2",children:[w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"نسخ"]})]})]}),((null==(n=N.account)?void 0:n.phone_number)||N.phone_number)&&w.jsxs("div",{className:"space-y-2",children:[w.jsx("label",{className:"block text-sm font-medium text-slate-400",children:"رقم الهاتف"}),w.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3 flex items-center justify-between",children:[w.jsx("p",{className:"text-white font-mono",children:(null==(i=N.account)?void 0:i.phone_number)||N.phone_number}),w.jsx("button",{onClick:()=>{var e;return q((null==(e=N.account)?void 0:e.phone_number)||N.phone_number)},className:"px-3 py-1 bg-cyan-600 hover:bg-cyan-700 rounded-md text-sm transition-colors",children:"نسخ"})]})]}),w.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mt-4",children:w.jsxs("div",{className:"flex items-start gap-3",children:[w.jsx("svg",{className:"w-6 h-6 text-yellow-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),w.jsxs("p",{className:"text-yellow-200 text-sm",children:[w.jsx("strong",{children:"تنبيه مهم:"})," يرجى حفظ الرمز الفريد وإرساله للمشفى. لن تتمكن من رؤيته مرة أخرى!"]})]})})]}),N&&!N.unique_code&&!N.code&&!N.password&&w.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4 mt-4",children:[w.jsx("p",{className:"text-slate-400 text-sm mb-2",children:"معلومات المشفى المُنشأ:"}),w.jsx("pre",{className:"text-xs text-slate-300 overflow-auto max-h-60",children:JSON.stringify(N,null,2)})]})]})}),c.map((e,t)=>w.jsx(Pe,{message:e.message,type:e.type,duration:e.duration,offset:t,onClose:()=>d(e.id)},e.id))]})},Ge=()=>{var e,s;const{id:a}=i(),r=l(),[n,o]=t.useState(null),[c,d]=t.useState([]),[m,x]=t.useState(!0),[u,h]=t.useState(!0),p=e=>e?e.startsWith("http://")||e.startsWith("https://")?e:`https://sahtee.evra-co.com/storage/${e.replace(/^\/+/,"")}`:null,[g,v]=t.useState(""),[j,f]=t.useState(""),[b,y]=t.useState(""),[N,k]=t.useState({pending:0,confirmed:0,cancelled:0,total:0});t.useEffect(()=>{C()},[a]),t.useEffect(()=>{a&&_()},[a,g,j,b]);const C=async()=>{x(!0);try{const e=await H.get(`/admin/hospital/${a}`);o(e.hospital||e)}catch(e){}finally{x(!1)}},_=async()=>{h(!0);try{const e=new URLSearchParams;g&&e.append("status",g),j&&e.append("from",j),b&&e.append("to",b);const t=await H.get(`/admin/hospital/${a}/reservations?${e.toString()}`),s=t.data||t.reservations||t;d(Array.isArray(s)?s:[]),L(s)}catch(e){d([])}finally{h(!1)}},L=e=>{const t={pending:0,confirmed:0,cancelled:0,total:e.length};e.forEach(e=>{e.status in t&&t[e.status]++}),k(t)};return m?w.jsx("div",{className:"flex justify-center items-center h-64",children:w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-400"})}):n?w.jsxs("div",{className:"space-y-6",children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsxs("button",{onClick:()=>r("/hospitals"),className:"flex items-center gap-2 px-4 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-cyan-500 rounded-lg transition-all duration-200 group",children:[w.jsx("svg",{className:"w-5 h-5 text-cyan-400 group-hover:text-cyan-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),w.jsx("span",{className:"text-slate-300 group-hover:text-white font-medium transition-colors",children:"رجوع"})]}),w.jsxs("h1",{className:"text-3xl font-bold text-slate-100",children:["تفاصيل المشفى - ",n.full_name]})]})}),w.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[w.jsxs("div",{className:"lg:col-span-2 bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[n.profile_image&&p(n.profile_image)&&w.jsx("div",{className:"mb-6 flex justify-center",children:w.jsx("img",{src:p(n.profile_image),alt:n.full_name||"مشفى",className:"w-32 h-32 rounded-full object-cover border-4 border-purple-400 shadow-lg shadow-purple-500/50 cursor-pointer hover:border-purple-300 transition-all",onClick:()=>window.open(p(n.profile_image),"_blank"),onError:e=>{e.currentTarget.style.display="none"}})}),w.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"المعلومات الأساسية"}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"اسم المشفى"}),w.jsx("p",{className:"text-white font-medium",children:n.full_name||"غير محدد"})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"البريد الإلكتروني"}),w.jsx("p",{className:"text-white font-medium",children:(null==(e=n.account)?void 0:e.email)||"غير محدد"})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"رقم الهاتف"}),w.jsx("p",{className:"text-white font-medium",children:(null==(s=n.account)?void 0:s.phone_number)||"غير محدد"})]}),w.jsxs("div",{className:"col-span-2",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"العنوان"}),w.jsx("p",{className:"text-white font-medium",children:n.address||"غير محدد"})]})]})]}),w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[w.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"إحصائيات الحجوزات"}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-slate-400",children:"الإجمالي"}),w.jsx("span",{className:"text-2xl font-bold text-white",children:N.total})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-yellow-400",children:"قيد الانتظار"}),w.jsx("span",{className:"font-bold text-yellow-400",children:N.pending})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-green-400",children:"مؤكدة"}),w.jsx("span",{className:"font-bold text-green-400",children:N.confirmed})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("span",{className:"text-gray-400",children:"ملغاة"}),w.jsx("span",{className:"font-bold text-gray-400",children:N.cancelled})]})]})]})]}),n.services_2&&n.services_2.length>0&&w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[w.jsxs("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:["الخدمات المتاحة (",n.services_2.length,")"]}),w.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.services_2.map(e=>w.jsxs("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:[w.jsx("h3",{className:"text-white font-medium mb-2",children:e.service_name}),w.jsxs("div",{className:"flex justify-between items-center text-sm",children:[w.jsx("span",{className:"text-slate-400",children:"السعر:"}),w.jsxs("span",{className:"text-cyan-400 font-bold",children:[e.pivot.price," ل.س"]})]}),w.jsxs("div",{className:"flex justify-between items-center text-sm mt-1",children:[w.jsx("span",{className:"text-slate-400",children:"السعة:"}),w.jsxs("span",{className:"text-white",children:[e.pivot.capacity," شخص"]})]})]},e.id))})]}),n.work_schedule&&n.work_schedule.length>0&&w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[w.jsxs("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:["أيام العمل (",n.work_schedule.length," أيام)"]}),w.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.work_schedule.map(e=>{return w.jsx("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-3 text-center",children:w.jsx("p",{className:"text-white font-medium",children:(t=e.day_of_week,{sunday:"الأحد",monday:"الاثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت"}[t]||t)})},e.id);var t})})]}),w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[w.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 space-y-4 md:space-y-0",children:[w.jsx("h2",{className:"text-xl font-bold text-cyan-400",children:"الحجوزات"}),w.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.jsxs("select",{value:g,onChange:e=>v(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",children:[w.jsx("option",{value:"",children:"جميع الحالات"}),w.jsx("option",{value:"pending",children:"قيد الانتظار"}),w.jsx("option",{value:"confirmed",children:"مؤكدة"}),w.jsx("option",{value:"cancelled",children:"ملغاة"})]}),w.jsx("input",{type:"date",value:j,onChange:e=>f(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",placeholder:"من تاريخ"}),w.jsx("input",{type:"date",value:b,onChange:e=>y(e.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-sm",placeholder:"إلى تاريخ"}),(g||j||b)&&w.jsx("button",{onClick:()=>{v(""),f(""),y("")},className:"px-3 py-2 bg-red-600 hover:bg-red-700 rounded-md text-sm",children:"إلغاء الفلاتر"})]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full text-sm text-right text-slate-300",children:[w.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800",children:w.jsxs("tr",{children:[w.jsx("th",{scope:"col",className:"px-6 py-3",children:"#"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"المريض"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"الخدمة"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"من تاريخ"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"إلى تاريخ"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"السعر"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"الحالة"})]})}),w.jsx("tbody",{children:u?w.jsx("tr",{children:w.jsx("td",{colSpan:7,className:"text-center p-8",children:"جاري التحميل..."})}):c.length>0?c.map(e=>{var t,s,a,r,l,n,i,o,c,d,m,x,u,h;return w.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-800",children:[w.jsx("td",{className:"px-6 py-4",children:e.id}),w.jsx("td",{className:"px-6 py-4",children:w.jsxs("div",{children:[w.jsx("p",{className:"font-medium",children:(null==(t=e.user)?void 0:t.full_name)||`مريض #${e.user_id}`}),w.jsxs("p",{className:"text-xs text-slate-400",children:["📞 ",(null==(a=null==(s=e.user)?void 0:s.account)?void 0:a.phone_number)||(null==(r=e.user)?void 0:r.phone_number)||(null==(n=null==(l=e.user)?void 0:l.account)?void 0:n.phone)||(null==(i=e.user)?void 0:i.phone)||(null==(c=null==(o=e.user)?void 0:o.account)?void 0:c.mobile)||(null==(d=e.user)?void 0:d.mobile)||"غير متوفر"]})]})}),w.jsx("td",{className:"px-6 py-4",children:(null==(x=null==(m=e.hospital_service)?void 0:m.service)?void 0:x.service_name)||"-"}),w.jsx("td",{className:"px-6 py-4",children:e.start_date}),w.jsx("td",{className:"px-6 py-4",children:e.end_date}),w.jsx("td",{className:"px-6 py-4",children:w.jsxs("span",{className:"text-cyan-400 font-bold",children:[(null==(u=e.hospital_service)?void 0:u.price)||"-"," ل.س"]})}),w.jsx("td",{className:"px-6 py-4",children:(h=e.status,w.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${{pending:"bg-yellow-600",confirmed:"bg-green-600",cancelled:"bg-gray-600"}[h]||"bg-gray-600"}`,children:{pending:"قيد الانتظار",confirmed:"مؤكدة",cancelled:"ملغاة"}[h]||h}))})]},e.id)}):w.jsx("tr",{children:w.jsx("td",{colSpan:7,className:"text-center p-8",children:"لا توجد حجوزات."})})})]})})]})]}):w.jsxs("div",{className:"text-center p-8",children:[w.jsx("p",{className:"text-xl text-slate-300 mb-6",children:"لم يتم العثور على المشفى"}),w.jsxs("button",{onClick:()=>r("/hospitals"),className:"inline-flex items-center gap-2 px-6 py-3 bg-cyan-600 hover:bg-cyan-700 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-cyan-500/20",children:[w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"العودة إلى قائمة المشافي"]})]})},Je=()=>{var e,s;const[a,r]=t.useState(null),n=l(),[i,o]=t.useState(1),[c,d]=t.useState({data:[],loading:!0,totalPages:1,total:0}),[m,x]=t.useState(""),[u,h]=t.useState(""),[p,g]=t.useState({active:!1,loading:!1,data:[],total:0,error:""}),[v,j]=t.useState({current:0,total:0}),f=t.useRef(null),b=t.useRef(null),y=t.useRef(null),N=t.useCallback(async(e,t,s)=>{const a=(e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([e,s])=>{null!=s&&""!==s&&t.append(e,String(s))}),t.toString()})({page:e,per_page:t});return(e=>{var t,s,a,r,l,n;let i=[null==e?void 0:e.users,null==e?void 0:e.data,e].find(e=>null!=e);i&&"object"==typeof i&&"users"in i&&(i=i.users);let o=[];Array.isArray(null==i?void 0:i.data)?o=i.data:Array.isArray(i)?o=i:Array.isArray(null==(t=null==e?void 0:e.users)?void 0:t.data)?o=e.users.data:Array.isArray(null==(s=null==e?void 0:e.data)?void 0:s.data)?o=e.data.data:Array.isArray(null==e?void 0:e.data)?o=e.data:Array.isArray(e)&&(o=e);const c=(null==i?void 0:i.current_page)??(null==e?void 0:e.current_page)??(null==(a=null==e?void 0:e.data)?void 0:a.current_page)??1,d=(null==i?void 0:i.last_page)??(null==e?void 0:e.last_page)??(null==(r=null==e?void 0:e.data)?void 0:r.last_page)??c,m=(null==i?void 0:i.total)??(null==e?void 0:e.total)??(null==(l=null==e?void 0:e.data)?void 0:l.total)??o.length,x=(null==i?void 0:i.per_page)??(null==e?void 0:e.per_page)??(null==(n=null==e?void 0:e.data)?void 0:n.per_page)??o.length;return{items:o,currentPage:Number(c)||1,lastPage:Number(d)||1,total:Number(m)||o.length,perPage:Number(x)||o.length}})(await H.get(`/admin/user/all?${a}`,{signal:s}))},[]),k=t.useCallback(async e=>{const t=null==e?void 0:e.signal,s=null==e?void 0:e.onProgress;if(f.current)return null==s||s(f.current.length?1:0,1),f.current;if(b.current)return b.current;const a=(async()=>{Oe(t);const e=[],{items:a,lastPage:r,total:l,perPage:n}=await N(1,200,t);e.push(...a);const i=n||200,o=l||e.length,c=i>0?Math.ceil(o/i):1,d=Math.max(r||1,c||1);if(null==s||s(Math.min(1,d),d),d>1){const a=Array.from({length:d-1},(e,t)=>t+2);let r=1;(await He(a,4,async e=>{Oe(t);const{items:a}=await N(e,200,t);return r+=1,null==s||s(Math.min(r,d),d),a})).forEach(t=>{e.push(...t)})}return f.current=e,e})();b.current=a;try{const e=await a;return b.current=null,e}catch(r){throw b.current=null,(null==t?void 0:t.aborted)||(f.current=null),r}},[N]);t.useEffect(()=>{const e=setTimeout(()=>{h(m.trim())},350);return()=>clearTimeout(e)},[m]),t.useEffect(()=>{if(u){y.current&&y.current.abort();const e=new AbortController;y.current=e,g({active:!0,loading:!0,data:[],total:0,error:""}),j({current:0,total:0});const t=(t,s)=>{e.signal.aborted||j({current:t,total:s})};return k({signal:e.signal,onProgress:t}).then(t=>{if(e.signal.aborted)return;const s=t.filter(e=>((e,t)=>{var s,a;const r=t.trim().toLowerCase();return!r||[e.full_name,null==(s=e.account)?void 0:s.email,null==(a=e.account)?void 0:a.phone_number,e.age?String(e.age):void 0].filter(e=>!!e).some(e=>e.toLowerCase().includes(r))})(e,u));g({active:!0,loading:!1,data:s,total:s.length,error:""})}).catch(()=>{e.signal.aborted||g({active:!0,loading:!1,data:[],total:0,error:"تعذر تحميل البيانات. يرجى المحاولة مرة أخرى."})}).finally(()=>{y.current===e&&(y.current=null)}),()=>e.abort()}y.current&&(y.current.abort(),y.current=null),g({active:!1,loading:!1,data:[],total:0,error:""}),j({current:0,total:0})},[u,k]),t.useEffect(()=>{if(u)return;const e=new AbortController;return d(e=>({...e,loading:!0})),N(i,100,e.signal).then(({items:t,lastPage:s,total:a})=>{e.signal.aborted||d({data:t,loading:!1,totalPages:s,total:a})}).catch(()=>{e.signal.aborted||d(e=>({...e,loading:!1}))}),()=>e.abort()},[u,i,N]),t.useEffect(()=>{if(u||f.current||b.current)return;const e=new AbortController,t=window.setTimeout(()=>{k({signal:e.signal}).catch(()=>{e.abort()})},800);return()=>{e.abort(),window.clearTimeout(t)}},[u,k]);const C=e=>{p.active||e>=1&&e<=c.totalPages&&(o(e),window.scrollTo({top:0,behavior:"smooth"}))},_=p.active?p.total:c.total,L=p.active?p.data:c.data,A=p.active?p.loading:c.loading,S=p.active?p.loading?"جاري البحث في المستخدمين...":p.error||"لم يتم العثور على نتائج مطابقة.":"لا يوجد مستخدمون مسجلون",z=p.active?Math.max(L.length,1):100,M=[{header:"الاسم الكامل",accessor:"full_name",sortable:!0,className:"font-medium text-white"},{header:"البريد الإلكتروني",accessor:e=>{var t;return(null==(t=e.account)?void 0:t.email)||"-"}},{header:"رقم الهاتف",accessor:e=>{var t;return(null==(t=e.account)?void 0:t.phone_number)||"-"}},{header:"العمر",accessor:"age",sortable:!0},{header:"الجنس",accessor:e=>w.jsx(Me,{variant:"male"===e.gender?"info":"success",size:"sm",children:"male"===e.gender?"ذكر":"female"===e.gender?"أنثى":"-"})},{header:"الإجراءات",accessor:e=>w.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.jsx(Q,{size:"sm",variant:"primary",onClick:t=>{t.stopPropagation(),r(e)},children:"عرض الملخص"}),w.jsx(Q,{size:"sm",variant:"secondary",onClick:t=>{t.stopPropagation(),n(`/users/${e.id}`,{state:{user:e}})},children:"الحجوزات"})]})}];return w.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة المستخدمين"}),w.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع المستخدمين المسجلين في النظام"})]}),w.jsx("div",{className:"flex items-center gap-2",children:w.jsx(Me,{variant:"info",size:"lg",children:A?"...":`${_} مستخدم`})})]}),w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[w.jsx(X,{value:m,onChange:e=>x(e.target.value),placeholder:"ابحث في جميع المستخدمين بالاسم، البريد، الهاتف، العمر...",icon:w.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),u&&w.jsxs("div",{className:"mt-2 text-sm text-slate-400",children:[p.loading?w.jsxs("div",{className:"space-y-2",children:[w.jsxs("span",{className:"flex items-center gap-2",children:[w.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري البحث في جميع الصفحات..."]}),v.total>0&&w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"flex-1 bg-slate-700 rounded-full h-2 overflow-hidden",children:w.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 h-full transition-all duration-300",style:{width:v.current/v.total*100+"%"}})}),w.jsxs("span",{className:"text-xs text-slate-500 min-w-[80px] text-right",children:[v.current," / ",v.total]})]})]}):w.jsxs("span",{className:"flex items-center gap-2",children:[w.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),p.total>0?`تم العثور على ${p.total} نتيجة مطابقة`:"لم يتم العثور على نتائج مطابقة"]}),p.error&&w.jsx("span",{className:"mt-1 text-sm text-red-400 block",children:p.error})]})]}),w.jsx(ze,{data:L,columns:M,loading:A,searchable:!1,emptyMessage:S,itemsPerPage:z,onRowClick:r},p.active?"search-results":`page-${i}`),!p.active&&c.totalPages>1&&w.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[w.jsxs("div",{className:"text-sm text-slate-400",children:["الصفحة ",i," من ",c.totalPages," (",c.total," مستخدم إجمالاً)"]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>C(1),disabled:1===i||c.loading,children:"الأولى"}),w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>C(i-1),disabled:1===i||c.loading,icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"السابقة"}),w.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,c.totalPages)},(e,t)=>{let s;return s=c.totalPages<=5||i<=3?t+1:i>=c.totalPages-2?c.totalPages-4+t:i-2+t,w.jsx(Q,{variant:i===s?"primary":"secondary",size:"sm",onClick:()=>C(s),disabled:c.loading,className:"min-w-[40px]",children:s},s)})}),w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>C(i+1),disabled:i===c.totalPages||c.loading,icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),children:"التالية"}),w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>C(c.totalPages),disabled:i===c.totalPages||c.loading,children:"الأخيرة"})]})]}),w.jsx(Ee,{isOpen:!!a,onClose:()=>r(null),title:"تفاصيل المستخدم",footer:w.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.jsx(Q,{variant:"primary",onClick:()=>{a&&n(`/users/${a.id}`,{state:{user:a}})},children:"فتح صفحة الحجوزات"}),w.jsx(Q,{variant:"secondary",onClick:()=>r(null),children:"إغلاق"})]}),children:a&&w.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"الاسم الكامل"}),w.jsx("p",{className:"text-white font-medium text-lg",children:a.full_name||"-"})]}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"العمر"}),w.jsxs("p",{className:"text-white font-medium text-lg",children:[a.age||"-"," سنة"]})]}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"الجنس"}),w.jsx(Me,{variant:"male"===a.gender?"info":"success",children:"male"===a.gender?"ذكر":"أنثى"})]}),w.jsxs("div",{className:"space-y-1",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"معرف المستخدم"}),w.jsxs("p",{className:"text-white font-medium text-lg",children:["#",a.id]})]}),w.jsxs("div",{className:"space-y-1 col-span-2",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"البريد الإلكتروني"}),w.jsx("p",{className:"text-white font-medium text-lg",children:(null==(e=a.account)?void 0:e.email)||"-"})]}),w.jsxs("div",{className:"space-y-1 col-span-2",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"رقم الهاتف"}),w.jsx("p",{className:"text-white font-medium text-lg direction-ltr text-right",children:(null==(s=a.account)?void 0:s.phone_number)||"-"})]})]})})]})},Ke=[{value:"",label:"كل الحالات"},{value:"pending",label:"قيد الانتظار"},{value:"approved",label:"موافق عليها"},{value:"rejected",label:"مرفوضة"},{value:"cancelled",label:"ملغاة"},{value:"completed",label:"مكتملة"}],Ye={doctor:{label:"حجوزات الأطباء",statuses:{pending:{label:"قيد الانتظار",color:"bg-amber-500/20 text-amber-300"},approved:{label:"موافق عليها",color:"bg-emerald-500/20 text-emerald-300"},rejected:{label:"مرفوضة",color:"bg-rose-500/20 text-rose-300"},cancelled:{label:"ملغاة",color:"bg-slate-500/30 text-slate-200"},completed:{label:"مكتملة",color:"bg-sky-500/20 text-sky-300"}}},hospital:{label:"حجوزات المشافي",statuses:{pending:{label:"قيد الانتظار",color:"bg-amber-500/20 text-amber-300"},confirmed:{label:"مؤكدة",color:"bg-emerald-500/20 text-emerald-300"},cancelled:{label:"ملغاة",color:"bg-slate-500/30 text-slate-200"}}},nurse:{label:"حجوزات الممرضين",statuses:{pending:{label:"قيد الانتظار",color:"bg-amber-500/20 text-amber-300"},approved:{label:"موافق عليها",color:"bg-emerald-500/20 text-emerald-300"},rejected:{label:"مرفوضة",color:"bg-rose-500/20 text-rose-300"},cancelled:{label:"ملغاة",color:"bg-slate-500/30 text-slate-200"},completed:{label:"مكتملة",color:"bg-sky-500/20 text-sky-300"}}}},Ze=e=>Array.isArray(e)?e:Array.isArray(null==e?void 0:e.data)?e.data:[],Xe=e=>{if(!e)return"-";const t=e.includes("T")?e:e.replace(" ","T"),s=new Date(t);return Number.isNaN(s.getTime())?e:s.toLocaleString("ar-EG",{dateStyle:"medium",timeStyle:"short"})},Qe=e=>{if(!e)return"-";const t=e.includes("T")?e:`${e}T00:00:00`,s=new Date(t);return Number.isNaN(s.getTime())?e:s.toLocaleDateString("ar-EG")},et=()=>{var e,s,a;const{id:r}=i(),n=l(),c=(null==(e=o().state)?void 0:e.user)??null,[d,m]=t.useState(c),[x,u]=t.useState(!c),[h,p]=t.useState([]),[g,v]=t.useState([]),[j,f]=t.useState([]),[b,y]=t.useState(!0),[N,k]=t.useState(""),[C,_]=t.useState("doctor"),[L,A]=t.useState(""),[S,z]=t.useState(""),[M,E]=t.useState("");t.useEffect(()=>{if(r)return c&&c.id===Number(r)?(m(c),void u(!1)):void $(r)},[r]),t.useEffect(()=>{r&&P(r)},[r,L,S,M]);const $=async e=>{u(!0);try{let t=null;try{const s=await H.get(`/admin/user/${e}`),a=(null==s?void 0:s.user)||(null==s?void 0:s.data)||s;(null==a?void 0:a.id)&&(t=a)}catch{}if(!t){const s=(e=>{var t,s,a,r,l;if(!e)return[];if((null==e?void 0:e.user)&&e.user.id)return[e.user];const n=[null==(t=null==e?void 0:e.users)?void 0:t.data,null==e?void 0:e.users,null==(a=null==(s=null==e?void 0:e.data)?void 0:s.users)?void 0:a.data,null==(r=null==e?void 0:e.data)?void 0:r.users,null==(l=null==e?void 0:e.data)?void 0:l.data,null==e?void 0:e.data,e];for(const i of n)if(Array.isArray(i))return i;return[]})(await H.get("/admin/user/all?per_page=1000"));t=s.find(t=>t.id===Number(e))??null}m(t)}catch{m(null)}finally{u(!1)}},P=async e=>{var t,s,a;y(!0),k("");try{const r=new URLSearchParams;L&&r.append("status",L),S&&r.append("from",S),M&&r.append("to",M);const l=r.toString(),n=l?`/admin/user/${e}/reservations?${l}`:`/admin/user/${e}/reservations`,i=await H.get(n),o=(null==i?void 0:i.data)||i;p(Ze((null==o?void 0:o.doctor_reservations)||(null==(t=null==o?void 0:o.data)?void 0:t.doctor_reservations))),v(Ze((null==o?void 0:o.hospital_reservations)||(null==(s=null==o?void 0:o.data)?void 0:s.hospital_reservations))),f(Ze((null==o?void 0:o.nurse_reservations)||(null==(a=null==o?void 0:o.data)?void 0:a.nurse_reservations)))}catch(r){p([]),v([]),f([]),k((null==r?void 0:r.message)||"فشل تحميل الحجوزات")}finally{y(!1)}},W=t.useMemo(()=>{switch(C){case"hospital":return g;case"nurse":return j;default:return h}},[C,h,g,j]),B=t.useMemo(()=>{const e=Ye[C],t=Object.keys(e.statuses).reduce((e,t)=>(e[t]=0,e),{});return W.forEach(e=>{const s=e.status;s in t&&(t[s]+=1)}),t},[W,C]);return r?x?w.jsx("div",{className:"flex justify-center items-center h-80",children:w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-400"})}):d?w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>n("/users"),icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"رجوع"}),w.jsxs("div",{children:[w.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white",children:d.full_name||"مستخدم غير معروف"}),w.jsxs("p",{className:"text-slate-400 text-sm",children:["#",d.id]})]})]}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx(Me,{variant:"info",children:(null==(s=d.account)?void 0:s.email)||"لا يوجد بريد"}),w.jsx(Me,{variant:"secondary",children:(null==(a=d.account)?void 0:a.phone_number)||"-"})]})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:[w.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-2",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"الاسم الكامل"}),w.jsx("p",{className:"text-white font-semibold text-lg",children:d.full_name||"-"})]}),w.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-2",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"العمر"}),w.jsx("p",{className:"text-white font-semibold text-lg",children:d.age?`${d.age} سنة`:"-"})]}),w.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-2",children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"الجنس"}),w.jsx(Me,{variant:"male"===d.gender?"info":"success",children:"male"===d.gender?"ذكر":"أنثى"})]})]}),w.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-4",children:[w.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[w.jsxs("div",{children:[w.jsx("p",{className:"text-lg font-semibold text-white",children:"مرشحات الحجوزات"}),w.jsx("p",{className:"text-slate-400 text-sm",children:"يمكن تطبيق نفس المرشح على جميع أنواع الحجوزات"})]}),w.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.jsx("select",{value:L,onChange:e=>A(e.target.value),className:"px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-white focus:outline-none focus:border-cyan-500",children:Ke.map(e=>w.jsx("option",{value:e.value,children:e.label},e.value))}),w.jsx("input",{type:"date",value:S,onChange:e=>z(e.target.value),className:"px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-white focus:outline-none focus:border-cyan-500"}),w.jsx("input",{type:"date",value:M,onChange:e=>E(e.target.value),className:"px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-white focus:outline-none focus:border-cyan-500"}),(L||S||M)&&w.jsx("button",{onClick:()=>{A(""),z(""),E("")},className:"px-3 py-2 text-sm rounded-lg border border-slate-600 text-slate-300 hover:border-cyan-400 hover:text-white transition-colors",children:"إعادة التعيين"})]})]}),N&&w.jsx("div",{className:"text-sm text-rose-400",children:N})]}),w.jsx("div",{className:"flex flex-wrap gap-3",children:["doctor","hospital","nurse"].map(e=>w.jsx("button",{onClick:()=>_(e),className:"px-4 py-2 rounded-xl border transition-all duration-200 "+(C===e?"bg-cyan-600/20 border-cyan-500 text-white shadow-cyan-500/20 shadow-lg":"bg-slate-800 border-slate-700 text-slate-300 hover:text-white"),children:w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{children:Ye[e].label}),w.jsx("span",{className:"text-xs text-slate-400",children:"doctor"===e?h.length:"hospital"===e?g.length:j.length})]})},e))}),w.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:Object.entries(Ye[C].statuses).map(([e,t])=>w.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 text-center",children:[w.jsx("p",{className:"text-xs text-slate-400",children:t.label}),w.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:B[e]||0})]},e))}),w.jsx("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl overflow-x-auto",children:b?w.jsx("div",{className:"flex justify-center items-center py-16",children:w.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-cyan-400"})}):0===W.length?w.jsx("div",{className:"text-center py-12 text-slate-400",children:"لا توجد حجوزات مطابقة للمعايير الحالية."}):w.jsxs("table",{className:"w-full text-sm text-right text-slate-200",children:[w.jsxs("thead",{className:"bg-slate-900 text-xs uppercase text-slate-400",children:["doctor"===C&&w.jsxs("tr",{children:[w.jsx("th",{className:"px-4 py-3",children:"الخدمة"}),w.jsx("th",{className:"px-4 py-3",children:"السعر"}),w.jsx("th",{className:"px-4 py-3",children:"الحالة"}),w.jsx("th",{className:"px-4 py-3",children:"تاريخ الحجز"}),w.jsx("th",{className:"px-4 py-3",children:"الإنشاء"})]}),"hospital"===C&&w.jsxs("tr",{children:[w.jsx("th",{className:"px-4 py-3",children:"الخدمة"}),w.jsx("th",{className:"px-4 py-3",children:"الحالة"}),w.jsx("th",{className:"px-4 py-3",children:"تاريخ البداية"}),w.jsx("th",{className:"px-4 py-3",children:"تاريخ النهاية"}),w.jsx("th",{className:"px-4 py-3",children:"آخر تحديث"})]}),"nurse"===C&&w.jsxs("tr",{children:[w.jsx("th",{className:"px-4 py-3",children:"الخدمة"}),w.jsx("th",{className:"px-4 py-3",children:"نوع الحجز"}),w.jsx("th",{className:"px-4 py-3",children:"الموقع"}),w.jsx("th",{className:"px-4 py-3",children:"الحالة"}),w.jsx("th",{className:"px-4 py-3",children:"الفترة"})]})]}),w.jsxs("tbody",{className:"divide-y divide-slate-700",children:["doctor"===C&&W.map(e=>{var t,s;return w.jsxs("tr",{className:"hover:bg-slate-800/70",children:[w.jsxs("td",{className:"px-4 py-3",children:[w.jsx("p",{className:"font-semibold",children:(null==(t=e.doctor_service)?void 0:t.name)||"خدمة غير معروفة"}),w.jsxs("p",{className:"text-xs text-slate-400",children:["#",e.id]})]}),w.jsx("td",{className:"px-4 py-3",children:(null==(s=e.doctor_service)?void 0:s.price)?`${e.doctor_service.price} ل.س`:"-"}),w.jsx("td",{className:"px-4 py-3",children:w.jsx(tt,{tab:C,status:e.status})}),w.jsxs("td",{className:"px-4 py-3",children:[w.jsx("p",{children:Xe(e.start_time)}),w.jsxs("p",{className:"text-xs text-slate-400",children:["حتى ",Xe(e.end_time)]})]}),w.jsx("td",{className:"px-4 py-3",children:Xe(e.created_at)})]},e.id)}),"hospital"===C&&W.map(e=>{var t,s;return w.jsxs("tr",{className:"hover:bg-slate-800/70",children:[w.jsxs("td",{className:"px-4 py-3",children:[w.jsx("p",{className:"font-semibold",children:(null==(s=null==(t=e.hospital_service)?void 0:t.service)?void 0:s.service_name)||"خدمة غير معروفة"}),w.jsxs("p",{className:"text-xs text-slate-400",children:["#",e.id]})]}),w.jsx("td",{className:"px-4 py-3",children:w.jsx(tt,{tab:C,status:e.status})}),w.jsx("td",{className:"px-4 py-3",children:Qe(e.start_date)}),w.jsx("td",{className:"px-4 py-3",children:Qe(e.end_date)}),w.jsx("td",{className:"px-4 py-3",children:Xe(e.updated_at)})]},e.id)}),"nurse"===C&&W.map(e=>{var t,s,a;return w.jsxs("tr",{className:"hover:bg-slate-800/70",children:[w.jsxs("td",{className:"px-4 py-3",children:[w.jsx("p",{className:"font-semibold",children:(null==(t=e.nurse_service)?void 0:t.name)||"خدمة غير معروفة"}),w.jsxs("p",{className:"text-xs text-slate-400",children:["#",e.id]})]}),w.jsx("td",{className:"px-4 py-3 capitalize text-white",children:"manual"===e.reservation_type?"يدوي":"مباشر"}),w.jsx("td",{className:"px-4 py-3 text-slate-300",children:(null==(s=e.location)?void 0:s.lat)&&(null==(a=e.location)?void 0:a.lng)?`${e.location.lat}, ${e.location.lng}`:"-"}),w.jsx("td",{className:"px-4 py-3",children:w.jsx(tt,{tab:C,status:e.status})}),w.jsxs("td",{className:"px-4 py-3",children:[w.jsx("p",{children:Xe(e.start_at)}),w.jsxs("p",{className:"text-xs text-slate-400",children:["حتى ",Xe(e.end_at)]})]})]},e.id)})]})]})})]}):w.jsxs("div",{className:"text-center py-20 space-y-4",children:[w.jsx("p",{className:"text-slate-300 text-xl",children:"لم يتم العثور على المستخدم"}),w.jsx(Q,{variant:"secondary",onClick:()=>n("/users"),children:"العودة لقائمة المستخدمين"})]}):w.jsx("div",{className:"text-center py-20 text-slate-400",children:"لا يوجد معرف مستخدم صالح."})},tt=({tab:e,status:t})=>{const s=Ye[e].statuses[t];return s?w.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.color}`,children:s.label}):w.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-slate-700 text-slate-300",children:t})},st=()=>{var e,s;l();const[a,r]=t.useState(null),[n,i]=t.useState(1),[o,c]=t.useState({data:[],loading:!0,totalPages:1,total:0}),[d,m]=t.useState(null),[x,u]=t.useState(!1),[h,p]=t.useState(null);t.useEffect(()=>{if(a){const e=a.license_image_path||a.license_image||a.license||a.license_path;if(e){const t=Be(e);if(m(t),p(null),t){u(!0);const e=setTimeout(()=>{},3e4),s=new Image;let a=!1;return s.onload=()=>{a||(a=!0,clearTimeout(e),u(!1),p(null))},s.onerror=()=>{},setTimeout(()=>{s.src=t},100),()=>{clearTimeout(e)}}u(!1)}else m(null),u(!1),p(null)}else m(null),u(!1),p(null)},[a]);const[g,v]=t.useState(""),[j,f]=t.useState(""),[b,y]=t.useState({active:!1,loading:!1,data:[],total:0,error:""}),[N,k]=t.useState({current:0,total:0}),C=t.useRef(null),_=t.useRef(null),L=t.useRef(null),A=t.useCallback(async(e,t,s)=>{const a=(e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([e,s])=>{null!=s&&""!==s&&t.append(e,String(s))}),t.toString()})({page:e,per_page:t});return(e=>{var t,s,a,r,l,n;let i=[null==e?void 0:e.nurses,null==e?void 0:e.data,e].find(e=>null!=e);i&&"object"==typeof i&&"nurses"in i&&(i=i.nurses);let o=[];Array.isArray(null==i?void 0:i.data)?o=i.data:Array.isArray(i)?o=i:Array.isArray(null==(t=null==e?void 0:e.nurses)?void 0:t.data)?o=e.nurses.data:Array.isArray(null==(s=null==e?void 0:e.data)?void 0:s.data)?o=e.data.data:Array.isArray(null==e?void 0:e.data)?o=e.data:Array.isArray(e)&&(o=e);const c=(null==i?void 0:i.current_page)??(null==e?void 0:e.current_page)??(null==(a=null==e?void 0:e.data)?void 0:a.current_page)??1,d=(null==i?void 0:i.last_page)??(null==e?void 0:e.last_page)??(null==(r=null==e?void 0:e.data)?void 0:r.last_page)??c,m=(null==i?void 0:i.total)??(null==e?void 0:e.total)??(null==(l=null==e?void 0:e.data)?void 0:l.total)??o.length,x=(null==i?void 0:i.per_page)??(null==e?void 0:e.per_page)??(null==(n=null==e?void 0:e.data)?void 0:n.per_page)??o.length;return{items:o,currentPage:Number(c)||1,lastPage:Number(d)||1,total:Number(m)||o.length,perPage:Number(x)||o.length}})(await H.get(`/admin/nurse/all?${a}`,{signal:s}))},[]),S=t.useCallback(async e=>{const t=null==e?void 0:e.signal,s=null==e?void 0:e.onProgress;if(C.current)return null==s||s(C.current.length?1:0,1),C.current;if(_.current)return _.current;const a=(async()=>{Oe(t);const e=[],{items:a,lastPage:r,total:l,perPage:n}=await A(1,200,t);e.push(...a);const i=n||200,o=l||e.length,c=i>0?Math.ceil(o/i):1,d=Math.max(r||1,c||1);if(null==s||s(Math.min(1,d),d),d>1){const a=Array.from({length:d-1},(e,t)=>t+2);let r=1;(await He(a,4,async e=>{Oe(t);const{items:a}=await A(e,200,t);return r+=1,null==s||s(Math.min(r,d),d),a})).forEach(t=>{e.push(...t)})}return C.current=e,e})();_.current=a;try{const e=await a;return _.current=null,e}catch(r){throw _.current=null,(null==t?void 0:t.aborted)||(C.current=null),r}},[A]);t.useEffect(()=>{const e=setTimeout(()=>{f(g.trim())},350);return()=>clearTimeout(e)},[g]),t.useEffect(()=>{if(j){L.current&&L.current.abort();const e=new AbortController;L.current=e,y({active:!0,loading:!0,data:[],total:0,error:""}),k({current:0,total:0});const t=(t,s)=>{e.signal.aborted||k({current:t,total:s})};return S({signal:e.signal,onProgress:t}).then(t=>{if(e.signal.aborted)return;const s=t.filter(e=>((e,t)=>{var s,a;const r=t.trim().toLowerCase();return!r||[e.full_name,null==(s=e.account)?void 0:s.email,null==(a=e.account)?void 0:a.phone_number,e.graduation_type].filter(e=>!!e).some(e=>e.toLowerCase().includes(r))})(e,j));y({active:!0,loading:!1,data:s,total:s.length,error:""})}).catch(()=>{e.signal.aborted||y({active:!0,loading:!1,data:[],total:0,error:"تعذر تحميل البيانات. يرجى المحاولة مرة أخرى."})}).finally(()=>{L.current===e&&(L.current=null)}),()=>e.abort()}L.current&&(L.current.abort(),L.current=null),y({active:!1,loading:!1,data:[],total:0,error:""}),k({current:0,total:0})},[j,S]),t.useEffect(()=>{if(j)return;const e=new AbortController;return c(e=>({...e,loading:!0})),A(n,100,e.signal).then(({items:t,lastPage:s,total:a})=>{e.signal.aborted||c({data:t,loading:!1,totalPages:s,total:a})}).catch(()=>{e.signal.aborted||c(e=>({...e,loading:!1}))}),()=>e.abort()},[j,n,A]),t.useEffect(()=>{if(j||C.current||_.current)return;const e=new AbortController,t=window.setTimeout(()=>{S({signal:e.signal}).catch(()=>{e.abort()})},800);return()=>{e.abort(),window.clearTimeout(t)}},[j,S]);const z=e=>{b.active||e>=1&&e<=o.totalPages&&(i(e),window.scrollTo({top:0,behavior:"smooth"}))},M=b.active?b.total:o.total,E=b.active?b.data:o.data,$=b.active?b.loading:o.loading,P=b.active?b.loading?"جاري البحث في الممرضين...":b.error||"لم يتم العثور على نتائج مطابقة.":"لا يوجد ممرضون لعرضهم";return w.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة الممرضين"}),w.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع الممرضين المسجلين في النظام"})]}),w.jsx("div",{className:"flex items-center gap-2",children:w.jsx(Me,{variant:"info",size:"lg",children:$?"...":`${M} ممرض/ة`})})]}),w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[w.jsx(X,{value:g,onChange:e=>v(e.target.value),placeholder:"ابحث في جميع الممرضين بالاسم، البريد، الهاتف، المؤهل...",icon:w.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),j&&w.jsxs("div",{className:"mt-2 text-sm text-slate-400",children:[b.loading?w.jsxs("div",{className:"space-y-2",children:[w.jsxs("span",{className:"flex items-center gap-2",children:[w.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري البحث في جميع الصفحات..."]}),N.total>0&&w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"flex-1 bg-slate-700 rounded-full h-2 overflow-hidden",children:w.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 h-full transition-all duration-300",style:{width:N.current/N.total*100+"%"}})}),w.jsxs("span",{className:"text-xs text-slate-500 min-w-[80px] text-right",children:[N.current," / ",N.total]})]})]}):w.jsxs("span",{className:"flex items-center gap-2",children:[w.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),b.total>0?`تم العثور على ${b.total} نتيجة مطابقة`:"لم يتم العثور على نتائج مطابقة"]}),b.error&&w.jsx("span",{className:"mt-1 text-sm text-red-400 block",children:b.error})]})]}),w.jsx("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl shadow-lg overflow-hidden",children:w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full text-sm text-right text-slate-300",children:[w.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800",children:w.jsxs("tr",{children:[w.jsx("th",{scope:"col",className:"px-6 py-3",children:"الاسم الكامل"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"البريد الإلكتروني"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"رقم الهاتف"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"المؤهل"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"التقييم"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"الحالة"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"الإجراءات"})]})}),w.jsx("tbody",{children:$?w.jsx("tr",{children:w.jsx("td",{colSpan:7,className:"text-center p-8",children:"جاري التحميل..."})}):E.length>0?E.map(e=>{var t,s;return w.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-800",children:[w.jsx("td",{className:"px-6 py-4 font-medium",children:e.full_name}),w.jsx("td",{className:"px-6 py-4",children:(null==(t=e.account)?void 0:t.email)||"-"}),w.jsx("td",{className:"px-6 py-4",children:(null==(s=e.account)?void 0:s.phone_number)||"-"}),w.jsx("td",{className:"px-6 py-4",children:e.graduation_type||"-"}),w.jsx("td",{className:"px-6 py-4",children:void 0!==e.avg_rating&&null!==e.avg_rating?w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{className:"text-yellow-400 font-semibold",children:e.avg_rating.toFixed(1)}),w.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:w.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),void 0!==e.ratings_count&&null!==e.ratings_count&&w.jsxs("span",{className:"text-slate-400 text-xs",children:["(",e.ratings_count,")"]})]}):w.jsx("span",{className:"text-slate-500 text-sm",children:"-"})}),w.jsx("td",{className:"px-6 py-4",children:w.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+(e.is_active?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"),children:e.is_active?"نشط":"غير نشط"})}),w.jsx("td",{className:"px-6 py-4",children:w.jsxs("button",{onClick:()=>r(e),className:"px-3 py-1 text-xs bg-blue-600 hover:bg-blue-700 rounded-md transition-colors flex items-center gap-1",children:[w.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"عرض التفاصيل"]})})]},e.id)}):w.jsx("tr",{children:w.jsx("td",{colSpan:7,className:"text-center p-8",children:P})})})]})})}),!b.active&&o.totalPages>1&&w.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[w.jsxs("div",{className:"text-sm text-slate-400",children:["الصفحة ",n," من ",o.totalPages," (",o.total," ممرض/ة إجمالاً)"]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>z(1),disabled:1===n||o.loading,children:"الأولى"}),w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>z(n-1),disabled:1===n||o.loading,icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),children:"السابقة"}),w.jsx("div",{className:"hidden sm:flex items-center gap-1",children:Array.from({length:Math.min(5,o.totalPages)},(e,t)=>{let s;return s=o.totalPages<=5||n<=3?t+1:n>=o.totalPages-2?o.totalPages-4+t:n-2+t,w.jsx(Q,{variant:n===s?"primary":"secondary",size:"sm",onClick:()=>z(s),disabled:o.loading,className:"min-w-[40px]",children:s},s)})}),w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>z(n+1),disabled:n===o.totalPages||o.loading,icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),children:"التالية"}),w.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>z(o.totalPages),disabled:n===o.totalPages||o.loading,children:"الأخيرة"})]})]}),w.jsx(Ee,{isOpen:!!a,onClose:()=>r(null),title:"تفاصيل الممرض/ة",size:"lg",children:a&&w.jsxs("div",{className:"space-y-6",children:[w.jsx("div",{className:"bg-gradient-to-r from-emerald-500/10 to-green-500/10 rounded-xl p-4 sm:p-6 border border-emerald-500/30",children:w.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 sm:gap-6",children:[w.jsx("div",{className:"flex-shrink-0",children:w.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full bg-gradient-to-br from-emerald-500 to-green-600 flex items-center justify-center border-4 border-emerald-400 shadow-lg shadow-emerald-500/50",children:w.jsx("svg",{className:"w-12 h-12 sm:w-16 sm:h-16 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})}),w.jsxs("div",{className:"flex-1 text-center sm:text-right space-y-2",children:[w.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white",children:a.full_name}),w.jsx("div",{className:"flex items-center justify-center sm:justify-start gap-2",children:w.jsx(Me,{variant:"success",size:"lg",children:w.jsxs("span",{className:"flex items-center gap-2",children:[w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),a.graduation_type]})})})]})]})}),w.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[w.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"المعلومات الشخصية"]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[w.jsx(at,{label:"الاسم الكامل",value:a.full_name}),w.jsx(at,{label:"البريد الإلكتروني",value:(null==(e=a.account)?void 0:e.email)||"غير متوفر"}),w.jsx(at,{label:"رقم الهاتف",value:(null==(s=a.account)?void 0:s.phone_number)||"غير متوفر"}),w.jsx(at,{label:"العنوان",value:a.address||"غير متوفر"}),a.age&&w.jsx(at,{label:"العمر",value:`${a.age} سنة`}),w.jsx(at,{label:"الجنس",value:"male"===a.gender?"ذكر":"أنثى"})]})]}),w.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 sm:p-6 border border-slate-700/50",children:[w.jsxs("h3",{className:"text-lg font-bold text-cyan-400 mb-4 flex items-center gap-2",children:[w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"المعلومات المهنية"]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[w.jsx(at,{label:"نوع التخرج",value:w.jsx(Me,{variant:"success",size:"md",children:a.graduation_type})}),w.jsx(at,{label:"الحالة",value:w.jsx(Me,{variant:a.is_active?"success":"danger",size:"md",children:a.is_active?"نشط":"غير نشط"})}),void 0!==a.avg_rating&&null!==a.avg_rating&&w.jsx(at,{label:"التقييم",value:w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{className:"text-yellow-400 font-semibold",children:a.avg_rating.toFixed(1)}),w.jsx("svg",{className:"w-5 h-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:w.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),a.ratings_count&&w.jsxs("span",{className:"text-slate-400 text-sm",children:["(",a.ratings_count," تقييم)"]})]})})]}),a.profile_description&&w.jsx("div",{className:"mt-4",children:w.jsx(at,{label:"الوصف الشخصي",value:a.profile_description})}),w.jsxs("div",{className:"mt-4",children:[w.jsx("p",{className:"text-xs sm:text-sm text-slate-400 font-medium mb-2",children:"صورة رخصة الممرضة"}),x&&!d?w.jsx("div",{className:"flex items-center justify-center p-6 bg-slate-700/50 rounded-lg border border-slate-600",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-cyan-400 mx-auto mb-2"}),w.jsx("p",{className:"text-slate-400 text-sm",children:"جاري التحميل..."}),w.jsx("p",{className:"text-slate-500 text-xs mt-1",children:"يرجى الانتظار، قد يستغرق الأمر بضع لحظات"})]})}):h&&!d?w.jsx("div",{className:"flex items-center justify-center p-6 bg-red-900/20 rounded-lg border border-red-600",children:w.jsxs("div",{className:"text-center",children:[w.jsx("svg",{className:"w-10 h-10 text-red-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w.jsx("p",{className:"text-red-300 text-base font-semibold mb-1",children:"صورة الرخصة غير موجودة"}),w.jsx("p",{className:"text-red-400 text-sm",children:h}),d&&w.jsx("button",{onClick:()=>{d&&window.open(d,"_blank")},className:"mt-2 px-3 py-1.5 bg-red-600 hover:bg-red-700 rounded-lg text-white text-xs font-medium transition-colors",children:"محاولة فتح الرابط"})]})}):d?w.jsxs("div",{className:"relative group",children:[w.jsx("img",{src:d,alt:"رخصة ممرضة",className:"w-full max-w-md rounded-lg border-2 border-slate-600 hover:border-cyan-400 transition-all duration-300 cursor-pointer shadow-lg",onClick:()=>{d&&window.open(d,"_blank")},onLoad:()=>{u(!1),p(null)},onError:e=>{const t=e.currentTarget,s=parseInt(t.dataset.retryCount||"0");if(s<3){t.dataset.retryCount=String(s+1);setTimeout(()=>{const e=(null==d?void 0:d.includes("?"))?"&":"?";t.src=`${d}${e}_retry=${Date.now()}`},[2e3,5e3,1e4][s])}else p("صورة الرخصة غير موجودة أو لا يمكن الوصول إليها"),u(!1)},loading:"lazy"}),w.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-all duration-300 rounded-lg flex items-center justify-center pointer-events-none",children:w.jsx("svg",{className:"w-10 h-10 text-white opacity-0 group-hover:opacity-100 transition-all duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})})})]}):w.jsx("div",{className:"flex items-center justify-center p-6 bg-slate-700/50 rounded-lg border border-slate-600",children:w.jsxs("div",{className:"text-center",children:[w.jsx("svg",{className:"w-10 h-10 text-slate-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),w.jsx("p",{className:"text-slate-300 text-base font-semibold mb-1",children:"صورة الرخصة غير موجودة"}),w.jsx("p",{className:"text-slate-400 text-sm",children:"لم يتم العثور على صورة رخصة للممرض/ة في النظام"})]})})]})]})]})})]})},at=({label:e,value:t})=>w.jsxs("div",{className:"space-y-1",children:[w.jsx("p",{className:"text-xs sm:text-sm text-slate-400 font-medium",children:e}),w.jsx("div",{className:"text-sm sm:text-base text-white font-semibold",children:t||w.jsx("span",{className:"text-slate-500",children:"غير متوفر"})})]}),rt=()=>{var e,s;const{id:a}=i(),r=l(),[n,o]=t.useState(null),[c,d]=t.useState(!0),[m,x]=t.useState([]),[u,h]=t.useState(!0),[p,g]=t.useState(""),[v,j]=t.useState(""),[f,b]=t.useState(""),[y,N]=t.useState({pending:0,approved:0,rejected:0,cancelled:0,completed:0,total:0}),[k,C]=t.useState(null),[_,L]=t.useState(!1),[A,S]=t.useState(null);t.useEffect(()=>{if(n){const e=n.license_image_path||n.license_image||n.license||n.license_path;if(e){const t=Be(e);if(C(t),S(null),t){L(!0);const e=setTimeout(()=>{},3e4),s=new Image;let a=!1;return s.onload=()=>{a||(a=!0,clearTimeout(e),L(!1),S(null))},s.onerror=()=>{},setTimeout(()=>{s.src=t},100),()=>{clearTimeout(e)}}L(!1)}else C(null),L(!1),S(null)}else C(null),L(!1),S(null)},[n]),t.useEffect(()=>{z()},[a]),t.useEffect(()=>{a&&M()},[a,p,v,f]);const z=async()=>{d(!0);try{const e=await H.get(`/admin/nurse/${a}`),t=e.nurse||e;t.license_image_path||(t.license_image?t.license_image_path=t.license_image:t.license?t.license_image_path=t.license:t.license_path&&(t.license_image_path=t.license_path)),o(t)}catch(e){}finally{d(!1)}},M=async()=>{var e;h(!0);try{const t=new URLSearchParams;p&&t.append("status",p),v&&t.append("from",v),f&&t.append("to",f);const s=await H.get(`/admin/nurse/${a}/reservations?${t.toString()}`),r=(null==(e=s.data)?void 0:e.data)||s.data||s.reservations||s.nurse_reservations||s,l=Array.isArray(r)?r:Array.isArray(null==r?void 0:r.data)?r.data:[];x(l),E(l)}catch(t){x([]),N({pending:0,approved:0,rejected:0,cancelled:0,completed:0,total:0})}finally{h(!1)}},E=e=>{const t={pending:0,approved:0,rejected:0,cancelled:0,completed:0,total:e.length};e.forEach(e=>{e.status in t&&t[e.status]++}),N(t)},$=e=>{if(!e)return"-";return new Date(e.replace(" ","T")).toLocaleString("ar-EG",{dateStyle:"medium",timeStyle:"short"})};return c?w.jsx("div",{className:"flex justify-center items-center h-64",children:w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-400"})}):n?w.jsxs("div",{className:"space-y-6",children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsxs("button",{onClick:()=>r("/nurses"),className:"flex items-center gap-2 px-4 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-600 hover:border-cyan-500 rounded-lg transition-all duration-200 group",children:[w.jsx("svg",{className:"w-5 h-5 text-cyan-400 group-hover:text-cyan-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),w.jsx("span",{className:"text-slate-300 group-hover:text-white font-medium transition-colors",children:"رجوع"})]}),w.jsxs("h1",{className:"text-3xl font-bold text-slate-100",children:["تفاصيل الممرض - ",n.full_name]})]})}),w.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[w.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"المعلومات الأساسية"}),w.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"الاسم الكامل"}),w.jsx("p",{className:"text-white font-medium",children:n.full_name})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"البريد الإلكتروني"}),w.jsx("p",{className:"text-white font-medium",children:null==(e=n.account)?void 0:e.email})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"رقم الهاتف"}),w.jsx("p",{className:"text-white font-medium",children:null==(s=n.account)?void 0:s.phone_number})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"العمر"}),w.jsxs("p",{className:"text-white font-medium",children:[n.age," سنة"]})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"الجنس"}),w.jsx("p",{className:"text-white font-medium",children:"male"===n.gender?"ذكر":"أنثى"})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"نوع التخرج"}),w.jsx("p",{className:"text-white font-medium",children:n.graduation_type})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"الحالة"}),w.jsx("p",{className:"text-white font-medium",children:w.jsx("span",{className:"inline-block px-3 py-1 text-xs rounded-full "+(n.is_active?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"),children:n.is_active?"نشط":"غير نشط"})})]}),w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"العنوان"}),w.jsx("p",{className:"text-white font-medium",children:n.address})]}),n.profile_description&&w.jsxs("div",{children:[w.jsx("p",{className:"text-slate-400 text-sm",children:"الوصف"}),w.jsx("p",{className:"text-white font-medium",children:n.profile_description})]})]}),w.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-700",children:[w.jsx("h3",{className:"text-lg font-bold text-cyan-400 mb-4",children:"رخصة الممرضة"}),_&&!k?w.jsx("div",{className:"flex items-center justify-center p-8 bg-slate-700/50 rounded-lg border border-slate-600",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cyan-400 mx-auto mb-2"}),w.jsx("p",{className:"text-slate-400",children:"جاري تحميل صورة الرخصة..."}),w.jsx("p",{className:"text-slate-500 text-xs mt-2",children:"يرجى الانتظار، قد يستغرق الأمر بضع لحظات"})]})}):A&&!k?w.jsx("div",{className:"flex items-center justify-center p-8 bg-red-900/20 rounded-lg border border-red-600",children:w.jsxs("div",{className:"text-center",children:[w.jsx("svg",{className:"w-12 h-12 text-red-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w.jsx("p",{className:"text-red-400 font-medium",children:A}),(null==n?void 0:n.license_image_path)&&w.jsx("p",{className:"text-red-300 text-sm mt-1 break-all",children:n.license_image_path}),k&&w.jsx("button",{onClick:()=>{k&&window.open(k,"_blank")},className:"mt-3 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-white text-sm font-medium transition-colors",children:"محاولة فتح الرابط مباشرة"}),a&&w.jsx("button",{onClick:async()=>{try{const e=await H.get(`/admin/nurse/${a}/license`,{skipAuth:!1});if(e instanceof Blob){const t=URL.createObjectURL(e);window.open(t,"_blank")}else e.url&&window.open(e.url,"_blank")}catch(e){alert("فشل تحميل صورة الرخصة: "+(e.message||"خطأ غير معروف"))}},className:"mt-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-lg text-white text-sm font-medium transition-colors",children:"محاولة التحميل من API"})]})}):k?w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"relative group",children:[w.jsx("img",{src:k,alt:"رخصة ممرضة",className:"w-full max-w-md rounded-lg border-2 border-slate-600 hover:border-cyan-400 transition-all duration-300 cursor-pointer shadow-lg",onClick:()=>{k&&window.open(k,"_blank")},onLoad:()=>{L(!1),S(null)},onError:e=>{const t=e.currentTarget,s=parseInt(t.dataset.retryCount||"0");if(s<3){t.dataset.retryCount=String(s+1);setTimeout(()=>{const e=(null==k?void 0:k.includes("?"))?"&":"?";t.src=`${k}${e}_retry=${Date.now()}`},[2e3,5e3,1e4][s])}else S("فشل تحميل صورة الرخصة بعد عدة محاولات"),L(!1)},loading:"lazy"}),w.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-all duration-300 rounded-lg flex items-center justify-center pointer-events-none",children:w.jsx("svg",{className:"w-10 h-10 text-white opacity-0 group-hover:opacity-100 transition-all duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})})})]}),w.jsx("p",{className:"text-xs text-slate-500 text-center",children:"انقر على الصورة لعرضها بحجم كامل"})]}):w.jsx("div",{className:"flex items-center justify-center p-8 bg-slate-700/50 rounded-lg border border-slate-600",children:w.jsxs("div",{className:"text-center",children:[w.jsx("svg",{className:"w-12 h-12 text-slate-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),w.jsx("p",{className:"text-slate-400",children:"لا توجد صورة رخصة متاحة"}),!1]})})]})]}),w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6 flex flex-col",children:[w.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-4",children:"الملف الشخصي"}),w.jsx("div",{className:"flex-1 flex items-center justify-center",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"w-48 h-48 mx-auto mb-4 rounded-full bg-slate-700 flex items-center justify-center",children:w.jsx("svg",{className:"w-24 h-24 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),w.jsx("p",{className:"text-slate-400 text-sm",children:"صورة الملف الشخصي"})]})})]})]}),w.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6 space-y-6",children:[w.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[w.jsxs("div",{children:[w.jsx("h2",{className:"text-xl font-bold text-cyan-400 mb-1",children:"حجوزات الممرض"}),w.jsx("p",{className:"text-slate-400 text-sm",children:"معاينة كل الطلبات المرتبطة بهذا الممرض"})]}),w.jsxs("div",{className:"flex flex-wrap gap-3",children:[w.jsxs("select",{value:p,onChange:e=>g(e.target.value),className:"bg-slate-900 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-cyan-500",children:[w.jsx("option",{value:"",children:"كل الحالات"}),w.jsx("option",{value:"pending",children:"قيد الانتظار"}),w.jsx("option",{value:"approved",children:"موافق عليها"}),w.jsx("option",{value:"rejected",children:"مرفوضة"}),w.jsx("option",{value:"cancelled",children:"ملغاة"}),w.jsx("option",{value:"completed",children:"مكتملة"})]}),w.jsx("input",{type:"date",value:v,onChange:e=>j(e.target.value),className:"bg-slate-900 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-cyan-500"}),w.jsx("input",{type:"date",value:f,onChange:e=>b(e.target.value),className:"bg-slate-900 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-cyan-500"}),(v||f||p)&&w.jsx("button",{onClick:()=>{g(""),j(""),b("")},className:"px-4 py-2 text-sm rounded-lg border border-slate-600 text-slate-300 hover:text-white hover:border-cyan-400 transition-colors",children:"إعادة تعيين"})]})]}),w.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[{label:"إجمالي",value:y.total,color:"text-slate-200"},{label:"قيد الانتظار",value:y.pending,color:"text-amber-300"},{label:"موافق عليها",value:y.approved,color:"text-emerald-300"},{label:"مرفوضة",value:y.rejected,color:"text-rose-300"},{label:"ملغاة",value:y.cancelled,color:"text-slate-400"},{label:"مكتملة",value:y.completed,color:"text-sky-300"}].map(e=>w.jsxs("div",{className:"bg-slate-900/60 border border-slate-700 rounded-lg p-3 text-center",children:[w.jsx("p",{className:"text-xs text-slate-400",children:e.label}),w.jsx("p",{className:`text-xl font-bold ${e.color}`,children:e.value})]},e.label))}),u?w.jsx("div",{className:"flex justify-center items-center py-12",children:w.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-cyan-400"})}):m.length>0?w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"min-w-full divide-y divide-slate-700",children:[w.jsx("thead",{children:w.jsxs("tr",{className:"text-left text-xs uppercase tracking-wider text-slate-400",children:[w.jsx("th",{className:"px-4 py-3",children:"المستخدم"}),w.jsx("th",{className:"px-4 py-3",children:"الخدمة"}),w.jsx("th",{className:"px-4 py-3",children:"الحالة"}),w.jsx("th",{className:"px-4 py-3",children:"نوع الحجز"}),w.jsx("th",{className:"px-4 py-3",children:"الموقع"}),w.jsx("th",{className:"px-4 py-3",children:"بداية الحجز"}),w.jsx("th",{className:"px-4 py-3",children:"نهاية الحجز"})]})}),w.jsx("tbody",{className:"divide-y divide-slate-800 text-sm",children:m.map(e=>{var t,s,a,r,l,n,i,o,c,d;return w.jsxs("tr",{className:"hover:bg-slate-800/60 transition-colors",children:[w.jsxs("td",{className:"px-4 py-3",children:[w.jsx("p",{className:"text-white font-medium",children:(null==(t=e.user)?void 0:t.full_name)||"غير معروف"}),w.jsx("p",{className:"text-xs text-slate-400",children:(null==(a=null==(s=e.user)?void 0:s.account)?void 0:a.phone_number)||(null==(l=null==(r=e.user)?void 0:r.account)?void 0:l.email)||"-"})]}),w.jsxs("td",{className:"px-4 py-3",children:[w.jsx("p",{className:"text-white font-medium",children:(null==(n=e.nurse_service)?void 0:n.name)||"خدمة عامة"}),w.jsx("p",{className:"text-xs text-slate-400",children:(null==(i=e.nurse_service)?void 0:i.price)?`${e.nurse_service.price} ل.س`:""})]}),w.jsx("td",{className:"px-4 py-3",children:(d=e.status,w.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${{pending:"bg-yellow-600",approved:"bg-green-600",rejected:"bg-red-600",cancelled:"bg-gray-600",completed:"bg-blue-600"}[d]||"bg-slate-600"}`,children:{pending:"قيد الانتظار",approved:"موافق عليها",rejected:"مرفوضة",cancelled:"ملغاة",completed:"مكتملة"}[d]||d}))}),w.jsx("td",{className:"px-4 py-3 capitalize text-white",children:e.reservation_type}),w.jsx("td",{className:"px-4 py-3 text-slate-300",children:(null==(o=e.location)?void 0:o.lat)&&(null==(c=e.location)?void 0:c.lng)?`${e.location.lat}, ${e.location.lng}`:"-"}),w.jsx("td",{className:"px-4 py-3 text-slate-300",children:$(e.start_at)}),w.jsx("td",{className:"px-4 py-3 text-slate-300",children:$(e.end_at)})]},e.id)})})]})}):w.jsx("div",{className:"text-center py-12 text-slate-400",children:"لا توجد حجوزات مطابقة للمعايير الحالية."})]})]}):w.jsxs("div",{className:"text-center p-8",children:[w.jsx("p",{className:"text-xl text-slate-300 mb-6",children:"لم يتم العثور على الممرض"}),w.jsxs("button",{onClick:()=>r("/nurses"),className:"inline-flex items-center gap-2 px-6 py-3 bg-cyan-600 hover:bg-cyan-700 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-cyan-500/20",children:[w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"العودة إلى قائمة الممرضين"]})]})},lt=()=>{const[e,s]=t.useState([]),[a,r]=t.useState(!0),[l,n]=t.useState(!1),[i,o]=t.useState({}),[c,d]=t.useState(!1),{toasts:m,removeToast:x,success:u,error:h}=$e(),p=async()=>{r(!0);try{const e=await H.get("/admin/specializations");s(e||[])}catch(e){h("فشل تحميل التخصصات")}finally{r(!1)}};t.useEffect(()=>{p()},[]);const g=e=>{o(e||{name_ar:"",name_en:""}),n(!0)},v=()=>{n(!1),o({})};return w.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة التخصصات"}),w.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة تخصصات الأطباء في النظام"})]}),w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsxs(Me,{variant:"info",size:"lg",children:[e.length," تخصص"]}),w.jsxs(Q,{variant:"primary",onClick:()=>g(),icon:w.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),children:[w.jsx("span",{className:"hidden sm:inline",children:"إضافة تخصص"}),w.jsx("span",{className:"sm:hidden",children:"إضافة"})]})]})]}),a?w.jsx("div",{className:"flex justify-center py-20",children:w.jsx(Se,{text:"جاري تحميل التخصصات..."})}):e.length>0?w.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6",children:e.map(t=>w.jsxs(fe,{gradient:!0,hover:!0,className:"p-4 md:p-6 text-center group",children:[w.jsx("div",{className:"relative inline-block mb-4",children:Re(t.image)?w.jsx("img",{src:Re(t.image),alt:t.name_ar,className:"w-20 h-20 md:w-24 md:h-24 rounded-full mx-auto object-cover border-4 border-slate-700 group-hover:border-cyan-500 transition-all duration-300 group-hover:scale-110",loading:"lazy",onError:e=>{var s;const a=e.currentTarget,r=a.src,l=(null==(s=t.image)?void 0:s.replace(/^\/+/,""))||"";if(!l||r.includes("data:image"))return a.onerror=null,void(a.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2306b6d4"%3E%3Cpath d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/%3E%3C/svg%3E');const n=parseInt(a.dataset.attemptCount||"0");if(n>=3)return a.onerror=null,void(a.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2306b6d4"%3E%3Cpath d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/%3E%3C/svg%3E');if(a.dataset.attemptCount=String(n+1),l.includes("specializations/")){let e=l.replace(/^(images\/)?specializations\//,"");return void(a.src=`https://sahtee.evra-co.com/storage/specializations/${e}`)}r.includes("images/specializations")?a.src=`https://sahtee.evra-co.com/storage/specializations/${l}`:!r.includes("specializations/")||l.includes("/")?!r.includes("specializations/")||r.includes("images/")?(a.onerror=null,a.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2306b6d4"%3E%3Cpath d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/%3E%3C/svg%3E'):a.src=`https://sahtee.evra-co.com/storage/images/${l}`:a.src=`https://sahtee.evra-co.com/storage/${l}`}}):w.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-full mx-auto flex items-center justify-center bg-slate-700 border-4 border-slate-600",children:w.jsx("svg",{className:"w-10 h-10 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),w.jsx("h3",{className:"font-bold text-base md:text-lg text-white mb-1",children:t.name_ar}),w.jsx("p",{className:"text-slate-400 text-xs md:text-sm mb-4",children:t.name_en}),w.jsxs("div",{className:"flex justify-center gap-2",children:[w.jsx(Q,{size:"sm",variant:"ghost",onClick:()=>g(t),icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),children:"تعديل"}),w.jsx(Q,{size:"sm",variant:"danger",onClick:()=>(async t=>{if(window.confirm("هل أنت متأكد من رغبتك في حذف هذا التخصص؟"))try{await H.delete(`/admin/specializations/${t}`),s(e.filter(e=>e.id!==t)),u("تم حذف التخصص بنجاح")}catch(a){h(`فشل الحذف: ${a.message}`)}})(t.id),icon:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),children:"حذف"})]})]},t.id))}):w.jsx(Ae,{icon:w.jsx("svg",{className:"w-16 h-16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),title:"لا توجد تخصصات",description:"ابدأ بإضافة تخصص جديد للأطباء",action:{label:"إضافة تخصص",onClick:()=>g()}}),l&&w.jsx(nt,{spec:i,onClose:v,onSave:async e=>{var t,s;d(!0);try{let t;i.id?(t=await H.post(`/admin/specializations/${i.id}`,e),u("تم تحديث التخصص بنجاح")):(t=await H.post("/admin/specializations",e),u("تم إضافة التخصص بنجاح")),await p(),v()}catch(a){h(`فشل الحفظ: ${(null==(s=null==(t=a.response)?void 0:t.data)?void 0:s.message)||a.message||"حدث خطأ غير متوقع"}`)}finally{d(!1)}},saving:c}),m.map((e,t)=>w.jsx(Pe,{message:e.message,type:e.type,duration:e.duration,offset:t,onClose:()=>x(e.id)},e.id))]})},nt=({spec:e,onClose:s,onSave:a,saving:r})=>{const[l,n]=t.useState(e.name_ar||""),[i,o]=t.useState(e.name_en||""),[c,d]=t.useState(null),[m,x]=t.useState(null),{showToast:u}=$e();t.useEffect(()=>{if(e.image){const t=Re(e.image);t&&x(t)}},[e.image]);const h=async e=>{if(e.preventDefault(),!l.trim()||!i.trim())return void u.warning("الرجاء إدخال اسم التخصص بالعربية والإنجليزية");const t=new FormData;t.append("name_ar",l.trim()),t.append("name_en",i.trim()),c&&t.append("image",c),await a(t)};return w.jsx(Ee,{isOpen:!0,onClose:s,title:e.id?"تعديل التخصص":"إضافة تخصص جديد",size:"md",footer:w.jsxs("div",{className:"flex gap-3 justify-end",children:[w.jsx(Q,{variant:"secondary",onClick:s,disabled:r,children:"إلغاء"}),w.jsx(Q,{variant:"primary",onClick:h,isLoading:r,icon:!r&&w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),children:r?"جاري الحفظ...":"حفظ"})]}),children:w.jsxs("form",{onSubmit:h,className:"space-y-4",children:[m&&w.jsx("div",{className:"flex justify-center mb-4",children:w.jsx("div",{className:"relative",children:w.jsx("img",{src:m,alt:"Preview",className:"w-24 h-24 rounded-full object-cover border-4 border-cyan-500/30",onError:e=>{e.currentTarget.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2306b6d4"%3E%3Cpath d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/%3E%3C/svg%3E'}})})}),w.jsx(X,{label:"الاسم بالعربية",value:l,onChange:e=>n(e.target.value),placeholder:"مثال: جراحة عامة",required:!0,icon:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),w.jsx(X,{label:"الاسم بالإنجليزية",value:i,onChange:e=>o(e.target.value),placeholder:"Example: General Surgery",required:!0,icon:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),w.jsxs("div",{children:[w.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["صورة التخصص ",e.id&&"(اختياري للتحديث)",w.jsx("span",{className:"text-xs text-slate-400 block mt-1",children:"الصيغ المدعومة: JPG, PNG, GIF, WEBP, SVG (الحد الأقصى 5 ميجابايت)"})]}),w.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp,image/svg+xml",onChange:e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(s){const t=5242880;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/svg+xml"].includes(s.type))return u.warning("يرجى اختيار صورة صالحة (JPG, PNG, GIF, WEBP, SVG)"),void(e.target.value="");if(s.size>t)return u.warning("حجم الصورة كبير جداً. الحد الأقصى 5 ميجابايت"),void(e.target.value="");d(s);const a=new FileReader;a.onloadend=()=>{x(a.result)},a.readAsDataURL(s)}},className:"w-full px-4 py-2.5 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent hover:border-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-cyan-500 file:text-white hover:file:bg-cyan-600 cursor-pointer",required:!e.id})]})]})})},it=()=>{const[e,s]=t.useState([]),[a,r]=t.useState(!0),[l,n]=t.useState(!1),[i,o]=t.useState({}),[c,d]=t.useState(1),{toasts:m,removeToast:x,success:u,error:h,warning:p}=$e(),[g,v]=t.useState(!1),[j,f]=t.useState([]),[b,y]=t.useState(!1),[N,k]=t.useState(""),C=async()=>{r(!0);try{const e=await H.get("/admin/service"),t=e.services||e.data||e;s(Array.isArray(t)?t:[])}catch(e){}finally{r(!1)}};t.useEffect(()=>{C()},[]);const _=e=>{o(e||{}),n(!0)},L=()=>{n(!1),o({})},A=Math.ceil(e.length/10),S=10*(c-1),z=S+10,M=e.slice(S,z),E=e=>{if(!e)return"-";const t=e.includes("T")?e:e.replace(" ","T"),s=new Date(t);return Number.isNaN(s.getTime())?e:s.toLocaleDateString("ar-EG")},$=async()=>{y(!0),k("");try{const e=await H.get("/admin/service/trashed"),t=Array.isArray(e)?e:Array.isArray(null==e?void 0:e.data)?e.data:[];f(t)}catch(e){k((null==e?void 0:e.message)||"فشل تحميل العناصر المحذوفة"),f([])}finally{y(!1)}};return w.jsxs("div",{children:[w.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between mb-6",children:[w.jsx("h1",{className:"text-3xl font-bold text-slate-100",children:"إدارة خدمات المشافي"}),w.jsxs("div",{className:"flex flex-wrap gap-3",children:[w.jsx("button",{onClick:async()=>{v(!0),await $()},className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-md text-white font-semibold transition-colors",children:"العناصر المحذوفة"}),w.jsx("button",{onClick:()=>_(),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-md text-white font-semibold transition-colors",children:"إضافة خدمة"})]})]}),w.jsx("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl shadow-lg overflow-hidden",children:w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full text-sm text-right text-slate-300",children:[w.jsx("thead",{className:"text-xs text-slate-400 uppercase bg-slate-800",children:w.jsxs("tr",{children:[w.jsx("th",{scope:"col",className:"px-6 py-3",children:"#"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"اسم الخدمة"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"تاريخ الإنشاء"}),w.jsx("th",{scope:"col",className:"px-6 py-3",children:"الإجراءات"})]})}),w.jsx("tbody",{children:a?w.jsx("tr",{children:w.jsx("td",{colSpan:4,className:"text-center p-8",children:"جاري التحميل..."})}):e.length>0?M.map(e=>w.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-800",children:[w.jsx("td",{className:"px-6 py-4",children:e.id}),w.jsx("td",{className:"px-6 py-4 font-medium",children:e.service_name}),w.jsx("td",{className:"px-6 py-4",children:E(e.created_at??e.createdAt??e.updated_at??e.updatedAt??null)}),w.jsxs("td",{className:"px-6 py-4 flex space-x-2 space-x-reverse",children:[w.jsx("button",{onClick:()=>_(e),className:"px-3 py-1 text-xs bg-blue-600 hover:bg-blue-700 rounded-md",children:"تعديل"}),w.jsx("button",{onClick:()=>(async e=>{if(window.confirm("هل أنت متأكد من رغبتك في حذف هذه الخدمة؟"))try{await H.delete(`/admin/service/${e}`),u("تم حذف الخدمة بنجاح"),C()}catch(t){h(`فشل الحذف: ${(null==t?void 0:t.message)||"خطأ غير معروف"}`)}})(e.id),className:"px-3 py-1 text-xs bg-red-600 hover:bg-red-700 rounded-md",children:"حذف"})]})]},e.id)):w.jsx("tr",{children:w.jsx("td",{colSpan:4,className:"text-center p-8",children:"لا توجد خدمات لعرضها."})})})]})})}),!a&&e.length>0&&A>1&&w.jsxs("div",{className:"mt-6",children:[w.jsxs("div",{className:"text-center text-slate-400 text-sm mb-4",children:["عرض ",S+1," - ",Math.min(z,e.length)," من إجمالي ",e.length," خدمة"]}),w.jsxs("div",{className:"flex justify-center items-center gap-2",children:[w.jsx("button",{onClick:()=>{c<A&&d(c+1)},disabled:c===A,className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(c===A?"bg-slate-700/50 text-slate-500 cursor-not-allowed":"bg-slate-700 text-slate-200 hover:bg-slate-600 hover:shadow-lg"),children:"التالي ←"}),w.jsx("div",{className:"flex gap-1.5",children:(()=>{const e=[];if(A<=7)for(let t=1;t<=A;t++)e.push(t);else{e.push(1),c>3&&e.push("...");const t=Math.max(2,c-1),s=Math.min(A-1,c+1);for(let a=t;a<=s;a++)e.push(a);c<A-2&&e.push("..."),e.push(A)}return e})().map((e,t)=>"number"==typeof e?w.jsx("button",{onClick:()=>(e=>{d(e)})(e),className:"min-w-[40px] px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(c===e?"bg-cyan-600 text-white shadow-lg shadow-cyan-600/30 scale-105":"bg-slate-700 text-slate-200 hover:bg-slate-600 hover:shadow-md"),children:e},`page-${e}`):w.jsx("span",{className:"px-2 py-2 text-slate-500 text-sm flex items-center",children:e},`dots-${t}`))}),w.jsx("button",{onClick:()=>{c>1&&d(c-1)},disabled:1===c,className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(1===c?"bg-slate-700/50 text-slate-500 cursor-not-allowed":"bg-slate-700 text-slate-200 hover:bg-slate-600 hover:shadow-lg"),children:"→ السابق"})]})]}),l&&w.jsx(ot,{service:i,onClose:L,onSave:async e=>{if(e.trim())try{if(i.id)await H.put(`/admin/service/${i.id}`,{service_name:e}),u("تم تحديث الخدمة بنجاح");else{const t=new FormData;t.append("service_name",e),await H.post("/admin/service",t),u("تم إضافة الخدمة بنجاح")}C(),L()}catch(t){h(`فشل الحفظ: ${(null==t?void 0:t.message)||"خطأ غير معروف"}`)}else p("يرجى إدخال اسم الخدمة.")}}),g&&w.jsx(ct,{services:j,loading:b,error:N,onClose:()=>v(!1),onRefresh:$,onRestore:async e=>{try{await H.patch(`/admin/service/${e}`),u("تمت استعادة الخدمة بنجاح"),await C(),await $()}catch(t){h((null==t?void 0:t.message)||"فشل استعادة الخدمة")}},formatDate:E}),m.map((e,t)=>w.jsx(Pe,{message:e.message,type:e.type,duration:e.duration,offset:t,onClose:()=>x(e.id)},e.id))]})},ot=({service:e,onClose:s,onSave:a})=>{const[r,l]=t.useState(e.service_name||"");return w.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",onClick:s,children:w.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-xl p-6 w-full max-w-md",onClick:e=>e.stopPropagation(),children:[w.jsx("h2",{className:"text-xl font-bold mb-4",children:e.id?"تعديل الخدمة":"إضافة خدمة جديدة"}),w.jsxs("form",{onSubmit:e=>{e.preventDefault(),a(r)},children:[w.jsxs("div",{className:"mb-4",children:[w.jsx("label",{className:"block mb-2",children:"اسم الخدمة"}),w.jsx("input",{type:"text",value:r,onChange:e=>l(e.target.value),required:!0,className:"w-full p-2 bg-slate-700 rounded-md border border-slate-600"})]}),w.jsxs("div",{className:"flex justify-end space-x-2 space-x-reverse mt-6",children:[w.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-md",children:"إلغاء"}),w.jsx("button",{type:"submit",className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-md",children:"حفظ"})]})]})]})})},ct=({services:e,loading:t,error:s,onClose:a,onRefresh:r,onRestore:l,formatDate:n})=>w.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex justify-center items-center px-4",onClick:a,children:w.jsxs("div",{className:"bg-slate-900 rounded-2xl shadow-2xl border border-slate-700 w-full max-w-3xl max-h-[85vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[w.jsxs("div",{className:"flex items-center justify-between border-b border-slate-700 px-6 py-4",children:[w.jsxs("div",{children:[w.jsx("h2",{className:"text-xl font-bold text-white",children:"العناصر المحذوفة"}),w.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"يمكنك استعادة الخدمات المحذوفة خلال فترة السماح."})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("button",{onClick:r,className:"px-3 py-1.5 text-sm rounded-lg bg-slate-800 hover:bg-slate-700 text-white border border-slate-600 transition-colors",children:"تحديث"}),w.jsx("button",{onClick:a,className:"p-2 rounded-full hover:bg-slate-800 text-slate-400 hover:text-white transition-colors","aria-label":"إغلاق",children:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]}),w.jsxs("div",{className:"p-6 overflow-y-auto max-h-[70vh] space-y-4",children:[s&&w.jsx("div",{className:"text-sm text-rose-400 bg-rose-500/10 border border-rose-500/30 rounded-lg px-4 py-2",children:s}),t?w.jsx("div",{className:"flex justify-center py-10",children:w.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-cyan-400"})}):0===e.length?w.jsx("div",{className:"text-center py-10 text-slate-400",children:"لا توجد عناصر محذوفة حالياً."}):w.jsx("div",{className:"space-y-3",children:e.map(e=>w.jsxs("div",{className:"border border-slate-700 rounded-xl p-4 flex flex-col md:flex-row md:items-center md:justify-between gap-4 bg-slate-900/60",children:[w.jsxs("div",{children:[w.jsx("p",{className:"text-white font-semibold",children:e.service_name}),w.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["معرف الخدمة #",e.id]}),w.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["حذف في: ",n(e.deleted_at)]})]}),w.jsx("div",{className:"flex gap-2 flex-wrap",children:w.jsx("button",{onClick:()=>l(e.id),className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 rounded-lg text-white text-sm font-semibold transition-colors",children:"استعادة"})})]},e.id))})]})]})}),dt={hospital:{endpoint:"/admin/hospital/all",key:"hospitals"},doctor:{endpoint:"/admin/doctor/all",key:"doctors"},nurse:{endpoint:"/admin/nurse/all",key:"nurses"}},mt=()=>{const[e,s]=t.useState("hospital"),[a,r]=t.useState([]),[l,n]=t.useState(""),[i,o]=t.useState(""),[c,d]=t.useState(!1),[m,x]=t.useState(!1),[u,h]=t.useState(""),[p,g]=t.useState(null);t.useEffect(()=>{o(""),g(null),h(""),v()},[e]),t.useEffect(()=>{if(!i)return g(null),void h("");j(i)},[i,e]);const v=async()=>{const t=dt[e];d(!0);try{const s=((e,t)=>{var s,a,r,l,n;return e?Array.isArray(null==(s=null==e?void 0:e[t])?void 0:s.data)?e[t].data:Array.isArray(null==e?void 0:e[t])?e[t]:Array.isArray(null==(r=null==(a=null==e?void 0:e.data)?void 0:a[t])?void 0:r.data)?e.data[t].data:Array.isArray(null==(l=null==e?void 0:e.data)?void 0:l[t])?e.data[t]:Array.isArray(null==(n=null==e?void 0:e.data)?void 0:n.data)?e.data.data:Array.isArray(null==e?void 0:e.data)?e.data:Array.isArray(e)?e:[]:[]})(await H.get(`${t.endpoint}?per_page=200`).catch(()=>null),t.key),a=s.filter(e=>null==e?void 0:e.id).map(t=>{var s,a,r,l;switch(e){case"doctor":return{id:t.id,name:t.full_name||"طبيب غير معروف",subtitle:(null==(s=t.specialization)?void 0:s.name_ar)||(null==(a=t.account)?void 0:a.email)};case"nurse":return{id:t.id,name:t.full_name||"ممرض/ة غير معروف",subtitle:t.graduation_type||(null==(r=t.account)?void 0:r.email)};default:return{id:t.id,name:t.full_name||"مشفى غير معروف",subtitle:(null==(l=t.account)?void 0:l.email)||t.address}}});r(a)}catch{r([])}finally{d(!1)}},j=async t=>{x(!0),h("");try{const a=await H.get(`/admin/entity-rates?id=${t}&entity=${e}`),r=(null==a?void 0:a.data)||a,l=(s=null==r?void 0:r.ratings,Array.isArray(s)?s:Array.isArray(null==s?void 0:s.data)?s.data:[]);g({avg:Number(null==r?void 0:r.avg_rating)||0,count:Number(null==r?void 0:r.ratings_count)||l.length,ratings:l})}catch(a){g(null),h((null==a?void 0:a.message)||"فشل تحميل بيانات التقييمات")}finally{x(!1)}var s},f=t.useMemo(()=>{const e=l.trim().toLowerCase();return e?a.filter(t=>{var s;return t.name.toLowerCase().includes(e)||(null==(s=t.subtitle)?void 0:s.toLowerCase().includes(e))}):a},[a,l]);return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"text-3xl font-bold text-white",children:"تقارير التقييمات"}),w.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"راقب رضا المستخدمين عن الأطباء، الممرضين والمشافي"})]}),p&&w.jsxs(Me,{variant:"info",children:["متوسط ",p.avg.toFixed(1)," من ",p.count," تقييم"]})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[w.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-2",children:[w.jsx("label",{className:"text-sm text-slate-400",children:"نوع الكيان"}),w.jsxs("select",{value:e,onChange:e=>s(e.target.value),className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[w.jsx("option",{value:"hospital",children:"المشافي"}),w.jsx("option",{value:"doctor",children:"الأطباء"}),w.jsx("option",{value:"nurse",children:"الممرضون"})]})]}),w.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-2",children:[w.jsx("label",{className:"text-sm text-slate-400",children:"بحث بالاسم أو البريد"}),w.jsx("input",{type:"text",value:l,onChange:e=>n(e.target.value),placeholder:"اكتب للبحث...",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})]}),w.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-3",children:[w.jsx("label",{className:"text-sm text-slate-400",children:"اختر الكيان المطلوب"}),c?w.jsx("div",{className:"flex justify-center py-6",children:w.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-cyan-400"})}):w.jsxs("select",{value:i,onChange:e=>o(e.target.value?Number(e.target.value):""),className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[w.jsxs("option",{value:"",children:["اختر من القائمة (",f.length,")"]}),f.map(e=>w.jsxs("option",{value:e.id,children:["#",e.id," - ",e.name," ",e.subtitle?`(${e.subtitle})`:""]},e.id))]})]}),i&&w.jsx("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 space-y-4",children:m?w.jsx("div",{className:"flex justify-center py-10",children:w.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-cyan-400"})}):u?w.jsx("div",{className:"text-center py-6 text-rose-400",children:u}):p?w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[w.jsxs("div",{className:"bg-slate-900/60 border border-slate-700 rounded-xl p-4 text-center",children:[w.jsx("p",{className:"text-sm text-slate-400",children:"متوسط التقييم"}),w.jsx("p",{className:"text-4xl font-bold text-white mt-2",children:p.avg.toFixed(1)}),w.jsx("p",{className:"text-xs text-slate-500",children:"من 5"})]}),w.jsxs("div",{className:"bg-slate-900/60 border border-slate-700 rounded-xl p-4 text-center",children:[w.jsx("p",{className:"text-sm text-slate-400",children:"عدد التقييمات"}),w.jsx("p",{className:"text-4xl font-bold text-white mt-2",children:p.count})]}),w.jsxs("div",{className:"bg-slate-900/60 border border-slate-700 rounded-xl p-4 text-center",children:[w.jsx("p",{className:"text-sm text-slate-400",children:"آخر تحديث"}),w.jsx("p",{className:"text-lg font-semibold text-white mt-2",children:(new Date).toLocaleDateString("ar-EG")})]})]}),0===p.ratings.length?w.jsx("div",{className:"text-center py-10 text-slate-400",children:"لا توجد تقييمات لهذا الكيان حتى الآن."}):w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full text-sm text-right text-slate-200",children:[w.jsx("thead",{className:"bg-slate-900 text-xs uppercase text-slate-400",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-4 py-3",children:"المستخدم"}),w.jsx("th",{className:"px-4 py-3",children:"التقييم"}),w.jsx("th",{className:"px-4 py-3",children:"المراجعة"}),w.jsx("th",{className:"px-4 py-3",children:"التاريخ"})]})}),w.jsx("tbody",{className:"divide-y divide-slate-700",children:p.ratings.map(e=>{var t;return w.jsxs("tr",{className:"hover:bg-slate-800/70",children:[w.jsxs("td",{className:"px-4 py-3",children:[w.jsx("p",{className:"font-semibold",children:(null==(t=e.user)?void 0:t.full_name)||`مستخدم #${e.user_id}`}),w.jsxs("p",{className:"text-xs text-slate-400",children:["#",e.id]})]}),w.jsx("td",{className:"px-4 py-3",children:w.jsxs(Me,{variant:"warning",children:[e.rating.toFixed(1)," / 5"]})}),w.jsx("td",{className:"px-4 py-3 text-slate-300",children:e.review||"—"}),w.jsx("td",{className:"px-4 py-3 text-slate-400",children:new Date(e.created_at).toLocaleString("ar-EG")})]},e.id)})})]})})]}):w.jsx("div",{className:"text-center py-8 text-slate-400",children:"اختر كياناً لعرض بياناته."})})]})},xt=()=>{const{toasts:e,removeToast:s,success:a,error:r,warning:l}=$e(),[n,i]=t.useState([]),[o,c]=t.useState(!0),[d,m]=t.useState(!1),[x,u]=t.useState(!1),[h,p]=t.useState(null),[g,v]=t.useState({name_ar:"",name_en:""}),[j,f]=t.useState(!1);t.useEffect(()=>{b()},[]);const b=async()=>{var e,t;c(!0);try{const e=await H.get("/admin/provinces"),t=Array.isArray(e)?e:e.data||[];i(t)}catch(s){if(404===(null==s?void 0:s.status)||(null==(e=null==s?void 0:s.message)?void 0:e.includes("404"))||(null==(t=null==s?void 0:s.message)?void 0:t.includes("Not Found")))return void i([]);r("فشل تحميل المحافظات: "+(s.message||"خطأ غير معروف"))}finally{c(!1)}},y=e=>{e?(u(!0),p(e.id),v({name_ar:e.name_ar||"",name_en:e.name_en||""})):(u(!1),p(null),v({name_ar:"",name_en:""})),m(!0)},N=()=>{m(!1),u(!1),p(null),v({name_ar:"",name_en:""})},k=[{header:"ID",accessor:e=>e.id,className:"font-mono text-slate-400"},{header:"الاسم بالعربية",accessor:e=>e.name_ar||"-",sortable:!0,className:"font-medium text-white"},{header:"الاسم بالإنجليزية",accessor:e=>e.name_en||"-",sortable:!0},{header:"الإجراءات",accessor:e=>w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Q,{size:"sm",variant:"secondary",onClick:t=>{t.stopPropagation(),y(e)},children:"تعديل"}),w.jsx(Q,{size:"sm",variant:"secondary",onClick:t=>{t.stopPropagation(),(async e=>{var t,s;if(confirm("هل أنت متأكد من حذف هذه المحافظة؟"))try{await H.delete(`/admin/provinces/${e}`),a("تم حذف المحافظة بنجاح"),b()}catch(l){404===(null==l?void 0:l.status)||(null==(t=null==l?void 0:l.message)?void 0:t.includes("404"))||(null==(s=null==l?void 0:l.message)?void 0:s.includes("Not Found"))?r("API المحافظات غير متوفر بعد. يرجى التواصل مع فريق الباك اند."):r("فشل حذف المحافظة: "+(l.message||"خطأ غير معروف"))}})(e.id)},className:"bg-red-600 hover:bg-red-700",children:"حذف"})]})}];return w.jsxs("div",{className:"space-y-4 md:space-y-6 animate-fade-in",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("h1",{className:"text-2xl sm:text-3xl font-bold gradient-text",children:"إدارة المحافظات"}),w.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-1 md:mt-2",children:"إدارة ومراقبة جميع المحافظات المسجلة في النظام"})]}),w.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[w.jsx(Me,{variant:"info",size:"lg",children:o?"...":`${n.length} محافظة`}),w.jsxs(Q,{variant:"primary",size:"md",icon:w.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),onClick:()=>y(),children:[w.jsx("span",{className:"hidden sm:inline",children:"إضافة محافظة"}),w.jsx("span",{className:"sm:hidden",children:"إضافة"})]})]})]}),w.jsx(ze,{data:n,columns:k,loading:o,searchable:!1,emptyMessage:"لا توجد محافظات مسجلة",itemsPerPage:25}),w.jsx(Ee,{isOpen:d,onClose:N,title:x?"تعديل المحافظة":"إنشاء محافظة جديدة",footer:w.jsxs("div",{className:"flex gap-3 justify-end",children:[w.jsx(Q,{variant:"secondary",onClick:N,children:"إلغاء"}),w.jsx(Q,{variant:"primary",onClick:async()=>{var e,t;if(g.name_ar.trim()&&g.name_en.trim()){f(!0);try{x&&h?(await H.put(`/admin/provinces/${h}`,g),a("تم تحديث المحافظة بنجاح")):(await H.post("/admin/provinces",g),a("تم إنشاء المحافظة بنجاح")),N(),b()}catch(s){404===(null==s?void 0:s.status)||(null==(e=null==s?void 0:s.message)?void 0:e.includes("404"))||(null==(t=null==s?void 0:s.message)?void 0:t.includes("Not Found"))?r("API المحافظات غير متوفر بعد. يرجى التواصل مع فريق الباك اند."):r("فشل حفظ المحافظة: "+(s.message||"خطأ غير معروف"))}finally{f(!1)}}else l("يرجى إدخال اسم المحافظة بالعربية والإنجليزية")},isLoading:j,children:x?"تحديث":"إنشاء"})]}),children:w.jsxs("div",{className:"space-y-4",children:[w.jsx(X,{label:"الاسم بالعربية",value:g.name_ar,onChange:e=>v({...g,name_ar:e.target.value}),placeholder:"أدخل اسم المحافظة بالعربية",disabled:j}),w.jsx(X,{label:"الاسم بالإنجليزية",value:g.name_en,onChange:e=>v({...g,name_en:e.target.value}),placeholder:"Enter province name in English",disabled:j})]})}),e.map((e,t)=>w.jsx(Pe,{message:e.message,type:e.type,duration:e.duration,offset:t,onClose:()=>s(e.id)},e.id))]})},ut=()=>w.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[w.jsx("h1",{className:"text-9xl font-extrabold text-cyan-400 tracking-widest",children:"404"}),w.jsx("div",{className:"bg-slate-700 px-2 text-sm rounded rotate-12 absolute",children:"الصفحة غير موجودة"}),w.jsx("p",{className:"mt-4 text-lg text-slate-300",children:"عذراً، الصفحة التي تبحث عنها غير موجودة."}),w.jsx(c,{to:"/",className:"mt-6 inline-block px-5 py-3 text-sm font-medium text-white bg-cyan-600 rounded-lg hover:bg-cyan-700 focus:outline-none focus:ring",children:"العودة إلى لوحة التحكم"})]}),ht=()=>{const e=l();return w.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4",children:w.jsxs("div",{className:"max-w-md w-full text-center",children:[w.jsxs("div",{className:"bg-slate-800 rounded-lg p-8 shadow-xl border border-slate-700",children:[w.jsx("div",{className:"mb-6",children:w.jsx("div",{className:"mx-auto w-20 h-20 bg-red-500/10 rounded-full flex items-center justify-center",children:w.jsx("svg",{className:"w-10 h-10 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),w.jsx("h1",{className:"text-3xl font-bold text-white mb-4",children:"غير مصرح لك بالدخول"}),w.jsx("p",{className:"text-slate-300 mb-2",children:"عذراً، ليس لديك الصلاحيات الكافية للوصول إلى هذه الصفحة."}),w.jsx("p",{className:"text-slate-400 text-sm mb-8",children:"إذا كنت تعتقد أن هذا خطأ، يرجى التواصل مع المسؤول."}),w.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[w.jsx(Q,{onClick:()=>e(-1),variant:"secondary",className:"flex-1",children:"العودة للخلف"}),w.jsx(Q,{onClick:()=>e("/"),variant:"primary",className:"flex-1",children:"العودة للرئيسية"})]})]}),w.jsx("div",{className:"mt-6 text-slate-500 text-sm",children:w.jsx("p",{children:"رقم الخطأ: 403 - Forbidden"})})]})})},pt=()=>{const{sessionTimeRemaining:e,isAuthenticated:s}=K(),[a,r]=t.useState(!1);t.useEffect(()=>{r(!!(s&&e>0&&e<=300))},[e,s]);if(!a)return null;const l=Math.floor(e/60),n=e%60;return w.jsx(Ee,{isOpen:a,onClose:()=>r(!1),title:"تحذير انتهاء الجلسة",children:w.jsxs("div",{className:"space-y-4",children:[w.jsx("p",{className:"text-slate-300",children:"ستنتهي جلستك قريباً بسبب عدم النشاط."}),w.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:w.jsxs("p",{className:"text-yellow-400 text-center text-xl font-bold",children:["الوقت المتبقي: ",l,":",n.toString().padStart(2,"0")]})}),w.jsx("p",{className:"text-slate-400 text-sm",children:"هل تريد الاستمرار في العمل؟"}),w.jsx("div",{className:"flex gap-3",children:w.jsx(Q,{onClick:()=>{r(!1),document.dispatchEvent(new Event("mousedown"))},variant:"primary",className:"flex-1",children:"متابعة الجلسة"})})]})})},gt=()=>(t.useEffect(()=>{const e=e=>{e.blockedURI,e.violatedDirective,e.originalPolicy,e.sourceFile,e.lineno,e.colno},t=e=>{(e=>{if(e){if("string"==typeof e)return C(e);if(e instanceof Error)return C(e.message);try{return C(JSON.stringify(e))}catch{return}}})(e.reason)},s=e=>{C(e.message),e.filename,e.lineno,e.colno},a=e=>{"undefined"!=typeof window&&(e.origin===window.location.origin||(e.origin,e.data))};return window.addEventListener("securitypolicyviolation",e),window.addEventListener("unhandledrejection",t),window.addEventListener("error",s),window.addEventListener("message",a,!0),()=>{window.removeEventListener("securitypolicyviolation",e),window.removeEventListener("unhandledrejection",t),window.removeEventListener("error",s),window.removeEventListener("message",a,!0)}},[]),w.jsx(J,{children:w.jsxs(Z,{children:[w.jsx(vt,{}),w.jsx(pt,{})]})})),vt=()=>{const{isAuthenticated:e,loading:s}=K(),a=t.useMemo(()=>{const t=[{path:"/login",element:e?w.jsx(x,{to:"/",replace:!0}):w.jsx(ee,{})},{path:"/unauthorized",element:w.jsx(ht,{})},{path:"/",element:e?w.jsx(je,{}):w.jsx(x,{to:"/login",replace:!0}),children:[{index:!0,element:w.jsx(we,{})},{path:"approvals",element:w.jsx(De,{})},{path:"doctors",element:w.jsx(Fe,{})},{path:"doctors/:id",element:w.jsx(Ue,{})},{path:"nurses",element:w.jsx(st,{})},{path:"nurses/:id",element:w.jsx(rt,{})},{path:"hospitals",element:w.jsx(qe,{})},{path:"hospitals/:id",element:w.jsx(Ge,{})},{path:"users",element:w.jsx(Je,{})},{path:"users/:id",element:w.jsx(et,{})},{path:"specializations",element:w.jsx(lt,{})},{path:"hospital-services",element:w.jsx(it,{})},{path:"entity-ratings",element:w.jsx(mt,{})},{path:"provinces",element:w.jsx(xt,{})},{path:"*",element:w.jsx(ut,{})}]}];return e||t.push({path:"*",element:w.jsx(x,{to:"/login",replace:!0})}),d(t,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0}})},[e]);return s?w.jsx("div",{className:"flex justify-center items-center h-screen bg-slate-900 text-white",children:w.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-cyan-400"})}):w.jsx(m,{router:a})},jt=document.getElementById("root");if(!jt)throw new Error("Could not find root element to mount to");N.createRoot(jt).render(w.jsx(a.StrictMode,{children:w.jsx(gt,{})}));
